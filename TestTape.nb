(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    291571,       8460]
NotebookOptionsPosition[    259115,       7672]
NotebookOutlinePosition[    259459,       7687]
CellTagsIndexPosition[    259416,       7684]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"1", "+", "1"}]], "Input",
 CellChangeTimes->{{3.6992548570540085`*^9, 
  3.6992548590940294`*^9}},ExpressionUUID->"af125f81-00a5-414f-b1c0-\
e0c2f0ea92f3"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.699254882605266*^9, 3.7004570025346904`*^9, 
  3.702707405045578*^9},ExpressionUUID->"81ddd90d-64c0-42d1-a488-\
9b73b08453af"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"tape", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699254879905239*^9, 
  3.699254885059291*^9}},ExpressionUUID->"a7750eef-8503-4b2c-8357-\
e77b1165c924"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Head", "[", "Plus", "]"}]], "Input",
 CellChangeTimes->{{3.6992549079695244`*^9, 
  3.6992549202466497`*^9}},ExpressionUUID->"138961d3-66d0-4abb-92ae-\
c691cbb595cb"],

Cell[BoxData["Symbol"], "Output",
 CellChangeTimes->{{3.699254914964596*^9, 
  3.6992549207366548`*^9}},ExpressionUUID->"2b48a1c0-cb5c-48bd-9308-\
88eb164bcbb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "Sin", "]"}]], "Input",
 CellChangeTimes->{{3.699254922282671*^9, 
  3.699254926112709*^9}},ExpressionUUID->"e5cefd96-403d-4984-9e8b-\
1f559c20edce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Listable", ",", "NumericFunction", ",", "Protected"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.699254926402712*^9},ExpressionUUID->"dcd8e713-6125-48dc-96ae-\
65fdd72804cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "Plus", "]"}]], "Input",
 CellChangeTimes->{{3.6992549281327295`*^9, 
  3.699254932250774*^9}},ExpressionUUID->"4fd844a3-4eb0-49b2-9724-\
e2c01b83c1c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Flat", ",", "Listable", ",", "NumericFunction", ",", "OneIdentity", ",", 
   "Orderless", ",", "Protected"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6992549328907804`*^9},ExpressionUUID->"197e269d-1a49-4015-b77d-\
484f52140031"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"expr", "[", 
    RowBox[{"x1", ",", " ", "x2"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "x2"}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699271896118409*^9, 
  3.6992719217226677`*^9}},ExpressionUUID->"5bc7beff-5c13-4c2e-aff1-\
f004082ffd5e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["expr", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x1", ",", "x2"}], "]"}], ",", 
   RowBox[{
    SuperscriptBox["expr", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x1", ",", "x2"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.699271911319564*^9, 
  3.699271923142682*^9}},ExpressionUUID->"d619b46a-0f70-4937-b14b-\
84a896c60848"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Keys", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"b", "\[Rule]", "2"}]}], "|>"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.6992720694161663`*^9, 3.6992720919643993`*^9}, {
  3.6992721840193353`*^9, 3.6992721862873583`*^9}, {3.699272341275938*^9, 
  3.699272347482003*^9}},ExpressionUUID->"2151bd4d-5b3d-428e-ae79-\
ac9518050942"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "b"}], "}"}]], "Output",
 CellChangeTimes->{{3.6992720860553346`*^9, 3.6992720923144026`*^9}, 
   3.6992721873393693`*^9, {3.6992723424359493`*^9, 
   3.6992723481120095`*^9}},ExpressionUUID->"33f3ae99-6b8b-46f7-a3cd-\
87e070c7e60c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "ad", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ad", " ", "/:", " ", 
  RowBox[{"f", "[", 
   RowBox[{"ad", "[", 
    RowBox[{"expr_", ",", "  ", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"f", "[", "expr", "]"}]}], ",", "jac"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"jac", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", "f", "]"}], "[", "expr", 
       "]"}]}], ";", 
     RowBox[{"ad", "[", 
      RowBox[{"out", ",", " ", 
       RowBox[{"jac", " ", "y"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ad", "/:", 
  RowBox[{"f", "[", 
   RowBox[{
    RowBox[{"ad", "[", 
     RowBox[{"expr1_", ",", " ", "y1_"}], "]"}], ",", " ", 
    RowBox[{"ad", "[", 
     RowBox[{"expr2_", ",", " ", "y2_"}], "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"f", "[", 
        RowBox[{"expr1", ",", " ", "expr2"}], "]"}]}], ",", " ", "jac"}], 
     "}"}], ",", " ", 
    RowBox[{
     RowBox[{"jac", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0"}], "]"}], "[", "f", "]"}], "[", 
         RowBox[{"expr1", ",", " ", "expr2"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", " ", "1"}], "]"}], "[", "f", "]"}], "[", 
         RowBox[{"expr1", ",", " ", "expr2"}], "]"}]}], "}"}]}], ";", " ", 
     RowBox[{"ad", "[", 
      RowBox[{"out", ",", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{"jac", ",", " ", 
         RowBox[{"{", 
          RowBox[{"y1", ",", " ", "y2"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6992719413218665`*^9, 3.699272063944112*^9}, {
   3.699272104454524*^9, 3.6992721814113073`*^9}, {3.6992722628721356`*^9, 
   3.6992722717652273`*^9}, {3.699272305901573*^9, 3.699272323779756*^9}, {
   3.699272359940131*^9, 3.699272388933428*^9}, {3.6992728437044215`*^9, 
   3.6992728836298265`*^9}, {3.6992733459053364`*^9, 3.6992733928338118`*^9}, 
   3.6992763012773037`*^9, {3.69927633154561*^9, 3.699276387081174*^9}, {
   3.699276467430194*^9, 
   3.6992766074946213`*^9}},ExpressionUUID->"e548857c-42e9-496e-91b1-\
50a6dc9e6ce1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"ad", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"x1", "^", "2"}], " ", "+", " ", "x2"}], "]"}], " ", "x3"}], 
     "+", 
     RowBox[{"x3", "^", "3"}]}], ",", " ", "\[Sigma]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6992721926394224`*^9, 3.699272246425969*^9}, {
  3.699276456557085*^9, 
  3.6992764575170946`*^9}},ExpressionUUID->"ebd505ae-a12d-409e-8531-\
fc57c481094a"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     SuperscriptBox["x3", "3"], "+", 
     RowBox[{"x3", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SuperscriptBox["x1", "2"], "+", "x2"}], "]"}]}]}], "]"}], ",", 
   RowBox[{"\[Sigma]", " ", 
    RowBox[{
     SuperscriptBox["f", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{
      SuperscriptBox["x3", "3"], "+", 
      RowBox[{"x3", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SuperscriptBox["x1", "2"], "+", "x2"}], "]"}]}]}], "]"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.6992722487929935`*^9, 3.699272274345253*^9}, 
   3.6992723261617804`*^9, 3.699272391340452*^9, 3.6992728882418733`*^9, 
   3.6992733508443875`*^9, {3.699273382441708*^9, 3.699273395032835*^9}, 
   3.6992763904212074`*^9, 3.6992764596971164`*^9, 
   3.6992766105866523`*^9},ExpressionUUID->"1119d954-b713-4ef3-8fe5-\
250ad62fc01f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{
   RowBox[{"ad", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"x1", " ", "+", 
       SuperscriptBox["x2", "3"]}], "]"}], ",", " ", "\[Sigma]1"}], "]"}], 
   ",", " ", 
   RowBox[{"ad", "[", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"x3", "^", "2"}], "+", 
       RowBox[{"Log", "[", "x1", "]"}]}], "]"}], ",", " ", "\[Sigma]2"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699276612591674*^9, 
  3.699276674645353*^9}},ExpressionUUID->"79a323b6-c1ef-4593-aa73-\
162b86628b9d"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"x1", "+", 
       SuperscriptBox["x2", "3"]}]], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SuperscriptBox["x3", "2"], "+", 
       RowBox[{"Log", "[", "x1", "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"\[Sigma]2", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"x1", "+", 
         SuperscriptBox["x2", "3"]}]], ",", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SuperscriptBox["x3", "2"], "+", 
         RowBox[{"Log", "[", "x1", "]"}]}], "]"}]}], "]"}]}], "+", 
    RowBox[{"\[Sigma]1", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"x1", "+", 
         SuperscriptBox["x2", "3"]}]], ",", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SuperscriptBox["x3", "2"], "+", 
         RowBox[{"Log", "[", "x1", "]"}]}], "]"}]}], "]"}]}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.699276675475361*^9},ExpressionUUID->"41110694-106e-4971-9ceb-\
7ac4b2ff4421"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quick check", "Section",
 CellChangeTimes->{{3.6995976036836147`*^9, 
  3.699597605885637*^9}},ExpressionUUID->"9b8a7967-c7f6-4038-94bb-\
be403ec29404"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"ad", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "x2", ",", " ", "x3", ",", " ", "x4"}], "}"}], 
    ",", "  ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Sigma]", "1"], ",", " ", 
       SubscriptBox["\[Sigma]", "2"], ",", " ", 
       SubscriptBox["\[Sigma]", "3"], ",", " ", 
       SubscriptBox["\[Sigma]", "4"]}], "}"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6993412568252306`*^9, 
  3.699341335029025*^9}},ExpressionUUID->"d92823fa-84e5-493d-8b63-\
fe3d1ef69411"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Sigma]", "1"], ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       SubscriptBox["\[Sigma]", "2"], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       SubscriptBox["\[Sigma]", "3"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       SubscriptBox["\[Sigma]", "4"]}], "}"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.6993413507281837`*^9, 3.699343857752246*^9, 
  3.6995923806538477`*^9, 3.6995951213585415`*^9, 3.699595589098913*^9, 
  3.6995956507925425`*^9, 3.6995965020741405`*^9, 
  3.699596640811547*^9},ExpressionUUID->"3ff0814d-2447-4fb7-84b4-\
a64091993ab7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tape", "=", 
  RowBox[{"Association", "[", 
   RowBox[{"1", "\[Rule]", " ", 
    RowBox[{"x", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6995951227705555`*^9, 
  3.699595145949791*^9}},ExpressionUUID->"df6c2b72-59c4-4546-b761-\
f4e1c347321e"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"1", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Sigma]", "1"], ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       SubscriptBox["\[Sigma]", "2"], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       SubscriptBox["\[Sigma]", "3"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       SubscriptBox["\[Sigma]", "4"]}], "}"}]}], "}"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.699595147878811*^9, 3.6995955910289326`*^9, 
  3.6995956515225496`*^9, 3.6995965021641417`*^9, 
  3.6995966408515472`*^9},ExpressionUUID->"315d4ab7-035a-4ba1-a2b8-\
3a62cf4fc1e0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ufun", "[", "z_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
      RowBox[{"z", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
      RowBox[{"z", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", " ", 
    RowBox[{"g", "[", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
      RowBox[{"z", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", " ", 
    RowBox[{"h", "[", 
     RowBox[{"z", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6993418420693226`*^9, 3.6993419036109476`*^9}, {
  3.6993429946448174`*^9, 3.6993430086919584`*^9}, {3.69934385911226*^9, 
  3.6993438595622644`*^9}, {3.699592383733879*^9, 
  3.699592386153903*^9}},ExpressionUUID->"17b1cbc6-d466-4cc2-8b92-\
8faf9ada2565"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"u", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", "=", 
       RowBox[{"ufun", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ad", "[", 
      RowBox[{"out", ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{"out", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6995953068904266`*^9, 
  3.6995953219585786`*^9}},ExpressionUUID->"378ad545-7f9e-4518-a3e4-\
e9cfda4eb608"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"u", "=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"ufun", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", "jac"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"jac", "=", 
      RowBox[{"D", "[", 
       RowBox[{"out", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"tape", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Keys", "[", "tape", "]"}], "]"}], "+", "1"}], ")"}], 
        "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ad", "[", 
      RowBox[{"out", ",", " ", "jac"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6993413578302555`*^9, 3.699341396832651*^9}, {
  3.699343018053053*^9, 3.699343055242432*^9}, {3.6993430879997644`*^9, 
  3.69934308957178*^9}, {3.6993431222211113`*^9, 3.6993431229011183`*^9}, {
  3.6993431650855455`*^9, 3.69934316548555*^9}, {3.6993438628732977`*^9, 
  3.6993438652843227`*^9}, {3.699595187670218*^9, 3.6995952809771643`*^9}, {
  3.6995956386344166`*^9, 
  3.6995956456754866`*^9}},ExpressionUUID->"93445ec1-06e0-4cf5-b93e-\
755cdfe947d0"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], ",", 
     RowBox[{"g", "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], ",", 
     RowBox[{"h", "[", "x4", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], ",", "0", ",", 
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "0", ",", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x2", ",", "x4"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        SuperscriptBox["h", "\[Prime]",
         MultilineFunction->None], "[", "x4", "]"}]}], "}"}]}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.699343103532922*^9, 3.699343123481124*^9}, 
   3.6993431731046267`*^9, 3.6993438766574373`*^9, 3.699592388353925*^9, 
   3.6995952842991977`*^9, 3.6995956168721943`*^9, 3.699595658812622*^9, 
   3.6995965169362907`*^9, 
   3.699596655497695*^9},ExpressionUUID->"eeac4825-524f-4df9-917c-\
7117d32d919d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"vfun", "[", "z_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w1", " ", 
     SuperscriptBox[
      RowBox[{"z", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "2"]}], "+", " ", 
    RowBox[{"w2", " ", 
     RowBox[{"z", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], " ", "+", " ", 
    RowBox[{"w3", " ", 
     RowBox[{"z", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6993438804974756`*^9, 3.6993439183558617`*^9}, {
  3.6995966481556206`*^9, 
  3.699596650413644*^9}},ExpressionUUID->"d5b690fb-3125-4a96-bd2f-\
51b2b868f2d5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"v", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", "=", 
       RowBox[{"vfun", "[", 
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ad", "[", 
      RowBox[{"out", ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{"out", ",", " ", 
         RowBox[{"{", 
          RowBox[{"u", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6993439356600375`*^9, 3.6993439517881994`*^9}, {
  3.699595677010807*^9, 
  3.6995956795408325`*^9}},ExpressionUUID->"ebb777e0-b0c9-476e-99fc-\
440a101a982e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"vfun", "[", 
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", "jac"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"jac", "=", 
      RowBox[{"D", "[", 
       RowBox[{"out", ",", " ", 
        RowBox[{"{", 
         RowBox[{"u", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"tape", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Keys", "[", "tape", "]"}], "]"}], "+", "1"}], ")"}], 
        "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ad", "[", 
      RowBox[{"out", ",", " ", "jac"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.699595682984868*^9, 3.699595747132517*^9}, {
  3.6995965245083685`*^9, 3.6995965441375675`*^9}, {3.6995966567687087`*^9, 
  3.699596660063742*^9}},ExpressionUUID->"766395b3-184c-4317-ae86-\
d0022ed648f1"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w1", " ", 
      SuperscriptBox[
       RowBox[{"f", "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], "2"]}], "+", 
     RowBox[{"w2", " ", 
      RowBox[{"g", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
     RowBox[{"w3", " ", 
      RowBox[{"h", "[", "x4", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", " ", "w1", " ", 
       RowBox[{"f", "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}], ",", "w2", ",", "w3"}],
      "}"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.6995957545555935`*^9, 3.6995965492586193`*^9, 
  3.6995966631837735`*^9},ExpressionUUID->"e7813410-3e5b-4891-8f21-\
1104959e7296"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["tape"], "Input",
 CellChangeTimes->{{3.69959576115166*^9, 
  3.6995957615116634`*^9}},ExpressionUUID->"f35882fa-cae9-4651-a9bc-\
5857ad7ffd20"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Sigma]", "1"], ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["\[Sigma]", "2"], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["\[Sigma]", "3"], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["\[Sigma]", "4"]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], ",", 
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], ",", "0", ",", 
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "0", ",", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x2", ",", "x4"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{
         SuperscriptBox["h", "\[Prime]",
          MultilineFunction->None], "[", "x4", "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "w1", " ", 
        RowBox[{"f", "[", 
         RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}], ",", "w2", ",", 
       "w3"}], "}"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6995965530866594`*^9, 
  3.699596665023792*^9},ExpressionUUID->"2bd73da4-8495-44c3-be59-\
c6c4c84d6b56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "@@", 
  RowBox[{"Values", "[", 
   RowBox[{"tape", "[", 
    RowBox[{"[", 
     RowBox[{"ReverseSort", "[", 
      RowBox[{"Keys", "[", "tape", "]"}], "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.699595897022291*^9, 3.6995959201325254`*^9}, {
  3.6995961409414244`*^9, 3.699596176608786*^9}, {3.699596415855269*^9, 
  3.6995964637467537`*^9}, {3.699596560473734*^9, 3.6995966167563033`*^9}, {
  3.699596674814891*^9, 3.6995966837049804`*^9}, {3.699596716354314*^9, 
  3.699596721674367*^9}},ExpressionUUID->"c16fafae-9dd4-4471-b20b-\
bc5c5ebaaaea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"2", " ", "w1", " ", 
     RowBox[{"f", "[", 
      RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
     SubscriptBox["\[Sigma]", "1"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["\[Sigma]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w2", " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
       RowBox[{"2", " ", "w1", " ", 
        RowBox[{"f", "[", 
         RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}]}], ")"}]}], ",", "0", 
    ",", 
    RowBox[{
     SubscriptBox["\[Sigma]", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w3", " ", 
        RowBox[{
         SuperscriptBox["h", "\[Prime]",
          MultilineFunction->None], "[", "x4", "]"}]}], "+", 
       RowBox[{"w2", " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
       RowBox[{"2", " ", "w1", " ", 
        RowBox[{"f", "[", 
         RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.699595901375335*^9, 3.699595921002534*^9}, {
   3.699596162387643*^9, 3.69959617695879*^9}, {3.6995964214053254`*^9, 
   3.6995964657867737`*^9}, {3.699596554648675*^9, 3.699596617176307*^9}, {
   3.6995966712408543`*^9, 3.699596684564989*^9}, 
   3.6995967220413713`*^9},ExpressionUUID->"f7043f87-f4c8-4e72-b6ec-\
1a0fe62a2fd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", " ", "@@", 
  RowBox[{"(", 
   RowBox[{"Transpose", " ", "/@", " ", 
    RowBox[{"Values", "[", 
     RowBox[{"tape", "[", 
      RowBox[{"[", 
       RowBox[{"Sort", "[", 
        RowBox[{"Keys", "[", "tape", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.699597144394781*^9, 
  3.6995971843861856`*^9}},ExpressionUUID->"ffdcc3d3-4ffc-4e12-9d9f-\
7f4ca95e8e23"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", " ", "w1", " ", 
     RowBox[{"f", "[", 
      RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
     SubscriptBox["\[Sigma]", "1"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w2", " ", 
      SubscriptBox["\[Sigma]", "2"], " ", 
      RowBox[{
       SuperscriptBox["g", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
     RowBox[{"2", " ", "w1", " ", 
      RowBox[{"f", "[", 
       RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
      SubscriptBox["\[Sigma]", "2"], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w3", " ", 
      SubscriptBox["\[Sigma]", "4"], " ", 
      RowBox[{
       SuperscriptBox["h", "\[Prime]",
        MultilineFunction->None], "[", "x4", "]"}]}], "+", 
     RowBox[{"w2", " ", 
      SubscriptBox["\[Sigma]", "4"], " ", 
      RowBox[{
       SuperscriptBox["g", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
     RowBox[{"2", " ", "w1", " ", 
      RowBox[{"f", "[", 
       RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
      SubscriptBox["\[Sigma]", "4"], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.699597185216194*^9},ExpressionUUID->"618e6098-f8c5-494a-bccd-\
b6231888cdfd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "[", 
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"u", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
   RowBox[{"x", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6995929681144247`*^9, 
  3.6995929932496777`*^9}},ExpressionUUID->"1f81f429-d4a1-4da4-bdd4-\
620c4e6a8252"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", "w1", " ", 
    RowBox[{"f", "[", 
     RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
    SubscriptBox["\[Sigma]", "1"], " ", 
    RowBox[{
     SuperscriptBox["f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}], ",", 
   RowBox[{
    SubscriptBox["\[Sigma]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"w2", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
      RowBox[{"2", " ", "w1", " ", 
       RowBox[{"f", "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}]}], ")"}]}], ",", "0", 
   ",", 
   RowBox[{
    SubscriptBox["\[Sigma]", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"w3", " ", 
       RowBox[{
        SuperscriptBox["h", "\[Prime]",
         MultilineFunction->None], "[", "x4", "]"}]}], "+", 
      RowBox[{"w2", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
      RowBox[{"2", " ", "w1", " ", 
       RowBox[{"f", "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.69959297050145*^9, 
  3.699592993549681*^9}},ExpressionUUID->"abb1e112-d8dd-4ce3-b2a8-\
0c610cd75885"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"v", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "}"}], "]"}], ",", " ", 
   RowBox[{"{", 
    SubscriptBox["\[Sigma]", "y"], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699592851551241*^9, 3.699592896040692*^9}, {
  3.6995929380641193`*^9, 3.699592940472145*^9}, {3.6995930044827952`*^9, 
  3.6995930105628557`*^9}, {3.699594349430863*^9, 
  3.699594365535025*^9}},ExpressionUUID->"7883d591-650f-41ce-9649-\
94cc2950bd24"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", "w1", " ", 
    RowBox[{"f", "[", 
     RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
    SubscriptBox["\[Sigma]", "y"], " ", 
    RowBox[{
     SuperscriptBox["f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}], ",", 
   RowBox[{
    SubscriptBox["\[Sigma]", "y"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"w2", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
      RowBox[{"2", " ", "w1", " ", 
       RowBox[{"f", "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}]}], ")"}]}], ",", "0", 
   ",", 
   RowBox[{
    SubscriptBox["\[Sigma]", "y"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"w3", " ", 
       RowBox[{
        SuperscriptBox["h", "\[Prime]",
         MultilineFunction->None], "[", "x4", "]"}]}], "+", 
      RowBox[{"w2", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x2", ",", "x4"}], "]"}]}], "+", 
      RowBox[{"2", " ", "w1", " ", 
       RowBox[{"f", "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2", ",", "x4"}], "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.699592877723507*^9, 3.6995928886766176`*^9}, 
   3.6995929410521507`*^9, 3.6995930109758615`*^9, {3.6995943510508795`*^9, 
   3.6995943662950325`*^9}},ExpressionUUID->"00fdfe37-37ff-4609-9219-\
a2d355858667"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Work with the tape", "Section",
 CellChangeTimes->{{3.6995976036836147`*^9, 3.699597605885637*^9}, {
  3.6996797468706446`*^9, 
  3.6996797541907177`*^9}},ExpressionUUID->"23156846-d628-4b42-9fe6-\
d2a78264368d"],

Cell[CellGroupData[{

Cell["Example 1", "Subsection",
 CellChangeTimes->{{3.699688019399957*^9, 
  3.6996880230890055`*^9}},ExpressionUUID->"ef27e298-9433-497a-9bd1-\
9a8a06807507"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$tape", "=", 
  RowBox[{"<|", 
   RowBox[{"0", "\[Rule]", "Nothing"}], "|>"}]}]], "Input",
 CellChangeTimes->{{3.699679755840734*^9, 
  3.6996797650928288`*^9}},ExpressionUUID->"5a80e4ce-6728-4592-9145-\
a82dc9dba915"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"0", "\[Rule]", "Nothing"}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.6996797680508585`*^9, {3.6996801977492104`*^9, 3.6996802156553926`*^9}, 
   3.699684278663435*^9, 3.699684352316183*^9, 3.6996844265929317`*^9, 
   3.699686416718193*^9, 3.6996864936153193`*^9, 3.6996867335048785`*^9, 
   3.699687847316698*^9, 3.699696602568205*^9, 3.6996967080058136`*^9, 
   3.6996972720786977`*^9},ExpressionUUID->"2a210824-4da8-4a24-9cb9-\
9da7e2937acb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "ad", "]"}]], "Input",
 CellChangeTimes->{{3.6996801242424674`*^9, 
  3.6996801276065016`*^9}},ExpressionUUID->"abcad40c-c7e3-490c-85a6-\
64d8c50df1be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ad", " ", "/:", " ", 
   RowBox[{
    RowBox[{"ad", "[", "expr1_", "]"}], "+", 
    RowBox[{"ad", "[", "expr2_", "]"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"expr1", "+", "expr2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"jac", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "1"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"$tape", ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
         "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ad", " ", "/:", " ", 
   RowBox[{
    RowBox[{"ad", "[", "expr1_", "]"}], " ", 
    RowBox[{"ad", "[", "expr2_", "]"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"expr1", " ", "expr2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"jac", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"expr2", ",", " ", "expr1"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"$tape", ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
         "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ad", "/:", 
  RowBox[{"f_", "[", 
   RowBox[{"ad", "[", "expr_", "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"f", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jac", "=", 
      RowBox[{"D", "[", 
       RowBox[{"out", ",", " ", 
        RowBox[{"{", "expr", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jac", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayDepth", "[", "jac", "]"}], "\[Equal]", "1"}], ",", " ", 
        RowBox[{"{", "jac", "}"}], ",", " ", "jac"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"$tape", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
        "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6996797695218735`*^9, 3.699679925910457*^9}, {
  3.6996801318405437`*^9, 3.6996801323905497`*^9}, {3.699680201521249*^9, 
  3.6996802134453707`*^9}, {3.699684270349352*^9, 3.699684274951398*^9}, {
  3.6996864935273156`*^9, 3.699686553270186*^9}, {3.6996866147151437`*^9, 
  3.699686618811203*^9}, {3.699687825127378*^9, 3.699687841642615*^9}, {
  3.6996966027582073`*^9, 3.6996966928855886`*^9}, {3.6996972464163094`*^9, 
  3.6996972665446196`*^9}, {3.69969730631821*^9, 
  3.699697316760359*^9}},ExpressionUUID->"85cc1f89-80a8-4c17-bba1-\
dc87296b2dce"],

Cell[CellGroupData[{

Cell[BoxData[{"$tape", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xVar", "=", 
   RowBox[{"Identity", "[", 
    RowBox[{"ad", "[", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", " ", 
       SubscriptBox["x", "2"], ",", " ", 
       SubscriptBox["x", "3"], ",", " ", 
       SubscriptBox["x", "4"]}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.6996864407085447`*^9, 3.6996864632608747`*^9}, {
  3.699686677502056*^9, 3.699686682319128*^9}, {3.6996867535401683`*^9, 
  3.699686755830202*^9}},ExpressionUUID->"7d0c6854-38e4-4b78-a74b-\
11a560cf0f31"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"0", "\[Rule]", "Nothing"}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6996864654399047`*^9, 3.699686683634143*^9, 
  3.6996867590392466`*^9, 3.699687850848753*^9, 3.6996967275901175`*^9, 
  3.699697277056788*^9},ExpressionUUID->"4e2d3bba-48f9-45d7-afbc-\
83694c4cd558"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6996864654399047`*^9, 3.699686683634143*^9, 
  3.6996867590392466`*^9, 3.699687850848753*^9, 3.6996967275901175`*^9, 
  3.699697277056788*^9},ExpressionUUID->"4dad8168-56f4-41ea-b158-\
19556bf3e03d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"u", "=", 
  RowBox[{
   RowBox[{"ad", "[", 
    RowBox[{"xVar", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
   RowBox[{"ad", "[", 
    RowBox[{"xVar", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", 
   RowBox[{"ad", "[", 
    RowBox[{"xVar", "[", 
     RowBox[{"[", "4", "]"}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.6996967334802094`*^9, 
  3.6996967724807997`*^9}},ExpressionUUID->"475db973-ed71-4adb-a116-\
6ba84d711154"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"ad\\\", \\\
\"[\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[\\\"x\\\", \\\"1\\\"], \\\",\
\\\", SubscriptBox[\\\"x\\\", \\\"2\\\"], \\\",\\\", SubscriptBox[\\\"x\\\", \
\\\"3\\\"], \\\",\\\", SubscriptBox[\\\"x\\\", \\\"4\\\"]}], \\\"}\\\"}], \
\\\"]\\\"}]\\) does not exist.\"",2,21,1,25576268772620533476,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.6996972808658447`*^9},ExpressionUUID->"b73f6b25-bb61-4581-bc12-\
d8d3f48d29d6"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"4\\\"}]\\) of \\!\\(\\*RowBox[{\\\"ad\\\", \\\
\"[\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[\\\"x\\\", \\\"1\\\"], \\\",\
\\\", SubscriptBox[\\\"x\\\", \\\"2\\\"], \\\",\\\", SubscriptBox[\\\"x\\\", \
\\\"3\\\"], \\\",\\\", SubscriptBox[\\\"x\\\", \\\"4\\\"]}], \\\"}\\\"}], \
\\\"]\\\"}]\\) does not exist.\"",2,21,2,25576268772620533476,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.6996972810758495`*^9},ExpressionUUID->"9039320d-c6c9-480c-9617-\
b3f0f602666d"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", 
         SubscriptBox["x", "4"]}], "}"}], "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "+", 
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", 
         SubscriptBox["x", "4"]}], "}"}], "]"}], "\[LeftDoubleBracket]", "4", 
      "\[RightDoubleBracket]"}], "+", 
     SubscriptBox["x", "1"]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", 
         SubscriptBox["x", "4"]}], "}"}], "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "+", 
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", 
         SubscriptBox["x", "4"]}], "}"}], "]"}], "\[LeftDoubleBracket]", "4", 
      "\[RightDoubleBracket]"}], "+", 
     SubscriptBox["x", "2"]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", 
         SubscriptBox["x", "4"]}], "}"}], "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "+", 
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", 
         SubscriptBox["x", "4"]}], "}"}], "]"}], "\[LeftDoubleBracket]", "4", 
      "\[RightDoubleBracket]"}], "+", 
     SubscriptBox["x", "3"]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", 
         SubscriptBox["x", "4"]}], "}"}], "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "+", 
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", 
         SubscriptBox["x", "4"]}], "}"}], "]"}], "\[LeftDoubleBracket]", "4", 
      "\[RightDoubleBracket]"}], "+", 
     SubscriptBox["x", "4"]}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.699696774149824*^9, 
  3.6996972810758495`*^9},ExpressionUUID->"0781c535-b548-4994-8995-\
cc001a0fe14c"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Short", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        TagBox[
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"], ",", 
           SubscriptBox["x", "4"]}], "}"}],
         HoldForm], ",", "5"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["Shallow", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        TagBox[
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"], ",", 
           SubscriptBox["x", "4"]}], "}"}],
         HoldForm], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "50"}], "}"}]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", "0"}], ",", 
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"7", "\[Rule]", "0"}], ",", 
   RowBox[{"8", "\[Rule]", "0"}], ",", 
   RowBox[{"9", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"10", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Short", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        TagBox[
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"], ",", 
           SubscriptBox["x", "4"]}], "}"}],
         HoldForm], ",", "5"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["Shallow", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        TagBox[
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"], ",", 
           SubscriptBox["x", "4"]}], "}"}],
         HoldForm], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "50"}], "}"}]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"11", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"12", "\[Rule]", "0"}], ",", 
   RowBox[{"13", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["HoldForm", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"], ",", 
          SubscriptBox["x", "4"]}], "}"}], "]"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"14", "\[Rule]", "0"}], ",", 
   RowBox[{"15", "\[Rule]", "0"}], ",", 
   RowBox[{"16", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"17", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.699696774149824*^9, 
  3.69969728111585*^9},ExpressionUUID->"705f750d-de51-4b68-bc86-0b02f630ebd1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"u", "=", 
  RowBox[{"Sin", "[", 
   RowBox[{"ad", "[", "xVar", "]"}], 
   "]"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.699680032314537*^9, 3.699680043919654*^9}, {
  3.699680073959957*^9, 3.6996800815100336`*^9}, {3.6996801523757505`*^9, 
  3.6996801726309557`*^9}, {3.699684358486245*^9, 3.6996843587562475`*^9}, {
  3.699686768705406*^9, 3.699686769586422*^9}, {3.699697223153964*^9, 
  3.699697223433967*^9}},ExpressionUUID->"a3ca2881-89bc-491e-9165-\
0f3e298f2bcb"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.699680173460964*^9, {3.69968020564129*^9, 3.699680218825424*^9}, 
   3.699684281249461*^9, 3.6996843604162645`*^9, 3.6996844298839655`*^9, 
   3.6996867706104374`*^9, 
   3.699687852319776*^9},ExpressionUUID->"8aa03840-5073-4f19-b8d6-\
5052dc66b92d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Sin", "[", 
    SubscriptBox["x", "1"], "]"}], ",", 
   RowBox[{"Sin", "[", 
    SubscriptBox["x", "2"], "]"}], ",", 
   RowBox[{"Sin", "[", 
    SubscriptBox["x", "3"], "]"}], ",", 
   RowBox[{"Sin", "[", 
    SubscriptBox["x", "4"], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.699680173460964*^9, {3.69968020564129*^9, 3.699680218825424*^9}, 
   3.699684281249461*^9, 3.6996843604162645`*^9, 3.6996844298839655`*^9, 
   3.6996867706104374`*^9, 
   3.699687852319776*^9},ExpressionUUID->"94ce9dae-0102-47af-a137-\
2e9fb24f9e55"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "1"], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "2"], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "3"], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "4"], "]"}]}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.699680173460964*^9, {3.69968020564129*^9, 3.699680218825424*^9}, 
   3.699684281249461*^9, 3.6996843604162645`*^9, 3.6996844298839655`*^9, 
   3.6996867706104374`*^9, 
   3.6996878523297763`*^9},ExpressionUUID->"0e1a1317-e6ec-44c2-a9f9-\
51d356b07811"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v", "=", 
  RowBox[{"Total", "[", 
   RowBox[{"ad", "[", "u", "]"}], 
   "]"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.699684238402029*^9, 3.6996842482561274`*^9}, {
   3.6996842975356255`*^9, 3.6996843167158213`*^9}, {3.6996843628362885`*^9, 
   3.699684363206292*^9}, 3.6996844412870803`*^9, {3.699686780018575*^9, 
   3.6996867832506175`*^9}},ExpressionUUID->"c69f51f6-c537-4675-bb0b-\
ce3409284d6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", 
   SubscriptBox["x", "1"], "]"}], "+", 
  RowBox[{"Sin", "[", 
   SubscriptBox["x", "2"], "]"}], "+", 
  RowBox[{"Sin", "[", 
   SubscriptBox["x", "3"], "]"}], "+", 
  RowBox[{"Sin", "[", 
   SubscriptBox["x", "4"], "]"}]}]], "Output",
 CellChangeTimes->{3.6996843181868362`*^9, 3.6996843645363054`*^9, 
  3.69968444416811*^9, 3.69968678410163*^9, 
  3.6996878535507936`*^9},ExpressionUUID->"76d1ec8c-6235-4c74-9f29-\
f1804470971f"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "1"], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "2"], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "3"], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "4"], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6996843181868362`*^9, 3.6996843645363054`*^9, 
  3.69968444416811*^9, 3.69968678410163*^9, 
  3.6996878535507936`*^9},ExpressionUUID->"d76e9ac7-0983-45e6-87b4-\
39eb9616880d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$tape"], "Input",
 CellChangeTimes->{{3.6996843211758666`*^9, 
  3.6996843254059086`*^9}},ExpressionUUID->"4d9040dc-4c8b-4023-82af-\
47d720b6cf8f"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "1"], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "2"], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "3"], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "4"], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.699684329159947*^9, 3.699684365626316*^9, 
  3.6996844451881204`*^9, 3.699686787994687*^9, 
  3.6996878549748154`*^9},ExpressionUUID->"95f67091-2c8c-4cef-8d20-\
4fef5d3c5d94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "@@", 
  RowBox[{"Values", "[", 
   RowBox[{"$tape", "[", 
    RowBox[{"[", 
     RowBox[{"Key", " ", "/@", " ", 
      RowBox[{"ReverseSort", "[", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "$tape", "]"}], ",", " ", "0"}], "]"}], "]"}]}],
      "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6996869199462233`*^9, 3.699686979478083*^9}, {
  3.6996871025009885`*^9, 
  3.6996871130481405`*^9}},ExpressionUUID->"74684c62-9f7d-4e29-bdc2-\
00ec44fe1beb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "1"], "]"}], ",", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "2"], "]"}], ",", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "3"], "]"}], ",", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "4"], "]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.699686922978266*^9, 3.699686980460097*^9}, 
   3.699687863540943*^9},ExpressionUUID->"1e5065b4-537c-4af5-b2c4-\
a8e4656fefa4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "@@", 
  RowBox[{"(", 
   RowBox[{"Transpose", " ", "/@", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Values", "[", 
       RowBox[{"$tape", "[", 
        RowBox[{"[", 
         RowBox[{"Key", " ", "/@", " ", 
          RowBox[{"Sort", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Keys", "[", "$tape", "]"}], ",", " ", "0"}], "]"}], 
           "]"}]}], "]"}], "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"{", 
         SubscriptBox["\[Sigma]", "y"], "}"}], "}"}], "}"}]}], "]"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.6996870222377286`*^9, 3.6996870671853895`*^9}, {
  3.6996872003085318`*^9, 3.6996872272069335`*^9}, {3.699687881206217*^9, 
  3.69968788579228*^9}},ExpressionUUID->"fefcbc11-27a0-454a-a129-\
ff93748fcd4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["x", "1"], "]"}], " ", 
     SubscriptBox["\[Sigma]", "y"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["x", "2"], "]"}], " ", 
     SubscriptBox["\[Sigma]", "y"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["x", "3"], "]"}], " ", 
     SubscriptBox["\[Sigma]", "y"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["x", "4"], "]"}], " ", 
     SubscriptBox["\[Sigma]", "y"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6996870255407734`*^9, 3.699687067829398*^9}, {
   3.699687219300824*^9, 3.6996872276279397`*^9}, 
   3.699687886292287*^9},ExpressionUUID->"7eb2c5b3-7829-44d1-97f9-\
50af9b18a836"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "@@", 
  RowBox[{"(", 
   RowBox[{"Transpose", " ", "/@", "  ", 
    RowBox[{"Values", "[", 
     RowBox[{"$tape", "[", 
      RowBox[{"[", 
       RowBox[{"Key", " ", "/@", " ", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Keys", "[", "$tape", "]"}], ",", " ", "0"}], "]"}], 
         "]"}]}], "]"}], "]"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.6996875871977406`*^9, 3.69968759230083*^9}, {
  3.699687891075351*^9, 
  3.6996878926903753`*^9}},ExpressionUUID->"5bcb1b91-3ffc-495b-bf5d-\
bc40d43fdf59"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "1"], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "2"], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "3"], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "4"], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.699687593352848*^9, 
  3.699687893147382*^9},ExpressionUUID->"d761dadc-d827-416a-a791-\
d6fcbd606bb9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2", "Subsection",
 CellChangeTimes->{{3.699688019399957*^9, 
  3.699688031371152*^9}},ExpressionUUID->"4ea9fdd9-39b5-46ac-a678-\
bdc9d4efdd27"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$tape", "=", 
  RowBox[{"<|", 
   RowBox[{"0", "\[Rule]", "Nothing"}], "|>"}]}]], "Input",ExpressionUUID->\
"ba5c8553-f87e-491b-9411-08f5fbb0e4fa"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"0", "\[Rule]", "Nothing"}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.699688043030341*^9, 3.6996929996258736`*^9, {3.6996941968773823`*^9, 
   3.699694208529499*^9}, 3.699694268759113*^9, 3.6996950494021626`*^9, 
   3.699695236508514*^9, 3.6996954308752556`*^9, 
   3.6996955218738775`*^9},ExpressionUUID->"7762711c-2b0f-49a4-970e-\
e7ddc0217ace"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "ad", "]"}]], "Input",
 CellChangeTimes->{{3.6996941449038515`*^9, 
  3.6996941506459093`*^9}},ExpressionUUID->"1bac289f-f63a-4741-9c90-\
82d01a30593a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ad", " ", "/:", " ", 
    RowBox[{"Total", "[", 
     RowBox[{"ad", "[", 
      RowBox[{"expr_", ",", " ", "vars_"}], "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "=", 
          RowBox[{"Plus", "@@", "expr"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"jac", "=", 
          RowBox[{"D", "[", 
           RowBox[{"out", ",", " ", 
            RowBox[{"{", "vars", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"jac", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ArrayDepth", "[", "jac", "]"}], "\[Equal]", "1"}], ",", 
            " ", 
            RowBox[{"{", "jac", "}"}], ",", " ", "jac"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"$tape", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
            "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "out"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "ad"}], " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{"ad", "[", 
       RowBox[{"expr_", ",", " ", "vars_"}], "]"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{"Times", "@@", "expr"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jac", "=", 
         RowBox[{"D", "[", 
          RowBox[{"out", ",", " ", 
           RowBox[{"{", "vars", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jac", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ArrayDepth", "[", "jac", "]"}], "\[Equal]", "1"}], ",", 
           " ", 
           RowBox[{"{", "jac", "}"}], ",", " ", "jac"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"$tape", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
           "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}],
       "\[IndentingNewLine]", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ad", " ", "/:", " ", 
    RowBox[{
     RowBox[{"ad", "[", 
      RowBox[{"expr1_", ",", " ", "vars1_"}], "]"}], " ", "+", " ", 
     RowBox[{"ad", "[", 
      RowBox[{"expr2_", ",", " ", "vars2_"}], "]"}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{"expr1", " ", "+", " ", "expr2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"jac", "=", 
        RowBox[{"D", "[", 
         RowBox[{"out", ","}], " ", "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ad", "/:", 
    RowBox[{"f_", "[", 
     RowBox[{"ad", "[", 
      RowBox[{"expr_", ",", " ", "vars_"}], "]"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{"f", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"jac", "=", 
        RowBox[{"D", "[", 
         RowBox[{"out", ",", " ", 
          RowBox[{"{", "vars", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"jac", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ArrayDepth", "[", "jac", "]"}], "\[Equal]", "1"}], ",", 
          " ", 
          RowBox[{"{", "jac", "}"}], ",", " ", "jac"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"$tape", ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
          "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.699694155758962*^9, 3.6996941662570696`*^9}, {
  3.699694970362238*^9, 3.6996950427808475`*^9}, {3.699695411678338*^9, 
  3.699695413648418*^9}, {3.6996955030098963`*^9, 3.6996955142094407`*^9}, {
  3.6996961275178723`*^9, 
  3.699696185291794*^9}},ExpressionUUID->"58cba7c3-95f1-407b-a27d-\
4e9c19c877ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xVar", "=", 
   RowBox[{"Identity", "[", 
    RowBox[{"ad", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", " ", 
        SubscriptBox["x", "2"], ",", " ", 
        SubscriptBox["x", "3"], ",", " ", 
        SubscriptBox["x", "4"]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", " ", 
        SubscriptBox["x", "2"], ",", " ", 
        SubscriptBox["x", "3"], ",", " ", 
        SubscriptBox["x", "4"]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.6996941873732834`*^9, 
  3.6996942034174476`*^9}},ExpressionUUID->"b61af34f-0f4c-4636-ae51-\
c5cc60a8371c"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.6996880520894704`*^9, 3.699693000445882*^9, {3.6996941938723507`*^9, 
   3.699694210819522*^9}, 3.699694274220168*^9, 3.6996950546023884`*^9, 
   3.6996952504622917`*^9, {3.6996954263289733`*^9, 3.6996954330003834`*^9}, 
   3.699695524593974*^9},ExpressionUUID->"badf6a00-620b-4d90-9d89-\
d339a4c79e74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Times", "[", 
  RowBox[{"ad", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xVar", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
      RowBox[{"xVar", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xVar", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
      RowBox[{"xVar", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6996958770940676`*^9, 
  3.6996958798671093`*^9}},ExpressionUUID->"f686e6d1-e0bc-4177-8a2c-\
06c98ff10a04"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "2"], ",", 
     SubscriptBox["x", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "2"], ",", 
     SubscriptBox["x", "4"]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.69969586865294*^9, 
  3.6996958858332014`*^9}},ExpressionUUID->"53a50ec7-7d6f-45de-86d1-\
6c3c35f445de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"u", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"ad", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xVar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"xVar", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xVar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"xVar", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", " ", 
    RowBox[{"Times", "[", 
     RowBox[{"ad", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xVar", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
         RowBox[{"xVar", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xVar", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
         RowBox[{"xVar", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.6996930414792986`*^9, 3.699693101020907*^9}, {
  3.6996942173625884`*^9, 3.6996942414178343`*^9}, {3.6996942916633472`*^9, 
  3.6996943758041997`*^9}, {3.699695064325876*^9, 3.6996950657519107`*^9}, {
  3.6996954406627493`*^9, 
  3.6996954412697983`*^9}},ExpressionUUID->"4b1551e7-d3de-47ad-a135-\
2c3d8334d1ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["x", "1"], "+", 
    SubscriptBox["x", "3"]}], ",", 
   RowBox[{"ad", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "2"], ",", 
       SubscriptBox["x", "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "2"], ",", 
       SubscriptBox["x", "4"]}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6996955264990163`*^9},ExpressionUUID->"f0db1275-b43b-48e7-b287-\
72d4bde23d51"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.6996955264990163`*^9},ExpressionUUID->"0d82dbba-4ea3-4ce1-b50e-\
bcb3399507d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"ad", "[", 
      RowBox[{"u", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", " ", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"ad", "[", 
       RowBox[{"u", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.699688066929694*^9, 3.6996881074353013`*^9}, {
  3.6996931084709826`*^9, 
  3.6996931297592025`*^9}},ExpressionUUID->"c7d1877a-f0f1-40ce-b105-\
bd64e901c6fd"],

Cell[BoxData[
 TemplateBox[{
  "General","ivar",
   "\"\\!\\(\\*RowBox[{SubscriptBox[\\\"x\\\", \\\"1\\\"], \\\"+\\\", \
SubscriptBox[\\\"x\\\", \\\"3\\\"]}]\\) is not a valid variable.\"",2,58,4,
   25576203400478175893,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699688109243329*^9, 
  3.6996931335852413`*^9},ExpressionUUID->"839e11ec-8950-4a63-b9a6-\
c656492e6ed0"],

Cell[BoxData[
 TemplateBox[{
  "General","ivar",
   "\"\\!\\(\\*RowBox[{SubscriptBox[\\\"x\\\", \\\"1\\\"], \\\"+\\\", \
SubscriptBox[\\\"x\\\", \\\"3\\\"]}]\\) is not a valid variable.\"",2,58,5,
   25576203400478175893,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699688109243329*^9, 
  3.699693133655242*^9},ExpressionUUID->"4257c18c-72e9-469d-ac5a-\
58486783c9d6"],

Cell[BoxData[
 TemplateBox[{
  "General","ivar",
   "\"\\!\\(\\*RowBox[{SubscriptBox[\\\"x\\\", \\\"2\\\"], \\\" \\\", \
SubscriptBox[\\\"x\\\", \\\"4\\\"]}]\\) is not a valid variable.\"",2,58,6,
   25576203400478175893,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699688109243329*^9, 
  3.6996931336852417`*^9},ExpressionUUID->"cc425ef8-48c7-47cc-b254-\
b1d71e445f99"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ivar\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,58,7,25576203400478175893,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699688109243329*^9, 
  3.6996931337252426`*^9},ExpressionUUID->"207aa6b2-bbcf-40d9-83f4-\
1aa2fcf0153d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["x", "1"], "+", 
     SubscriptBox["x", "3"]}], "]"}], ",", 
   RowBox[{"2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "4"]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.699688109293332*^9, 
  3.6996931337252426`*^9},ExpressionUUID->"21d4dd7f-6df7-4ad8-b406-\
a8c003014682"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], "+", 
         SubscriptBox["x", "3"]}], "}"}]], 
      RowBox[{"ad", "[", 
       RowBox[{
        SubscriptBox["x", "1"], "+", 
        SubscriptBox["x", "3"]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], "+", 
         SubscriptBox["x", "3"]}], "}"}]], 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["x", "1"], "+", 
        SubscriptBox["x", "3"]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "2"], " ", 
         SubscriptBox["x", "4"]}], "}"}]], 
      RowBox[{"ad", "[", 
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["x", "4"]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "2"], " ", 
         SubscriptBox["x", "4"]}], "}"}]], 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["x", "4"]}], "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.699688109293332*^9, 
  3.699693133735243*^9},ExpressionUUID->"f17269d9-c7e9-4015-809b-\
370ac8a3a944"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 3", "Subsection",
 CellChangeTimes->{{3.699688019399957*^9, 3.6996880230890055`*^9}, 
   3.6996979149716787`*^9},ExpressionUUID->"d9042486-6c51-447b-bef0-\
3be65e8bcc59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$tape", "=", 
  RowBox[{"<|", 
   RowBox[{"0", "\[Rule]", "Nothing"}], "|>"}]}]], "Input",
 CellChangeTimes->{{3.699679755840734*^9, 
  3.6996797650928288`*^9}},ExpressionUUID->"200fa2d0-7879-46aa-be47-\
612bae0a4bbe"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"0", "\[Rule]", "Nothing"}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.6996797680508585`*^9, {3.6996801977492104`*^9, 3.6996802156553926`*^9}, 
   3.699684278663435*^9, 3.699684352316183*^9, 3.6996844265929317`*^9, 
   3.699686416718193*^9, 3.6996864936153193`*^9, 3.6996867335048785`*^9, 
   3.699687847316698*^9, 3.699696602568205*^9, 3.6996967080058136`*^9, 
   3.6996972720786977`*^9, 3.6996979230237737`*^9, 3.699698030339899*^9, 
   3.699698479318006*^9, 3.699698563114905*^9, 3.6996985967762537`*^9, 
   3.699698894219058*^9, 3.699699535050686*^9, 3.699699578108314*^9, 
   3.6997020034301515`*^9, 3.6997021094273*^9, 3.6997021622378435`*^9, 
   3.699702253866788*^9, 3.699702370312039*^9, 3.6997024200735517`*^9, 
   3.699702736061189*^9, 3.699702818594067*^9, 3.699702851578411*^9, 
   3.699703046712385*^9, 
   3.699704291407693*^9},ExpressionUUID->"20e81c0e-e563-4b4e-ada7-\
8b86f56bfcd1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "ad", "]"}]], "Input",
 CellChangeTimes->{{3.6996801242424674`*^9, 
  3.6996801276065016`*^9}},ExpressionUUID->"c9580eb5-bda8-4e88-9d00-\
e2f3414786bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ad", "/:", " ", 
    RowBox[{"Total", "[", 
     RowBox[{"ad", "[", "expr_", "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "=", 
          RowBox[{"Plus", "@@", "expr"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"jac", "=", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"{", "out", "}"}], ",", " ", 
            RowBox[{"{", "expr", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"$tape", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
            "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "out"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "ad"}], " ", "/:", " ", 
     RowBox[{
      RowBox[{"ad", "[", "expr1_", "]"}], " ", 
      RowBox[{"ad", "[", "expr2_", "]"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{"expr1", " ", "expr2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jac", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"expr2", ",", " ", "expr1"}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"$tape", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
           "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}],
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ad", "/:", 
   RowBox[{"f_", "[", 
    RowBox[{"ad", "[", "expr_", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"f", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"jac", "=", 
       RowBox[{"D", "[", 
        RowBox[{"out", ",", " ", 
         RowBox[{"{", "expr", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"jac", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayDepth", "[", "jac", "]"}], "\[Equal]", "1"}], ",", 
         " ", 
         RowBox[{"{", "jac", "}"}], ",", " ", "jac"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"$tape", ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
         "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6996797695218735`*^9, 3.699679925910457*^9}, {
   3.6996801318405437`*^9, 3.6996801323905497`*^9}, {3.699680201521249*^9, 
   3.6996802134453707`*^9}, {3.699684270349352*^9, 3.699684274951398*^9}, {
   3.6996864935273156`*^9, 3.699686553270186*^9}, {3.6996866147151437`*^9, 
   3.699686618811203*^9}, {3.699687825127378*^9, 3.699687841642615*^9}, {
   3.6996966027582073`*^9, 3.6996966928855886`*^9}, {3.6996972464163094`*^9, 
   3.6996972665446196`*^9}, {3.69969730631821*^9, 3.699697316760359*^9}, {
   3.699697925354797*^9, 3.6996979611851835`*^9}, {3.699699435902192*^9, 
   3.6996995283745832`*^9}, {3.699702059458768*^9, 3.6997021006782107`*^9}, {
   3.699702238892635*^9, 3.6997022505557547`*^9}, {3.6997023340216627`*^9, 
   3.6997023600189295`*^9}, {3.6997024062934074`*^9, 3.699702431534668*^9}, {
   3.699703029740119*^9, 3.6997030389342527`*^9}, 
   3.6997042703184814`*^9},ExpressionUUID->"64db34dc-e58d-4426-927b-\
d9e3e624027d"],

Cell[CellGroupData[{

Cell[BoxData[{"$tape", "\[IndentingNewLine]", 
 RowBox[{"xVar", "=", 
  RowBox[{"ad", "[", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], ",", " ", 
     SubscriptBox["x", "2"], ",", " ", 
     SubscriptBox["x", "3"], ",", " ", 
     SubscriptBox["x", "4"]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.6996864407085447`*^9, 3.6996864632608747`*^9}, {
  3.699686677502056*^9, 3.699686682319128*^9}, {3.6996867535401683`*^9, 
  3.699686755830202*^9}, {3.699703063872653*^9, 
  3.699703073465795*^9}},ExpressionUUID->"3b2d045b-b15f-4d7d-82d7-\
491822f4c007"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"0", "\[Rule]", "Nothing"}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6996864654399047`*^9, 3.699686683634143*^9, 
  3.6996867590392466`*^9, 3.699687850848753*^9, 3.6996967275901175`*^9, 
  3.699697277056788*^9, 3.6996979709682846`*^9, 3.699698050712123*^9, 
  3.6996984877550917`*^9, 3.699698599556282*^9, 3.699698898772126*^9, 
  3.69969953777773*^9, 3.6996995812253637`*^9, 3.6997020081911993`*^9, 
  3.6997021124783316`*^9, 3.699702183180064*^9, 3.699702266357928*^9, 
  3.699702373296069*^9, 3.6997024330376835`*^9, 3.699702742768257*^9, 
  3.6997028218681*^9, 3.6997028546594424`*^9, 3.6997030740268035`*^9, 
  3.6997042962377415`*^9},ExpressionUUID->"11b6e282-12c2-41fe-a37c-\
526d58b55dff"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["x", "1"], ",", 
    SubscriptBox["x", "2"], ",", 
    SubscriptBox["x", "3"], ",", 
    SubscriptBox["x", "4"]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.6996864654399047`*^9, 3.699686683634143*^9, 
  3.6996867590392466`*^9, 3.699687850848753*^9, 3.6996967275901175`*^9, 
  3.699697277056788*^9, 3.6996979709682846`*^9, 3.699698050712123*^9, 
  3.6996984877550917`*^9, 3.699698599556282*^9, 3.699698898772126*^9, 
  3.69969953777773*^9, 3.6996995812253637`*^9, 3.6997020081911993`*^9, 
  3.6997021124783316`*^9, 3.699702183180064*^9, 3.699702266357928*^9, 
  3.699702373296069*^9, 3.6997024330376835`*^9, 3.699702742768257*^9, 
  3.6997028218681*^9, 3.6997028546594424`*^9, 3.6997030740268035`*^9, 
  3.6997042962477417`*^9},ExpressionUUID->"3a51d946-6657-47b2-9fe5-\
69bb8b18f910"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"0", "\[Rule]", "Nothing"}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6996864654399047`*^9, 3.699686683634143*^9, 
  3.6996867590392466`*^9, 3.699687850848753*^9, 3.6996967275901175`*^9, 
  3.699697277056788*^9, 3.6996979709682846`*^9, 3.699698050712123*^9, 
  3.6996984877550917`*^9, 3.699698599556282*^9, 3.699698898772126*^9, 
  3.69969953777773*^9, 3.6996995812253637`*^9, 3.6997020081911993`*^9, 
  3.6997021124783316`*^9, 3.699702183180064*^9, 3.699702266357928*^9, 
  3.699702373296069*^9, 3.6997024330376835`*^9, 3.699702742768257*^9, 
  3.6997028218681*^9, 3.6997028546594424`*^9, 3.6997030740268035`*^9, 
  3.6997042962477417`*^9},ExpressionUUID->"f9dd882f-b456-4cd8-9664-\
bacf9f3b0e1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"u", "=", 
  RowBox[{"Total", "[", 
   RowBox[{"ad", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xVar", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"xVar", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
      RowBox[{"xVar", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", " ", "4"}], "]"}], "]"}]}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.6996984909361267`*^9, 3.699698571975998*^9}, {
  3.699698903225196*^9, 3.6996989059872413`*^9}, {3.699699588611493*^9, 
  3.6996995891615014`*^9}, {3.699702131426526*^9, 3.6997021406346226`*^9}, {
  3.699702201983256*^9, 3.699702215972402*^9}, {3.699702278740055*^9, 
  3.699702284774117*^9}, {3.6997023808391457`*^9, 
  3.6997023932762737`*^9}},ExpressionUUID->"3e251485-eb95-4d09-9e33-\
2703c272c856"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{
   SubscriptBox["x", "1"], "+", 
   SubscriptBox["x", "2"], "+", 
   SubscriptBox["x", "4"]}], "]"}]], "Output",
 CellChangeTimes->{{3.6996985492167616`*^9, 3.6996986035283227`*^9}, 
   3.699698908419279*^9, 3.6996995489488945`*^9, 3.6996995933545637`*^9, 
   3.6997020193773303`*^9, {3.6997021167123747`*^9, 3.699702142106638*^9}, 
   3.6997021880671134`*^9, 3.6997022202454457`*^9, 3.6997022870881577`*^9, 
   3.6997023954932966`*^9, 
   3.6997024465178213`*^9},ExpressionUUID->"b5f75476-d2c3-441c-8491-\
64b40312b9a5"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.6996985492167616`*^9, 3.6996986035283227`*^9}, 
   3.699698908419279*^9, 3.6996995489488945`*^9, 3.6996995933545637`*^9, 
   3.6997020193773303`*^9, {3.6997021167123747`*^9, 3.699702142106638*^9}, 
   3.6997021880671134`*^9, 3.6997022202454457`*^9, 3.6997022870881577`*^9, 
   3.6997023954932966`*^9, 
   3.6997024465178213`*^9},ExpressionUUID->"cf7a5230-ffaf-4d44-809c-\
502d342da904"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "@@", 
  RowBox[{"Values", "[", 
   RowBox[{"$tape", "[", 
    RowBox[{"[", 
     RowBox[{"Key", " ", "/@", " ", 
      RowBox[{"ReverseSort", "[", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "$tape", "]"}], ",", " ", "0"}], "]"}], "]"}]}],
      "]"}], "]"}], "]"}]}]], "Input",ExpressionUUID->"67464ba0-af25-40e6-\
b893-456c24305147"],

Cell[BoxData[
 TemplateBox[{
  "Dot","dotsh",
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \
\\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\
\",\\\", \\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\
\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) have \
incompatible shapes.\"",2,46,1,25576304515749774946,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6996981066257005`*^9, 
  3.699702451916876*^9},ExpressionUUID->"9924a928-79a6-4bc6-9c0c-\
d638779f4170"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.6996981066557007`*^9, 
  3.6997024521068773`*^9},ExpressionUUID->"7501ba0f-cc9d-470a-b638-\
f5f9b7b9f74f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"u", "=", 
  RowBox[{"{", 
   RowBox[{"f", "[", "]"}], "}"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.699702746753297*^9, 3.6997028283321667`*^9}, {
   3.699702859882512*^9, 3.6997028788007083`*^9}, 3.6997043161479406`*^9, {
   3.699704347634256*^9, 3.69970436296941*^9}, {3.6997045264450474`*^9, 
   3.699704527025053*^9}},ExpressionUUID->"617ccf1d-87c8-40f7-8557-\
c29919cf22ec"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ad", "[", 
     RowBox[{
      SubscriptBox["x", "1"], "+", 
      SubscriptBox["x", "2"], "+", 
      SubscriptBox["x", "4"]}], "]"}], ",", 
    RowBox[{"ad", "[", 
     SubscriptBox["x", "3"], "]"}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.699702807104945*^9, 3.699702832762211*^9}, 
   3.6997028803827243`*^9},ExpressionUUID->"c9d6d705-c946-425d-bf85-\
c5f13c82c5ca"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", "1"}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.699702807104945*^9, 3.699702832762211*^9}, 
   3.6997028803827243`*^9},ExpressionUUID->"82e00b93-16e5-4c00-8ccd-\
33c45143121e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"u", "=", 
  RowBox[{"Sin", "[", 
   RowBox[{"ad", "[", "xVar", "]"}], 
   "]"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.699680032314537*^9, 3.699680043919654*^9}, {
  3.699680073959957*^9, 3.6996800815100336`*^9}, {3.6996801523757505`*^9, 
  3.6996801726309557`*^9}, {3.699684358486245*^9, 3.6996843587562475`*^9}, {
  3.699686768705406*^9, 3.699686769586422*^9}, {3.699697223153964*^9, 
  3.699697223433967*^9}},ExpressionUUID->"ddf8f6be-a134-4a86-8cd0-\
e857695bef73"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.699680173460964*^9, {3.69968020564129*^9, 3.699680218825424*^9}, 
   3.699684281249461*^9, 3.6996843604162645`*^9, 3.6996844298839655`*^9, 
   3.6996867706104374`*^9, 
   3.699687852319776*^9},ExpressionUUID->"c430e1cb-4c71-417a-9362-\
20f4d7c4a870"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Sin", "[", 
    SubscriptBox["x", "1"], "]"}], ",", 
   RowBox[{"Sin", "[", 
    SubscriptBox["x", "2"], "]"}], ",", 
   RowBox[{"Sin", "[", 
    SubscriptBox["x", "3"], "]"}], ",", 
   RowBox[{"Sin", "[", 
    SubscriptBox["x", "4"], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.699680173460964*^9, {3.69968020564129*^9, 3.699680218825424*^9}, 
   3.699684281249461*^9, 3.6996843604162645`*^9, 3.6996844298839655`*^9, 
   3.6996867706104374`*^9, 
   3.699687852319776*^9},ExpressionUUID->"9df46a8c-53af-4f0b-ab05-\
dc2b9892f5a2"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "1"], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "2"], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "3"], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "4"], "]"}]}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.699680173460964*^9, {3.69968020564129*^9, 3.699680218825424*^9}, 
   3.699684281249461*^9, 3.6996843604162645`*^9, 3.6996844298839655`*^9, 
   3.6996867706104374`*^9, 
   3.6996878523297763`*^9},ExpressionUUID->"ad93dab3-ea94-47d4-b9f6-\
545e28ec85aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v", "=", 
  RowBox[{"Total", "[", 
   RowBox[{"ad", "[", "u", "]"}], 
   "]"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.699684238402029*^9, 3.6996842482561274`*^9}, {
   3.6996842975356255`*^9, 3.6996843167158213`*^9}, {3.6996843628362885`*^9, 
   3.699684363206292*^9}, 3.6996844412870803`*^9, {3.699686780018575*^9, 
   3.6996867832506175`*^9}},ExpressionUUID->"695a7bb2-fd9e-4365-be41-\
aca85a331873"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", 
   SubscriptBox["x", "1"], "]"}], "+", 
  RowBox[{"Sin", "[", 
   SubscriptBox["x", "2"], "]"}], "+", 
  RowBox[{"Sin", "[", 
   SubscriptBox["x", "3"], "]"}], "+", 
  RowBox[{"Sin", "[", 
   SubscriptBox["x", "4"], "]"}]}]], "Output",
 CellChangeTimes->{3.6996843181868362`*^9, 3.6996843645363054`*^9, 
  3.69968444416811*^9, 3.69968678410163*^9, 
  3.6996878535507936`*^9},ExpressionUUID->"063e8d3d-b157-4644-bc5e-\
0e3cc1aacf88"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "1"], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "2"], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "3"], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "4"], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6996843181868362`*^9, 3.6996843645363054`*^9, 
  3.69968444416811*^9, 3.69968678410163*^9, 
  3.6996878535507936`*^9},ExpressionUUID->"a05cb49d-0aea-4a56-88a7-\
d69b3a284665"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$tape"], "Input",
 CellChangeTimes->{{3.6996843211758666`*^9, 
  3.6996843254059086`*^9}},ExpressionUUID->"99b0acf5-9bc2-4b6e-aceb-\
3871bfc1fa6c"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "1"], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "2"], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "3"], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"Cos", "[", 
         SubscriptBox["x", "4"], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.699684329159947*^9, 3.699684365626316*^9, 
  3.6996844451881204`*^9, 3.699686787994687*^9, 
  3.6996878549748154`*^9},ExpressionUUID->"9e4e4285-0c04-45ef-b47a-\
49e5a746f8d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "@@", 
  RowBox[{"Values", "[", 
   RowBox[{"$tape", "[", 
    RowBox[{"[", 
     RowBox[{"Key", " ", "/@", " ", 
      RowBox[{"ReverseSort", "[", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "$tape", "]"}], ",", " ", "0"}], "]"}], "]"}]}],
      "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6996869199462233`*^9, 3.699686979478083*^9}, {
  3.6996871025009885`*^9, 
  3.6996871130481405`*^9}},ExpressionUUID->"f2ee51cf-9703-4bbb-8f11-\
898684f71578"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "1"], "]"}], ",", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "2"], "]"}], ",", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "3"], "]"}], ",", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "4"], "]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.699686922978266*^9, 3.699686980460097*^9}, 
   3.699687863540943*^9},ExpressionUUID->"ef47443c-1839-4b5c-840c-\
91d27ef245ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "@@", 
  RowBox[{"(", 
   RowBox[{"Transpose", " ", "/@", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Values", "[", 
       RowBox[{"$tape", "[", 
        RowBox[{"[", 
         RowBox[{"Key", " ", "/@", " ", 
          RowBox[{"Sort", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Keys", "[", "$tape", "]"}], ",", " ", "0"}], "]"}], 
           "]"}]}], "]"}], "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"{", 
         SubscriptBox["\[Sigma]", "y"], "}"}], "}"}], "}"}]}], "]"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.6996870222377286`*^9, 3.6996870671853895`*^9}, {
  3.6996872003085318`*^9, 3.6996872272069335`*^9}, {3.699687881206217*^9, 
  3.69968788579228*^9}},ExpressionUUID->"53205259-e778-4898-95a3-\
fd8b6361d93d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["x", "1"], "]"}], " ", 
     SubscriptBox["\[Sigma]", "y"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["x", "2"], "]"}], " ", 
     SubscriptBox["\[Sigma]", "y"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["x", "3"], "]"}], " ", 
     SubscriptBox["\[Sigma]", "y"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["x", "4"], "]"}], " ", 
     SubscriptBox["\[Sigma]", "y"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6996870255407734`*^9, 3.699687067829398*^9}, {
   3.699687219300824*^9, 3.6996872276279397`*^9}, 
   3.699687886292287*^9},ExpressionUUID->"d5ef185b-e941-41b9-94d6-\
bd3c8fb48575"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "@@", 
  RowBox[{"(", 
   RowBox[{"Transpose", " ", "/@", "  ", 
    RowBox[{"Values", "[", 
     RowBox[{"$tape", "[", 
      RowBox[{"[", 
       RowBox[{"Key", " ", "/@", " ", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Keys", "[", "$tape", "]"}], ",", " ", "0"}], "]"}], 
         "]"}]}], "]"}], "]"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.6996875871977406`*^9, 3.69968759230083*^9}, {
  3.699687891075351*^9, 
  3.6996878926903753`*^9}},ExpressionUUID->"73d80534-eaa9-4423-a4ff-\
f451cd5ba810"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "1"], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "2"], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "3"], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cos", "[", 
     SubscriptBox["x", "4"], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.699687593352848*^9, 
  3.699687893147382*^9},ExpressionUUID->"f2376a37-142a-48fc-b404-\
38d10d1377b1"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 4", "Subsection",
 CellChangeTimes->{{3.699688019399957*^9, 3.6996880230890055`*^9}, 
   3.6996979149716787`*^9, 
   3.6997046406194696`*^9},ExpressionUUID->"f23afeea-82a2-40c2-be58-\
aac34c733c56"],

Cell[TextData[{
 "Only ",
 StyleBox["ad[]", "Input"],
 " quantities require propagation of sensitivities.\nProblem: how to keep \
track of the variables used in an expression, for instance ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     SubscriptBox["x", "1"], 
     StyleBox["+", "Input"], 
     StyleBox[
      SubscriptBox["x", "2"], "Input"], 
     StyleBox["+", "Input"], 
     StyleBox[
      SubscriptBox["x", "4"], "Input"]}], "Input",
    FontColor->GrayLevel[0]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "74d45177-404f-4d91-9457-ac8f816efe94"],
 " ?"
}], "Text",
 CellChangeTimes->{{3.6997048439395075`*^9, 3.699704864447713*^9}, {
  3.6997050767468424`*^9, 
  3.6997051275863514`*^9}},ExpressionUUID->"fad8b54a-bf7e-4b1c-85de-\
8deff27acbc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$test", "=", 
  RowBox[{"<|", 
   RowBox[{"0", "\[Rule]", "Nothing"}], "|>"}]}]], "Input",
 CellChangeTimes->{{3.69970464561952*^9, 
  3.699704659429658*^9}},ExpressionUUID->"7d987417-ce78-4add-8c5b-\
caa5d8657488"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"0", "\[Rule]", "Nothing"}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6997046611196747`*^9, 3.6997057079310064`*^9, 
  3.69970641894213*^9},ExpressionUUID->"afefd29f-513f-4f54-b243-77461d0561b3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "ad", "]"}]], "Input",
 CellChangeTimes->{{3.6997046627696915`*^9, 
  3.699704665349717*^9}},ExpressionUUID->"b966ec06-4598-4753-9810-\
1ab3a9f99915"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ad", "/:", " ", 
   RowBox[{"{", 
    RowBox[{"ad", "[", "expr_", "]"}], "}"}], ":=", 
   RowBox[{"ad", "[", 
    RowBox[{"{", "expr", "}"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ad", "/:", " ", 
  RowBox[{
   RowBox[{"ad", "[", "expr1_", "]"}], "+", 
   RowBox[{"ad", "[", "expr2_", "]"}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out", ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"expr1", "+", "expr2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jac", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "1"}], "}"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"$tape", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Keys", "[", "$tape", "]"}], "]"}], "+", "1"}], ")"}], 
        "\[Rule]", "jac"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.699704669549759*^9, 3.6997047113171787`*^9}, {
  3.6997055961698885`*^9, 
  3.69970569630089*^9}},ExpressionUUID->"1c52e0cd-1976-46c6-b53b-\
b79745b481c4"],

Cell[CellGroupData[{

Cell[BoxData["$tape"], "Input",
 CellChangeTimes->{{3.699705712701054*^9, 
  3.699705713391061*^9}},ExpressionUUID->"f3091f0e-0898-4cef-9e3b-\
acac7000c7ef"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.699705713591063*^9, 
  3.6997064212121525`*^9},ExpressionUUID->"eea17833-b9ed-46e3-97af-\
a7f8a28c28f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"xVar", "=", 
  RowBox[{"ad", "/@", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], ",", " ", 
     SubscriptBox["x", "2"], ",", " ", 
     SubscriptBox["x", "3"], ",", " ", 
     SubscriptBox["x", "4"]}], 
    "}"}]}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.699706188164754*^9, 
  3.699706234149749*^9}},ExpressionUUID->"2ad30fe6-ad83-496c-9178-\
c956926ccf9a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ad", "[", 
    SubscriptBox["x", "1"], "]"}], ",", 
   RowBox[{"ad", "[", 
    SubscriptBox["x", "2"], "]"}], ",", 
   RowBox[{"ad", "[", 
    SubscriptBox["x", "3"], "]"}], ",", 
   RowBox[{"ad", "[", 
    SubscriptBox["x", "4"], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6997062348277655`*^9, 
  3.699706422042161*^9},ExpressionUUID->"9766f787-aa13-434f-a1dc-\
6cdaad74f396"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6997062348277655`*^9, 
  3.699706422042161*^9},ExpressionUUID->"7f29d6ad-c561-499b-9280-\
1f39d03ed248"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ad", "[", 
   RowBox[{
    RowBox[{"xVar", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "+", 
    RowBox[{"xVar", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "+", 
  RowBox[{"xVar", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", "$tape"}], "Input",
 CellChangeTimes->{{3.69970638294177*^9, 3.699706398361924*^9}, {
  3.6997064283922243`*^9, 
  3.6997064332622733`*^9}},ExpressionUUID->"a1242d02-8be9-488f-90c0-\
cbfab3097ebe"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["x", "1"], "+", 
  SubscriptBox["x", "2"], "+", 
  SubscriptBox["x", "4"]}]], "Output",
 CellChangeTimes->{3.699706399291933*^9, 
  3.6997064348622894`*^9},ExpressionUUID->"1ecec915-cec4-4929-8ffd-\
6b3f52db869e"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "Nothing"}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.699706399291933*^9, 
  3.699706434872289*^9},ExpressionUUID->"989ba793-4570-432e-95e9-\
bc92b5e43299"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup large test", "Section",
 CellChangeTimes->{{3.6995976123817034`*^9, 3.69959761991778*^9}, {
  3.6996845213908916`*^9, 
  3.6996845214108915`*^9}},ExpressionUUID->"03f23448-2be6-4003-ba5b-\
41d0a9d47151"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nVar", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<var\>\"", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
    "  ", 
    RowBox[{"(", 
     RowBox[{"ToString", " ", "/@", " ", 
      RowBox[{"Range", "[", "nVar", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Symbol", "  ", "/@", " ", "vars"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nOper", "=", "5"}], ";"}]}], "Input",
 CellChangeTimes->{{3.69959762590984*^9, 3.699597668869276*^9}, {
   3.6995977273649244`*^9, 3.6995977608802633`*^9}, {3.6995978317909813`*^9, 
   3.699597832240986*^9}, 3.6995981258451257`*^9, {3.6995981862617364`*^9, 
   3.69959818751375*^9}, 3.699598364951545*^9, {3.699600543921661*^9, 
   3.699600557705801*^9}},ExpressionUUID->"804f3adc-762d-4a0e-89d5-\
3dd92935c503"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"args", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"local", ":=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"Range", "[", "nVar", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomChoice", "[", 
       RowBox[{"vars", ",", " ", "local"}], "]"}], " ", "&"}], " ", "/@", " ", 
     RowBox[{"Range", "[", "nOper", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.6995978382760477`*^9, 3.6995978498651648`*^9}, {
  3.699597883102501*^9, 3.6995978860975313`*^9}, {3.6995979268179903`*^9, 
  3.699597996898697*^9}, {3.699598132975197*^9, 3.6995981350282173`*^9}, {
  3.699598203796914*^9, 3.6995982735266204`*^9}, {3.6995983418123116`*^9, 
  3.6995983486303806`*^9}, {3.6995983900367994`*^9, 3.6995983951268506`*^9}, {
  3.6995984322736187`*^9, 
  3.6995984330736265`*^9}},ExpressionUUID->"271b540a-082b-4cb7-9948-\
40ae0bcab8f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"var3", ",", "var4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var4", ",", "var4", ",", "var3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var1", ",", "var3", ",", "var1", ",", "var1"}], "}"}], ",", 
   RowBox[{"{", "var1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var1", ",", "var3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6995978505351715`*^9, 3.699597886757538*^9, {3.699597946156185*^9, 
   3.699598008392813*^9}, 3.6995981420492887`*^9, 3.6995982740366254`*^9, {
   3.6995983440833344`*^9, 3.699598402799934*^9}, 3.69959843436064*^9, 
   3.6996005596528215`*^9, {3.6996006736949778`*^9, 3.6996006759449997`*^9}, {
   3.699600771486968*^9, 3.699600793890195*^9}, 3.6996096446866975`*^9, 
   3.699609678654044*^9, 3.699610245938915*^9, 
   3.6996121431162434`*^9},ExpressionUUID->"c824a5ab-67cf-474d-b7b4-\
0d2ad4ee3bfc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"aggregateArgs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"Identity", ",", " ", "3"}], "]"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Plus", " ", "@@", " ", "x"}]}], "]"}], ",", " ", "1"}], 
      "]"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Times", " ", "@@", " ", "x"}]}], "]"}], ",", " ", "1"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699600583465062*^9, 3.699600619973434*^9}, {
   3.699607420962835*^9, 3.69960748357848*^9}, 3.6996081802594404`*^9, {
   3.699610263744095*^9, 3.6996102650141077`*^9}, 3.6996121251280622`*^9, {
   3.6996128129025955`*^9, 3.699612816398631*^9}, 3.699614397653535*^9, {
   3.6996151567293797`*^9, 3.6996151743135586`*^9}, 
   3.6996793244783707`*^9},ExpressionUUID->"4aa9af17-8b66-4ed8-b01d-\
6abe32b6c763"],

Cell[BoxData[
 RowBox[{
  RowBox[{"poolOfFuncs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Sin", ",", " ", "Cos", ",", " ", "Tan", ",", " ", "Sinh", ",", " ", 
       "Cosh", ",", " ", "Tanh", ",", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{"#", ",", " ", 
          RowBox[{"-", "1"}]}], "]"}], "&"}], ",", " ", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{"#", ",", " ", "2"}], "]"}], "&"}], ",", " ", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{"#", ",", " ", "3"}], "]"}], "&"}], ",", " ", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{"#", ",", " ", "4"}], "]"}], "&"}], ",", " ", "Exp", ",", 
       " ", "Log"}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"Identity", ",", " ", "1"}], "]"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Plus", " ", "@@", " ", "x"}]}], "]"}], ",", " ", "1"}], 
      "]"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Times", " ", "@@", " ", "x"}]}], "]"}], ",", " ", "1"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699598441342711*^9, 3.699598505433361*^9}, {
   3.699598752834868*^9, 3.699598793199278*^9}, {3.6995988238265886`*^9, 
   3.69959882395659*^9}, {3.6995989419145966`*^9, 3.6995989657848387`*^9}, 
   3.69959899754516*^9, {3.6995990568087635`*^9, 3.6995990628358245`*^9}, 
   3.699599139134651*^9, {3.6995993086894193`*^9, 3.6995993304436398`*^9}, {
   3.699599434990753*^9, 3.699599456094966*^9}, {3.6996005274114947`*^9, 
   3.6996005298585196`*^9}, {3.6996011028553305`*^9, 
   3.6996011081783853`*^9}, {3.6996012861931925`*^9, 
   3.6996012886682177`*^9}, {3.6996138856805134`*^9, 
   3.6996139051917114`*^9}, {3.6996154793532176`*^9, 
   3.699615480073225*^9}},ExpressionUUID->"5c71dd62-27d4-46f5-ae75-\
be9e9bb3a283"],

Cell[CellGroupData[{

Cell[BoxData["args"], "Input",
 CellChangeTimes->{{3.699612576370123*^9, 
  3.69961257697513*^9}},ExpressionUUID->"0d1c6af0-6988-4c4b-92a5-\
fdcd35e59342"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"var3", ",", "var4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var4", ",", "var4", ",", "var3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var1", ",", "var3", ",", "var1", ",", "var1"}], "}"}], ",", 
   RowBox[{"{", "var1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var1", ",", "var3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.699612577645137*^9, 3.6996128208256755`*^9, 
  3.699613913778798*^9, 3.6996144030855904`*^9, 
  3.699615178767606*^9},ExpressionUUID->"e383c532-f441-4a7d-838a-\
714c8227fccd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"local", "=", "#"}], ",", " ", "aA", ",", " ", "aggArg", ",", 
       " ", "calc"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aA", "=", 
       RowBox[{"RandomChoice", "[", "aggregateArgs", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"aggArg", "=", " ", 
       RowBox[{"aA", "[", "local", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"aggArg", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"VectorQ", "[", "aggArg", "]"}], ",", " ", "aggArg", ",", 
         RowBox[{"{", "aggArg", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"calc", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#2", "[", "#1", "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"aggArg", ",", " ", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{"poolOfFuncs", ",", " ", 
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"{", "aggArg", "}"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"aA", "=", 
       RowBox[{"RandomChoice", "[", "aggregateArgs", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"aggArg", "=", " ", 
       RowBox[{"aA", "[", "calc", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VectorQ", "[", "aggArg", "]"}], ",", " ", "aggArg", ",", " ", 
        RowBox[{"{", "aggArg", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], " ", "&"}], " ", "/@", " ", "args"}]], "Input",
 CellChangeTimes->{{3.6996006534737744`*^9, 3.6996007069193134`*^9}, {
   3.6996007403896527`*^9, 3.699600763592888*^9}, {3.6996008018802757`*^9, 
   3.6996010319066124`*^9}, {3.699601139654704*^9, 3.699601150487814*^9}, {
   3.6996012224615445`*^9, 3.699601259655923*^9}, {3.699601299790331*^9, 
   3.699601301896353*^9}, {3.6996014184415336`*^9, 3.6996014356767073`*^9}, {
   3.6996014721190767`*^9, 3.6996015060024233`*^9}, {3.699601558244955*^9, 
   3.6996015699490747`*^9}, {3.699601601913398*^9, 3.699601623458615*^9}, {
   3.699607093649252*^9, 3.699607097599291*^9}, {3.699607142454745*^9, 
   3.6996071450077715`*^9}, {3.699607249384077*^9, 3.6996072610711956`*^9}, {
   3.699607367625293*^9, 3.6996073699673166`*^9}, {3.6996082016816597`*^9, 
   3.699608228785938*^9}, {3.6996082638792973`*^9, 3.699608303612703*^9}, {
   3.6996090006409407`*^9, 3.699609052183467*^9}, {3.699609559837833*^9, 
   3.699609630337552*^9}, {3.6996096883311424`*^9, 3.6996097259205217`*^9}, {
   3.6996097941092124`*^9, 3.699609814888426*^9}, {3.6996098594548764`*^9, 
   3.699609951001809*^9}, {3.699610017707485*^9, 3.699610025598565*^9}, {
   3.699610071034088*^9, 3.699610106001446*^9}, {3.699610366670148*^9, 
   3.699610390465392*^9}, {3.699610468738184*^9, 3.6996104771082687`*^9}, 
   3.699610754468004*^9, {3.6996117482581363`*^9, 3.6996117822924814`*^9}, {
   3.6996118696594267`*^9, 3.6996119490342298`*^9}, {3.699612078686594*^9, 
   3.6996120881196885`*^9}, {3.6996122233050704`*^9, 
   3.6996122370822096`*^9}, {3.699612600472367*^9, 3.699612609477459*^9}, {
   3.699612673092105*^9, 3.699612700561383*^9}, {3.699612760336026*^9, 
   3.6996127921093473`*^9}, {3.6996130932314863`*^9, 
   3.6996131163347197`*^9}, {3.6996132217477884`*^9, 
   3.6996132222877936`*^9}, {3.699613373351323*^9, 3.6996134225488195`*^9}, {
   3.6996137232358627`*^9, 3.699613835587006*^9}, {3.699614942886142*^9, 
   3.699615072833456*^9}},ExpressionUUID->"d58484f0-e601-4b4f-9975-\
a97900f46bea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    FractionBox["1", 
     RowBox[{"var3", "+", "var4"}]], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["var3", "2"], " ", 
     SuperscriptBox["var4", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "var1"}]], " ", 
     RowBox[{"Sin", "[", "var1", "]"}], " ", 
     RowBox[{"Sin", "[", "var3", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Sinh", "[", "var1", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Sinh", "[", 
     RowBox[{"var1", " ", "var3"}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6996131177547336`*^9, {3.6996134153477473`*^9, 3.6996134230888247`*^9}, {
   3.699613724685877*^9, 3.699613732388954*^9}, 3.6996137707403507`*^9, 
   3.6996138384770355`*^9, 3.6996139148588085`*^9, 3.6996144040355997`*^9, {
   3.6996150022987404`*^9, 3.6996150248579683`*^9}, {3.699615059749324*^9, 
   3.6996150912476425`*^9}, 
   3.6996151815396338`*^9},ExpressionUUID->"1ea3be32-7571-4b3f-8c6b-\
4c06ac754987"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"makeArgs", "::", "usage"}], "=", 
   "\"\<Builds a random list of `no` arguments by drawing samples of maximum \
size `nv` from the set `pool`\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeArgs", "[", 
   RowBox[{"pool_", ",", " ", "nv_", ",", " ", "no_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"local", ":=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"Range", "[", "nv", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomChoice", "[", 
       RowBox[{"pool", ",", " ", "local"}], "]"}], " ", "&"}], " ", "/@", " ", 
     RowBox[{"Range", "[", "no", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.699615249111339*^9, 3.69961540903996*^9}, {
  3.699615861799081*^9, 
  3.6996158641341047`*^9}},ExpressionUUID->"7be7d865-a628-4084-bad2-\
155e6c012049"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makeArgs", "[", 
  RowBox[{"vars", ",", " ", "4", ",", " ", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.699615410279972*^9, 
  3.699615421120081*^9}},ExpressionUUID->"26ced38d-8831-49bf-936f-\
9a297f04d8b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"var4", ",", "var4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var4", ",", "var2", ",", "var2", ",", "var3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var4", ",", "var3", ",", "var4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var2", ",", "var1", ",", "var4", ",", "var3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var2", ",", "var1", ",", "var3", ",", "var4"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.699615421640086*^9, 
  3.6996791789988956`*^9},ExpressionUUID->"bf9c9165-8974-4b31-a370-\
c2fb22c5456f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"makeCalc", "::", "usage"}], "=", 
   "\"\<Builds a random expression after aggregating the input arguments by \
sum, product and then applying a random sequence of elementary \
functions.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeCalc", "[", "args_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "local", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"local", "=", 
         RowBox[{
          RowBox[{"RandomChoice", "[", "aggregateArgs", "]"}], "[", "#", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"local", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", "local", "]"}], ",", " ", "local", ",", 
           " ", 
           RowBox[{"{", "local", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"local", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#2", "[", "#1", "]"}], "&"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"local", ",", " ", 
             RowBox[{"RandomChoice", "[", 
              RowBox[{"poolOfFuncs", ",", " ", 
               RowBox[{
                RowBox[{"Dimensions", "[", 
                 RowBox[{"{", "local", "}"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"local", "=", 
         RowBox[{
          RowBox[{"RandomChoice", "[", "aggregateArgs", "]"}], "[", "local", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "local", "]"}], ",", " ", "local", ",", " ", 
          RowBox[{"{", "local", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], " ", "&"}], ",", " ", "args"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6996152178410234`*^9, 3.699615240400252*^9}, {
  3.699615607036508*^9, 
  3.6996159733132067`*^9}},ExpressionUUID->"0db69831-a2bc-4e36-abc4-\
24a31b8e472e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makeCalc", "[", 
  RowBox[{"makeArgs", "[", 
   RowBox[{"vars", ",", " ", "4", ",", " ", "5"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6996159834413085`*^9, 3.699615990131379*^9}, {
  3.6996792362594757`*^9, 
  3.699679245765571*^9}},ExpressionUUID->"303a7bd0-e952-4aec-8558-\
6fe43bb50d17"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["var3", "4"], ",", 
     SuperscriptBox["var1", "2"], ",", 
     RowBox[{"Tanh", "[", "var3", "]"}], ",", 
     RowBox[{"Tanh", "[", "var3", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", "var3", "]"}], ",", 
     SuperscriptBox["\[ExponentialE]", "var1"], ",", 
     RowBox[{"Tanh", "[", "var3", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"var3", " ", 
     RowBox[{"Cosh", "[", "var4", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Log", "[", 
     RowBox[{"var1", " ", "var2", " ", "var4"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cos", "[", "var2", "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.69961599124139*^9, {3.6996791816059227`*^9, 3.6996791980620875`*^9}, {
   3.699679236859482*^9, 3.6996792549516635`*^9}, {3.699679335377481*^9, 
   3.6996793543366733`*^9}},ExpressionUUID->"205d9355-5f42-486f-be69-\
0c04610d673a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NestList", "[", 
  RowBox[{"makeCalc", ",", 
   RowBox[{"makeArgs", "[", 
    RowBox[{"vars", ",", " ", "4", ",", " ", "5"}], "]"}], ",", " ", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.699679399879134*^9, 3.699679478616933*^9}, {
  3.699679644884613*^9, 3.699679660610772*^9}, {3.6996841763824015`*^9, 
  3.699684185783496*^9}},ExpressionUUID->"7e932159-f10b-4592-9327-\
2cfd3099b14d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "var4", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"var2", ",", "var3", ",", "var2", ",", "var3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"var3", ",", "var2", ",", "var1"}], "}"}], ",", 
     RowBox[{"{", "var1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"var4", ",", "var4", ",", "var2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SuperscriptBox["var4", "4"], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["var2", "3"], ",", 
       RowBox[{"Sinh", "[", "var3", "]"}], ",", 
       RowBox[{"Cosh", "[", "var2", "]"}], ",", 
       RowBox[{"Tan", "[", "var3", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["var2", "4"], "+", 
       SuperscriptBox["var3", "4"], "+", 
       RowBox[{"Sin", "[", "var1", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sinh", "[", "var1", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["var2", "2"], " ", 
       SuperscriptBox["var4", "4"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Tanh", "[", 
       SuperscriptBox["var4", "4"], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["var2", "3"], "+", 
       RowBox[{"Cosh", "[", "var2", "]"}], "+", 
       RowBox[{"Sinh", "[", "var3", "]"}], "+", 
       RowBox[{"Tan", "[", "var3", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["var2", "4"], " ", 
       SuperscriptBox["var3", "4"], " ", 
       RowBox[{"Sin", "[", "var1", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Csch", "[", "var1", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["var2", "2"], "+", 
       SuperscriptBox["var4", "4"]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6996794516826596`*^9, 3.69967947929694*^9}, {
  3.69967964554462*^9, 
  3.6996796613407793`*^9}},ExpressionUUID->"0ac0b0e3-f341-49ca-8596-\
39d85b5b962b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Work with the tree", "Section",
 CellChangeTimes->{{3.6995976123817034`*^9, 3.69959761991778*^9}, {
  3.6996845213908916`*^9, 3.6996845214108915`*^9}, {3.69976984611653*^9, 
  3.6997698512586107`*^9}},ExpressionUUID->"f741a6b7-d743-444c-bac4-\
a244ed25b76d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$vertexCount", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$tape", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$graph", "=", 
   RowBox[{"Graph", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<x1\>\"", ",", " ", "\"\<x2\>\"", ",", " ", "\"\<x3\>\"", ",", " ", 
       "\"\<x4\>\""}], "}"}], ",", " ", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997707666749663`*^9, 3.699770885910742*^9}, {
   3.699771586334976*^9, 3.699771587928999*^9}, {3.6997729758065863`*^9, 
   3.6997729981539197`*^9}, {3.699773811014799*^9, 3.6997738196999264`*^9}, {
   3.699777914819944*^9, 3.6997779286180873`*^9}, {3.6997779924997606`*^9, 
   3.6997780251661015`*^9}, 3.6997801098897305`*^9, {3.6997887625499945`*^9, 
   3.699788768482588*^9}},ExpressionUUID->"7d35673d-10df-456b-9619-\
77d0cc444789"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "ad", "]"}]], "Input",
 CellChangeTimes->{{3.6997782029489617`*^9, 
  3.6997782092310257`*^9}},ExpressionUUID->"9a689a97-c9d6-4509-bd21-\
ef5b03c13e6c"],

Cell[BoxData[
 RowBox[{"ad", "/:", " ", 
  RowBox[{"f_", "[", 
   RowBox[{"ad", "[", 
    RowBox[{"parentVertex_", ",", " ", "expr_"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out", ",", " ", "jac", ",", " ", "childVertex"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"f", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jac", "=", 
      RowBox[{"D", "[", 
       RowBox[{"out", ",", " ", 
        RowBox[{"{", "expr", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$vertexCount", "++"}], ";", "\[IndentingNewLine]", 
     RowBox[{"childVertex", "=", 
      RowBox[{"\"\<v\>\"", "<>", 
       RowBox[{"ToString", "[", "$vertexCount", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$graph", "=", " ", 
      RowBox[{"EdgeAdd", "[", 
       RowBox[{"$graph", ",", " ", 
        RowBox[{"Thread", "[", 
         RowBox[{"parentVertex", "\[DirectedEdge]", "childVertex"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"$tape", ",", " ", 
       RowBox[{"childVertex", "\[Rule]", "jac"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ad", "[", 
      RowBox[{"childVertex", ",", " ", "out"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6997725510702677`*^9, 3.6997726077211046`*^9}, {
   3.699772652544777*^9, 3.699772662729925*^9}, {3.6997728424346013`*^9, 
   3.699772851098733*^9}, {3.699772884040225*^9, 3.6997729204937696`*^9}, {
   3.6997738394182296`*^9, 3.6997739342076254`*^9}, {3.6997739975093484`*^9, 
   3.6997740189366803`*^9}, {3.6997742286507936`*^9, 3.699774241540985*^9}, {
   3.699777505736668*^9, 3.6997775640572834`*^9}, {3.6997780363332157`*^9, 
   3.69977805282439*^9}, {3.699778170250615*^9, 3.6997781754936724`*^9}, {
   3.6997783773127794`*^9, 3.6997783792227983`*^9}, {3.6997786142552576`*^9, 
   3.699778645154584*^9}, {3.6997786921910753`*^9, 3.699778725723422*^9}, {
   3.6997788252714605`*^9, 3.6997788798210325`*^9}, 
   3.699780102101612*^9},ExpressionUUID->"c67a0972-f393-4831-abf3-\
7ec124b4b2ca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xVar", "=", 
  RowBox[{"{", 
   RowBox[{"x1", ",", " ", "x2", ",", " ", "x3", ",", " ", "x4"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.699781447292846*^9, 3.6997814651201053`*^9}, {
  3.6997887817089105`*^9, 3.6997887893866777`*^9}, {3.699788844102149*^9, 
  3.6997888517989187`*^9}},ExpressionUUID->"4ec2fde6-c3f0-4e7f-99c4-\
3d1633a4563d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}]], "Output",
 CellChangeTimes->{3.699781466916132*^9, 3.6997815240409904`*^9, 
  3.6997816029571857`*^9, 3.6997887901427536`*^9, 3.69978885221496*^9, 
  3.699788898635602*^9, 3.700457063146751*^9, 3.7005422312856445`*^9, 
  3.700557555550021*^9},ExpressionUUID->"d0ffc0f0-d977-4c3f-90de-\
fec9a5efdd9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"u", "=", 
  RowBox[{"ufun", "[", 
   RowBox[{"ad", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<x1\>\"", ",", " ", "\"\<x2\>\""}], "}"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "x2"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.699778216025095*^9, 3.69977829579093*^9}, {
  3.6997888573404727`*^9, 
  3.6997888599497337`*^9}},ExpressionUUID->"482737c2-59b7-4e57-9239-\
c9e11bfeca7f"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v1\"\>", ",", 
   RowBox[{"ufun", "[", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.699778296930941*^9, 3.699778382783841*^9, 3.6997787088402452`*^9, {
   3.6997788608828287`*^9, 3.699778881759053*^9}, 3.6997815305230885`*^9, 
   3.699781604302205*^9, 3.6997887914698863`*^9, 3.699788863255064*^9, 
   3.69978889932067*^9, 3.70045706433687*^9, 3.7005422320057883`*^9, 
   3.7005575562800283`*^9},ExpressionUUID->"d9ee7792-f768-4c25-b428-\
06c0bfacdd42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w", "=", 
  RowBox[{"wfun", "[", 
   RowBox[{"ad", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<x2\>\"", ",", " ", "\"\<x4\>\""}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x2", ",", " ", "x4"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6997784202382355`*^9, 3.6997784606976595`*^9}, {
  3.6997888680015388`*^9, 
  3.699788869976736*^9}},ExpressionUUID->"634c1be5-bd45-4c6d-942a-\
f3373b826780"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v2\"\>", ",", 
   RowBox[{"wfun", "[", 
    RowBox[{"{", 
     RowBox[{"x2", ",", "x4"}], "}"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.6997784808758674`*^9, 3.699778883489071*^9, 3.699781532786125*^9, 
   3.699781605833226*^9, {3.6997888709198303`*^9, 3.6997888999727354`*^9}, 
   3.7004570698714237`*^9, 3.7005422329409757`*^9, 
   3.7005575570100355`*^9},ExpressionUUID->"cfc7ebdd-414b-4e78-b2bf-\
3ec8e02cf4e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"vfun", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.6997785175392523`*^9, 3.6997785396514807`*^9}, {
  3.699778571801817*^9, 
  3.6997785792248964`*^9}},ExpressionUUID->"552dcb9e-c264-4310-b098-\
a947afb2357f"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v3\"\>", ",", 
   RowBox[{"vfun", "[", 
    RowBox[{"ufun", "[", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2"}], "}"}], "]"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.699778543985524*^9, 3.6997785860109653`*^9, 3.699778884931085*^9, 
   3.699781533806137*^9, 3.699781606718238*^9, {3.6997888734060793`*^9, 
   3.6997889010438423`*^9}, 3.700457081617598*^9, 3.700542234284244*^9, 
   3.700557557740043*^9},ExpressionUUID->"824d199a-89e8-472a-bb2a-\
14b814e8dd88"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"z", "=", 
  RowBox[{"zfun", "[", "v", "]"}]}]], "Input",
 CellChangeTimes->{{3.699778901253255*^9, 
  3.6997789079043255`*^9}},ExpressionUUID->"4f798574-e129-48d2-8676-\
3cdae53caa60"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v4\"\>", ",", 
   RowBox[{"zfun", "[", 
    RowBox[{"vfun", "[", 
     RowBox[{"ufun", "[", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], "]"}], "]"}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.6997789105443516`*^9, 3.699781534982155*^9, 3.6997816074762483`*^9, {
   3.699788874324171*^9, 3.699788901964935*^9}, 3.70045708303574*^9, 
   3.7005422351514177`*^9, 
   3.70055755843005*^9},ExpressionUUID->"01863aff-7c34-4f65-88c5-\
69d1f8f9d5d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y", "=", 
  RowBox[{"yfun", "[", 
   RowBox[{"ad", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x3\>\"", ",", " ", 
       "\"\<x4\>\""}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", "x3", ",", " ", "x4"}], 
      "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6997789200204496`*^9, 3.6997789686279616`*^9}, {
  3.6997889048832264`*^9, 
  3.6997889068634243`*^9}},ExpressionUUID->"be88206f-53d0-4371-b81a-\
efa479fa3174"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v5\"\>", ",", 
   RowBox[{"yfun", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
     "}"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.699778970565982*^9, 3.699781536979198*^9, 
  3.69978160826126*^9, 3.699788875207259*^9, 3.699788907662504*^9, 
  3.7004570871071467`*^9, 3.700542235970581*^9, 
  3.7005575591900578`*^9},ExpressionUUID->"d03e93b8-d0f7-40bd-90f8-\
f03df7abc188"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"tfun", "[", "y", "]"}]}]], "Input",
 CellChangeTimes->{{3.6997789755760317`*^9, 
  3.699778981347094*^9}},ExpressionUUID->"8900f1a6-6ea9-4b7f-a655-\
009d4aa67283"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v6\"\>", ",", 
   RowBox[{"tfun", "[", 
    RowBox[{"yfun", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
      "}"}], "]"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.699778983897125*^9, 3.699781537590207*^9, 
  3.6997816098002834`*^9, 3.6997888762343616`*^9, 3.69978890982072*^9, 
  3.7004570890523415`*^9, 3.7005422366977267`*^9, 
  3.700557560130067*^9},ExpressionUUID->"ad16d442-5289-4430-ba8d-\
bbc31fe93959"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindPath", "[", 
  RowBox[{"$graph", ",", "\"\<x2\>\"", ",", " ", 
   RowBox[{"t", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6997794151845264`*^9, 3.6997794825592203`*^9}, {
  3.699780219828373*^9, 3.6997802284305005`*^9}, {3.6997815440053005`*^9, 
  3.6997815477033596`*^9}, {3.6997816660651274`*^9, 3.699781688066451*^9}, {
  3.6997817397882237`*^9, 3.699781743017272*^9}, {3.69978887991173*^9, 
  3.699788880767815*^9}},ExpressionUUID->"6d0713b5-6647-4a4c-9439-\
b70b07d95428"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\<\"x2\"\>", ",", "\<\"v2\"\>", ",", "\<\"v5\"\>", 
    ",", "\<\"v6\"\>"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.699779442425807*^9, 3.69977944873787*^9}, {
   3.6997794800491953`*^9, 3.699779483029225*^9}, {3.6997802222704077`*^9, 
   3.699780228900508*^9}, {3.6997815392832346`*^9, 3.699781548393369*^9}, 
   3.6997816114633083`*^9, {3.6997816696281843`*^9, 3.699781688896463*^9}, 
   3.699781743447279*^9, 3.6997888810448427`*^9, 3.6997889116849065`*^9, 
   3.7004570906194983`*^9},ExpressionUUID->"2e080c76-b230-400f-bb7e-\
d884126b7bf5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"First", "[", 
   RowBox[{"FindPath", "[", 
    RowBox[{"$graph", ",", " ", "\"\<x2\>\"", ",", " ", 
     RowBox[{"t", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], " ", "//", 
  "FullForm"}]], "Input",
 CellChangeTimes->{{3.6997803470242558`*^9, 3.6997803672715483`*^9}, {
  3.6997889891906567`*^9, 3.6997889946041975`*^9}, {3.699789854659195*^9, 
  3.699789861983927*^9}},ExpressionUUID->"764f9e47-2fcd-4b9f-b4e0-\
37f723916a9d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "\"\<x2\>\"", ",", "\"\<v2\>\"", ",", "\"\<v5\>\"", ",", "\"\<v6\>\""}], 
    "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{{3.699780343582205*^9, 3.6997803683515625`*^9}, 
   3.6997889950002375`*^9, 3.6997898624479733`*^9, 
   3.700457091601596*^9},ExpressionUUID->"e870450d-b1ec-4dee-bb77-\
1e57c1d10438"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Values", "[", 
   RowBox[{"$tape", "[", 
    RowBox[{"[", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"First", "[", 
         RowBox[{"FindPath", "[", 
          RowBox[{"$graph", ",", " ", "\"\<x2\>\"", ",", " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], " ", "]"}], ",", 
       " ", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.699790045559283*^9, 3.6997901120749335`*^9}, {
  3.700546192866356*^9, 
  3.700546195576302*^9}},ExpressionUUID->"c37ee885-1495-435b-8253-\
09b81d3db91e"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      SuperscriptBox["tfun", "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"yfun", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
        "}"}], "]"}], "]"}], "\<\"\"\>", "\<\"\"\>"},
    {
     RowBox[{
      SuperscriptBox["yfun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
       "}"}], "]"}], 
     RowBox[{
      SuperscriptBox["yfun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
       "}"}], "]"}], 
     RowBox[{
      SuperscriptBox["yfun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
       "}"}], "]"}]},
    {
     RowBox[{
      SuperscriptBox["wfun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "x4"}], "}"}], "]"}], 
     RowBox[{
      SuperscriptBox["wfun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "x4"}], "}"}], "]"}], "\<\"\"\>"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  TableForm[{
    Derivative[1][$CellContext`tfun][
     $CellContext`yfun[{
       $CellContext`wfun[{$CellContext`x2, $CellContext`x4}], \
$CellContext`x3, $CellContext`x4}]], {
     Derivative[{1, 0, 0}][$CellContext`yfun][{
       $CellContext`wfun[{$CellContext`x2, $CellContext`x4}], \
$CellContext`x3, $CellContext`x4}], 
     Derivative[{0, 1, 0}][$CellContext`yfun][{
       $CellContext`wfun[{$CellContext`x2, $CellContext`x4}], \
$CellContext`x3, $CellContext`x4}], 
     Derivative[{0, 0, 1}][$CellContext`yfun][{
       $CellContext`wfun[{$CellContext`x2, $CellContext`x4}], \
$CellContext`x3, $CellContext`x4}]}, {
     Derivative[{1, 
      0}][$CellContext`wfun][{$CellContext`x2, $CellContext`x4}], 
     Derivative[{0, 
      1}][$CellContext`wfun][{$CellContext`x2, $CellContext`x4}]}}]]], \
"Output",
 CellChangeTimes->{
  3.6997900484345703`*^9, {3.69979007924065*^9, 3.699790112420968*^9}, 
   3.70045709273971*^9, 3.7005461961062913`*^9, 
   3.700558354219554*^9},ExpressionUUID->"c2dba081-6fcf-4a5d-9704-\
c9ad09b4d3de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["tfun", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{"yfun", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
       "}"}], "]"}], "]"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["yfun", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
        "}"}], "]"}], ",", 
      RowBox[{
       SuperscriptBox["yfun", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
        "}"}], "]"}], ",", 
      RowBox[{
       SuperscriptBox["yfun", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
        "}"}], "]"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7004648019405527`*^9, 3.7004648438507433`*^9}, {
  3.7004648740737658`*^9, 
  3.7004648859079485`*^9}},ExpressionUUID->"2d5ff372-ee2a-4ab8-8577-\
13f1cc7cd6fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["tfun", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{"yfun", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
       "}"}], "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["yfun", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
      "}"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["tfun", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{"yfun", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
       "}"}], "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["yfun", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
      "}"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["tfun", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{"yfun", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
       "}"}], "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["yfun", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "x4"}], "}"}], "]"}], ",", "x3", ",", "x4"}], 
      "}"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7004648158579445`*^9, 3.7004648245838175`*^9}, {
  3.7004648759529533`*^9, 
  3.700464886285987*^9}},ExpressionUUID->"05e1f15c-ed63-4430-9a61-\
22b3692c4f2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindPath", "[", 
  RowBox[{"$graph", ",", " ", "\"\<x4\>\"", ",", " ", 
   RowBox[{"t", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "Infinity", ",", " ", "All"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7004760777271414`*^9, 3.7004760834537134`*^9}, {
  3.700476131040472*^9, 3.7004761317455425`*^9}, {3.7004761865870256`*^9, 
  3.7004761879901667`*^9}},ExpressionUUID->"dc1bd8de-5b16-4fe3-bbd6-\
6047ee9943a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"x4\"\>", ",", "\<\"v5\"\>", ",", "\<\"v6\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"x4\"\>", ",", "\<\"v2\"\>", ",", "\<\"v5\"\>", 
     ",", "\<\"v6\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7004760843728056`*^9, 3.7004761323546033`*^9, 
  3.7004761883091984`*^9},ExpressionUUID->"d267e68a-379b-4618-ac2d-\
c83cf53c243b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindPath", "[", 
  RowBox[{"$graph", ",", " ", "\"\<x2\>\"", ",", " ", 
   RowBox[{"z", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "Infinity", ",", " ", "All"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7004769186492248`*^9, 
  3.70047694100246*^9}},ExpressionUUID->"41bffc4d-bf4e-4c7b-9527-\
4fb3aad41714"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\<\"x2\"\>", ",", "\<\"v1\"\>", ",", "\<\"v3\"\>", 
    ",", "\<\"v4\"\>"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7004769415985193`*^9},ExpressionUUID->"c971416b-3230-4cc1-aeea-\
d92eedfb887c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Values", "[", 
   RowBox[{"$tape", "[", 
    RowBox[{"[", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"First", "[", 
         RowBox[{"FindPath", "[", 
          RowBox[{"$graph", ",", " ", "\"\<x2\>\"", ",", " ", 
           RowBox[{"z", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], " ", "]"}], ",", 
       " ", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], " ", "//", " ", 
  "TableForm"}]], "Input",
 CellChangeTimes->{
  3.7004775473730907`*^9, {3.7005461085280423`*^9, 
   3.700546111890975*^9}},ExpressionUUID->"5e201175-7787-4321-bb6f-\
0d02e8d4a07a"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      SuperscriptBox["zfun", "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"vfun", "[", 
       RowBox[{"ufun", "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], "]"}], "]"}], "\<\"\"\>"},
    {
     RowBox[{
      SuperscriptBox["vfun", "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"ufun", "[", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2"}], "}"}], "]"}], "]"}], "\<\"\"\>"},
    {
     RowBox[{
      SuperscriptBox["ufun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], "]"}], 
     RowBox[{
      SuperscriptBox["ufun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], "]"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  TableForm[{
    Derivative[1][$CellContext`zfun][
     $CellContext`vfun[
      $CellContext`ufun[{$CellContext`x1, $CellContext`x2}]]], 
    Derivative[1][$CellContext`vfun][
     $CellContext`ufun[{$CellContext`x1, $CellContext`x2}]], {
     Derivative[{1, 
      0}][$CellContext`ufun][{$CellContext`x1, $CellContext`x2}], 
     Derivative[{0, 
      1}][$CellContext`ufun][{$CellContext`x1, $CellContext`x2}]}}]]], \
"Output",
 CellChangeTimes->{3.700477548020156*^9, 3.700542332789727*^9, 
  3.7005461123309665`*^9},ExpressionUUID->"1949d82e-c4e9-4d7a-b85b-\
e3db77e70990"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Work with the tree - inverse", "Section",
 CellChangeTimes->{{3.6995976123817034`*^9, 3.69959761991778*^9}, {
  3.6996845213908916`*^9, 3.6996845214108915`*^9}, {3.69976984611653*^9, 
  3.6997698512586107`*^9}, {3.7005628581078143`*^9, 
  3.7005628596078444`*^9}},ExpressionUUID->"047d33c1-314f-474f-a7e6-\
50a70bb39d70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$vertexCount", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$tape", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$graph", "=", 
   RowBox[{"Graph", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<x1\>\"", ",", " ", "\"\<x2\>\"", ",", " ", "\"\<x3\>\"", ",", " ", 
       "\"\<x4\>\""}], "}"}], ",", " ", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997707666749663`*^9, 3.699770885910742*^9}, {
   3.699771586334976*^9, 3.699771587928999*^9}, {3.6997729758065863`*^9, 
   3.6997729981539197`*^9}, {3.699773811014799*^9, 3.6997738196999264`*^9}, {
   3.699777914819944*^9, 3.6997779286180873`*^9}, {3.6997779924997606`*^9, 
   3.6997780251661015`*^9}, 3.6997801098897305`*^9, {3.6997887625499945`*^9, 
   3.699788768482588*^9}},ExpressionUUID->"180d2616-9aad-4471-9675-\
e6c3cee4f5a1"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"ad", ",", " ", "adList"}], "]"}]], "Input",
 CellChangeTimes->{{3.6997782029489617`*^9, 3.6997782092310257`*^9}, {
  3.7074836074351587`*^9, 3.707483608506266*^9}, {3.7075410459982796`*^9, 
  3.70754106280596*^9}},ExpressionUUID->"0ae41313-5953-4edd-93ae-\
cbb071165d28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ad", " ", "/:", " ", 
   RowBox[{"f_", "[", 
    RowBox[{"ad", "[", 
     RowBox[{"parentVertex_", ",", " ", "expr_"}], "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", " ", "jac", ",", " ", "childVertex"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"f", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"jac", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"parentVertex", "\[Rule]", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "out", "]"}], "[", " ",
           "expr", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"$vertexCount", "++"}], ";", "\[IndentingNewLine]", 
      RowBox[{"childVertex", "=", 
       RowBox[{"\"\<v\>\"", "<>", 
        RowBox[{"ToString", "[", "$vertexCount", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"$graph", "=", " ", 
       RowBox[{"EdgeAdd", "[", 
        RowBox[{"$graph", ",", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{"childVertex", "\[DirectedEdge]", "parentVertex"}], "]"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"$tape", ",", " ", 
        RowBox[{"childVertex", "\[Rule]", "jac"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ad", "[", 
       RowBox[{"childVertex", ",", " ", "out"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"/;", " ", 
    RowBox[{"ArrayQ", "[", 
     RowBox[{"adList", ",", " ", "1", ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "#", "]"}], "\[Equal]", "ad"}], " ", "&"}]}], 
     "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"adList", " ", "/:", " ", 
  RowBox[{"f_", "[", 
   RowBox[{"adList", "[", "adlist_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"args", ",", "out", ",", " ", "jac", ",", " ", "childVertex"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"args", " ", "=", " ", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"adlist", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"f", "[", "args", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jac", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Association", ",", "  ", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"adlist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", 
                RowBox[{"Sequence", " ", "@@", " ", "#"}], "]"}], "[", "f", 
               "]"}], "[", "args", "]"}], " ", "&"}], " ", "/@", " ", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Length", "[", "adlist", "]"}], "]"}]}], ")"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$vertexCount", "++"}], ";", "\[IndentingNewLine]", 
     RowBox[{"childVertex", "=", 
      RowBox[{"\"\<v\>\"", "<>", 
       RowBox[{"ToString", "[", "$vertexCount", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$graph", "=", " ", 
      RowBox[{"EdgeAdd", "[", 
       RowBox[{"$graph", ",", " ", 
        RowBox[{"Thread", "[", 
         RowBox[{"childVertex", "\[DirectedEdge]", 
          RowBox[{"adlist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"$tape", ",", " ", 
       RowBox[{"childVertex", "\[Rule]", "jac"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ad", "[", 
      RowBox[{"childVertex", ",", " ", "out"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQnf9pfUnJ/NeOKrvVSkH0k1abHhAtzf+rD0SfDHs8
A0Snu2nPAtEh/+YJlwLpVzPfSIBoxZj1CiB61gkfNRBt+qnNB0Tvv7/UH0Q7
FkyZAqLrFQVmgWgxvqoFIHoO06+VIJqH5/duEO1XMeECiFZzDGcsA9L7/Dey
gegHwcWSIDo2yEMWRE8scVAE0ecjpZVBNKcVsxeIztiZBKZ7PjKHg2ifhK44
EH3lRX4GiBZy88oF0S+2MU0A0bleS8G0Uy7bEhCdlbsGTN9QW7EGRMdxXdgJ
omVmvb8Gote9nHwbRPelxB2fBNLna3ACRAMAZa+lSw==
  "],ExpressionUUID->"1ceb9171-0b5d-481f-adf8-80c3e5ce18da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"ad", "[", 
   RowBox[{"1", ",", " ", "Pi"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.707483361160534*^9, 
  3.707483369503368*^9}},ExpressionUUID->"e53092fa-9227-466e-90b9-\
2d8e281ee20b"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v1\"\>", ",", 
   RowBox[{"f", "[", "\[Pi]", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7074833718386016`*^9, 3.707483432986716*^9, 
  3.707483617779193*^9},ExpressionUUID->"2e6cbea0-cb1a-4b67-bfe4-\
416841a6b225"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "[", 
  RowBox[{"adList", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ad", "[", 
      RowBox[{"1", ",", " ", "Pi"}], "]"}], ",", " ", 
     RowBox[{"ad", "[", 
      RowBox[{"2", ",", " ", "\[ExponentialE]"}], "]"}]}], "}"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.707483623966812*^9, 
  3.7074836648068953`*^9}},ExpressionUUID->"7f1caeca-2164-4dbe-bae5-\
a0200c92f103"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v1\"\>", ",", 
   RowBox[{"g", "[", 
    RowBox[{"\[Pi]", ",", "\[ExponentialE]"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.7074836658459997`*^9},ExpressionUUID->"06811dc8-2536-461d-b50f-\
58732ced4fe8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ad", "/:", " ", 
   RowBox[{"f_", "[", 
    RowBox[{"ad", "[", 
     RowBox[{"parentVertex_", ",", " ", "expr_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"out", ",", " ", "jac", ",", " ", "childVertex"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{"f", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jac", "=", 
         RowBox[{"Association", "[", 
          RowBox[{"parentVertex", "\[Rule]", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", "1", "]"}], "[", "out", "]"}], "[", 
            " ", "expr", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"$vertexCount", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"childVertex", "=", 
         RowBox[{"\"\<v\>\"", "<>", 
          RowBox[{"ToString", "[", "$vertexCount", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$graph", "=", " ", 
         RowBox[{"EdgeAdd", "[", 
          RowBox[{"$graph", ",", " ", 
           RowBox[{"Thread", "[", 
            RowBox[{"childVertex", "\[DirectedEdge]", "parentVertex"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"$tape", ",", " ", 
          RowBox[{"childVertex", "\[Rule]", "jac"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ad", "[", 
         RowBox[{"childVertex", ",", " ", "out"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "ad"}], "/:", " ", 
    RowBox[{"f_", "[", 
     RowBox[{
      RowBox[{"ad", "[", 
       RowBox[{"parentVertex1_", ",", " ", "expr1_"}], "]"}], ",", " ", 
      RowBox[{"ad", "[", 
       RowBox[{"parentVertex2_", ",", " ", "expr2_"}], "]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"out", ",", " ", "jac", ",", " ", "childVertex"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "=", 
          RowBox[{"f", "[", 
           RowBox[{"expr1", ",", " ", "expr2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"jac", "=", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{"parentVertex1", "\[Rule]", 
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", 
                RowBox[{"1", ",", "0"}], "]"}], "[", "out", "]"}], "[", 
              RowBox[{"expr1", ",", " ", "expr2"}], "]"}]}], ",", " ", 
            RowBox[{"parentVertex2", "\[Rule]", 
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", 
                RowBox[{"0", ",", " ", "1"}], "]"}], "[", "out", "]"}], "[", 
              RowBox[{"expr1", ",", " ", "expr2"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$vertexCount", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"childVertex", "=", 
          RowBox[{"\"\<v\>\"", "<>", 
           RowBox[{"ToString", "[", "$vertexCount", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$graph", "=", " ", 
          RowBox[{"EdgeAdd", "[", 
           RowBox[{"$graph", ",", " ", 
            RowBox[{"Thread", "[", 
             RowBox[{"childVertex", "\[DirectedEdge]", 
              RowBox[{"{", 
               RowBox[{"parentVertex1", ",", " ", "parentVertex2"}], "}"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AssociateTo", "[", 
          RowBox[{"$tape", ",", " ", 
           RowBox[{"childVertex", "\[Rule]", "jac"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ad", "[", 
          RowBox[{"childVertex", ",", " ", "out"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "ad"}], "/:", " ", 
     RowBox[{"f_", "[", 
      RowBox[{
       RowBox[{"ad", "[", 
        RowBox[{"parentVertex1_", ",", " ", "expr1_"}], "]"}], ",", " ", 
       RowBox[{"ad", "[", 
        RowBox[{"parentVertex2_", ",", " ", "expr2_"}], "]"}], ",", " ", 
       RowBox[{"ad", "[", 
        RowBox[{"parentVertex3_", ",", " ", "expr3_"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"out", ",", " ", "jac", ",", " ", "childVertex"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{"f", "[", 
          RowBox[{"expr1", ",", " ", "expr2", ",", " ", "expr3"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"jac", "=", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"parentVertex1", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", 
               RowBox[{"1", ",", "0", ",", "0"}], "]"}], "[", "out", "]"}], 
             "[", 
             RowBox[{"expr1", ",", " ", "expr2", ",", " ", "expr3"}], "]"}]}],
            ",", " ", 
           RowBox[{"parentVertex2", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", 
               RowBox[{"0", ",", "1", ",", "0"}], "]"}], "[", "out", "]"}], 
             "[", 
             RowBox[{"expr1", ",", " ", "expr2", ",", " ", "expr3"}], "]"}]}],
            ",", " ", 
           RowBox[{"parentVertex3", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", 
               RowBox[{"0", ",", "0", ",", "1"}], "]"}], "[", "out", "]"}], 
             "[", 
             RowBox[{"expr1", ",", " ", "expr2", ",", " ", "expr3"}], 
             "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"$vertexCount", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"childVertex", "=", 
         RowBox[{"\"\<v\>\"", "<>", 
          RowBox[{"ToString", "[", "$vertexCount", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$graph", "=", " ", 
         RowBox[{"EdgeAdd", "[", 
          RowBox[{"$graph", ",", " ", 
           RowBox[{"Thread", "[", 
            RowBox[{"childVertex", "\[DirectedEdge]", 
             RowBox[{"{", 
              RowBox[{
              "parentVertex1", ",", " ", "parentVertex2", ",", " ", 
               "parentVertex3"}], "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"$tape", ",", " ", 
          RowBox[{"childVertex", "\[Rule]", "jac"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ad", "[", 
         RowBox[{"childVertex", ",", " ", "out"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6997725510702677`*^9, 3.6997726077211046`*^9}, {
   3.699772652544777*^9, 3.699772662729925*^9}, {3.6997728424346013`*^9, 
   3.699772851098733*^9}, {3.699772884040225*^9, 3.6997729204937696`*^9}, {
   3.6997738394182296`*^9, 3.6997739342076254`*^9}, {3.6997739975093484`*^9, 
   3.6997740189366803`*^9}, {3.6997742286507936`*^9, 3.699774241540985*^9}, {
   3.699777505736668*^9, 3.6997775640572834`*^9}, {3.6997780363332157`*^9, 
   3.69977805282439*^9}, {3.699778170250615*^9, 3.6997781754936724`*^9}, {
   3.6997783773127794`*^9, 3.6997783792227983`*^9}, {3.6997786142552576`*^9, 
   3.699778645154584*^9}, {3.6997786921910753`*^9, 3.699778725723422*^9}, {
   3.6997788252714605`*^9, 3.6997788798210325`*^9}, 3.699780102101612*^9, {
   3.700563590440879*^9, 3.7005636291424923`*^9}, {3.700563904941421*^9, 
   3.7005639312316837`*^9}, {3.7005646487796445`*^9, 
   3.7005647587208443`*^9}, {3.7005648606948833`*^9, 3.700564898287636*^9}, {
   3.700569271542964*^9, 3.70056939081235*^9}, {3.7027155337817717`*^9, 
   3.702715563255499*^9}, {3.707478941733344*^9, 
   3.707478946303344*^9}},ExpressionUUID->"17a29353-2a40-449e-8f7d-\
edbb23400ea7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x1Var", "=", 
   RowBox[{"ad", "[", 
    RowBox[{"\"\<x1\>\"", ",", " ", "x1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2Var", "=", 
   RowBox[{"ad", "[", 
    RowBox[{"\"\<x2\>\"", ",", " ", "x2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x3Var", "=", 
   RowBox[{"ad", "[", 
    RowBox[{"\"\<x3\>\"", ",", " ", "x3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x4Var", "=", 
   RowBox[{"ad", "[", 
    RowBox[{"\"\<x4\>\"", ",", " ", "x4"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7005639440568123`*^9, 
  3.7005639985093575`*^9}},ExpressionUUID->"7de35c56-4df8-4cdc-a718-\
68c09bf378a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xVar", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1Var", ",", " ", "x2Var", ",", " ", "x3Var", ",", " ", "x4Var"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7074716376622686`*^9, 
  3.707471661971699*^9}},ExpressionUUID->"707314ee-a8fc-4925-8cde-\
07eb5e7a397a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"u", "=", 
    RowBox[{"ufun", "[", 
     RowBox[{"x1Var", ",", " ", "x2Var"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"u", "=", 
   RowBox[{"ufun", "[", 
    RowBox[{"adList", "[", 
     RowBox[{"{", 
      RowBox[{"x1Var", ",", " ", "x2Var"}], "}"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.699778216025095*^9, 3.69977829579093*^9}, {
  3.6997888573404727`*^9, 3.6997888599497337`*^9}, {3.700564020859581*^9, 
  3.7005640350017223`*^9}, {3.7005648022537146`*^9, 3.700564804233754*^9}, {
  3.7075378231460266`*^9, 3.7075378378104925`*^9}, {3.70753790828854*^9, 
  3.707537910749786*^9}},ExpressionUUID->"4970be8b-9678-4fe8-bb1f-\
774aadb2ceac"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v1\"\>", ",", 
   RowBox[{"ufun", "[", 
    RowBox[{"x1", ",", "x2"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.699778296930941*^9, 3.699778382783841*^9, 3.6997787088402452`*^9, {
   3.6997788608828287`*^9, 3.699778881759053*^9}, 3.6997815305230885`*^9, 
   3.699781604302205*^9, 3.6997887914698863`*^9, 3.699788863255064*^9, 
   3.69978889932067*^9, 3.70045706433687*^9, 3.7005422320057883`*^9, 
   3.7005575562800283`*^9, 3.7005648077938256`*^9, 3.7005649109178886`*^9, 
   3.700565053329737*^9, 3.7005693963924613`*^9, 3.7027016838752747`*^9, 
   3.702707501832546*^9, 3.7027155751307793`*^9, 3.7074556524556446`*^9, 
   3.7074775615986075`*^9, {3.707477669753422*^9, 3.7074776791913657`*^9}, 
   3.7075378608357954`*^9, 
   3.7075379112058315`*^9},ExpressionUUID->"c03c82e3-b715-4bb2-befd-\
d34ce827eef1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"w", "=", 
    RowBox[{"wfun", "[", 
     RowBox[{"x2Var", ",", " ", "x4Var"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"w", "=", 
   RowBox[{"wfun", "[", 
    RowBox[{"adList", "[", 
     RowBox[{"{", 
      RowBox[{"x2Var", ",", " ", "x4Var"}], "}"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6997784202382355`*^9, 3.6997784606976595`*^9}, {
  3.6997888680015388`*^9, 3.699788869976736*^9}, {3.7005649217101045`*^9, 
  3.700564930290276*^9}, {3.707537918879599*^9, 
  3.707537929830694*^9}},ExpressionUUID->"7a6a6938-a95b-4c4e-9056-\
c2aae8a1c4cf"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v2\"\>", ",", 
   RowBox[{"wfun", "[", 
    RowBox[{"x2", ",", "x4"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.6997784808758674`*^9, 3.699778883489071*^9, 3.699781532786125*^9, 
   3.699781605833226*^9, {3.6997888709198303`*^9, 3.6997888999727354`*^9}, 
   3.7004570698714237`*^9, 3.7005422329409757`*^9, 3.7005575570100355`*^9, 
   3.700564933700344*^9, 3.7005650533997383`*^9, 3.700569397232478*^9, 
   3.702701686345324*^9, 3.7027075025425606`*^9, 3.7027155758007956`*^9, 
   3.707455668793645*^9, 3.707477562614709*^9, {3.7074776716066074`*^9, 
   3.707477680026449*^9}, 
   3.7075379309538064`*^9},ExpressionUUID->"c645468e-38cf-47d5-bfde-\
6d709762735c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"vfun", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.6997785175392523`*^9, 3.6997785396514807`*^9}, {
  3.699778571801817*^9, 
  3.6997785792248964`*^9}},ExpressionUUID->"ea0b6e9a-d348-4c68-8cd5-\
ae0533e74d4d"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v3\"\>", ",", 
   RowBox[{"vfun", "[", 
    RowBox[{"ufun", "[", 
     RowBox[{"x1", ",", "x2"}], "]"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.699778543985524*^9, 3.6997785860109653`*^9, 3.699778884931085*^9, 
   3.699781533806137*^9, 3.699781606718238*^9, {3.6997888734060793`*^9, 
   3.6997889010438423`*^9}, 3.700457081617598*^9, 3.700542234284244*^9, 
   3.700557557740043*^9, 3.70056483001427*^9, 3.700564934960369*^9, 
   3.7005650534597397`*^9, 3.700569397912492*^9, 3.702701690043399*^9, 
   3.7027075032425747`*^9, 3.702715576461814*^9, 3.707455672715645*^9, 
   3.7074775635388017`*^9, 3.7074776831897655`*^9, 
   3.7075379389366045`*^9},ExpressionUUID->"73965f3b-7468-4904-ba39-\
1e1b5f08fc99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"z", "=", 
  RowBox[{"zfun", "[", "v", "]"}]}]], "Input",
 CellChangeTimes->{{3.699778901253255*^9, 
  3.6997789079043255`*^9}},ExpressionUUID->"9da6ffbc-9af0-4b1a-a035-\
728a021e75a2"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v4\"\>", ",", 
   RowBox[{"zfun", "[", 
    RowBox[{"vfun", "[", 
     RowBox[{"ufun", "[", 
      RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.6997789105443516`*^9, 3.699781534982155*^9, 3.6997816074762483`*^9, {
   3.699788874324171*^9, 3.699788901964935*^9}, 3.70045708303574*^9, 
   3.7005422351514177`*^9, 3.70055755843005*^9, 3.700564842704524*^9, 
   3.7005649381704335`*^9, 3.7005650535297413`*^9, 3.700569398622506*^9, 
   3.702701691263423*^9, 3.7027075040725913`*^9, 3.7027155772128315`*^9, 
   3.7074556750236444`*^9, 3.707477564302878*^9, 3.7074776841518617`*^9, 
   3.707537939763687*^9},ExpressionUUID->"2c668d40-cb89-44ae-bccc-\
06a9f9c493c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"y", "=", 
    RowBox[{"yfun", "[", 
     RowBox[{"w", ",", " ", "x3Var", ",", " ", "x4Var"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"y", "=", 
   RowBox[{"yfun", "[", 
    RowBox[{"adList", "[", 
     RowBox[{"{", 
      RowBox[{"w", ",", " ", "x3Var", ",", " ", "x4Var"}], "}"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6997789200204496`*^9, 3.6997789686279616`*^9}, {
  3.6997889048832264`*^9, 3.6997889068634243`*^9}, {3.700564948630643*^9, 
  3.700564952810726*^9}, {3.7075379446601768`*^9, 
  3.7075379544871597`*^9}},ExpressionUUID->"1b8604da-c4b1-475c-82ed-\
2fa77b85c331"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v5\"\>", ",", 
   RowBox[{"yfun", "[", 
    RowBox[{
     RowBox[{"wfun", "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.699778970565982*^9, 3.699781536979198*^9, 
  3.69978160826126*^9, 3.699788875207259*^9, 3.699788907662504*^9, 
  3.7004570871071467`*^9, 3.700542235970581*^9, 3.7005575591900578`*^9, 
  3.700564970682084*^9, 3.700565053599743*^9, 3.700569399492523*^9, 
  3.702701692358445*^9, 3.702707504914608*^9, 3.702715578003852*^9, 
  3.7074556761186447`*^9, 3.707477565464994*^9, 3.707477685107957*^9, 
  3.7075379548701973`*^9},ExpressionUUID->"364b3c38-8edb-483b-a047-\
bbbc245bc3f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"tfun", "[", "y", "]"}]}]], "Input",
 CellChangeTimes->{{3.6997789755760317`*^9, 
  3.699778981347094*^9}},ExpressionUUID->"83de9f6a-4a6f-4ea9-b136-\
e6a1c43386e4"],

Cell[BoxData[
 RowBox[{"ad", "[", 
  RowBox[{"\<\"v6\"\>", ",", 
   RowBox[{"tfun", "[", 
    RowBox[{"yfun", "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.699778983897125*^9, 3.699781537590207*^9, 
  3.6997816098002834`*^9, 3.6997888762343616`*^9, 3.69978890982072*^9, 
  3.7004570890523415`*^9, 3.7005422366977267`*^9, 3.700557560130067*^9, 
  3.7005649753621774`*^9, 3.700565053659744*^9, 3.700569400262539*^9, 
  3.702701694008478*^9, 3.7027075057346244`*^9, 3.7027155787638693`*^9, 
  3.7074556770526447`*^9, 3.707477566194067*^9, 3.7074776866531115`*^9, 
  3.707537956425353*^9},ExpressionUUID->"d8c356a5-ab33-4e25-812c-\
b2cd4b8f3508"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindPath", "[", 
  RowBox[{"$graph", ",", " ", 
   RowBox[{"z", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x1\>\"", ",", " ", 
   "Infinity", ",", " ", "All"}], "]"}]], "Input",
 CellChangeTimes->{{3.7005649965126004`*^9, 3.7005650149369693`*^9}, {
   3.7005650647499657`*^9, 3.7005651241651545`*^9}, {3.7005658071218166`*^9, 
   3.700565818252039*^9}, 
   3.7005671858504076`*^9},ExpressionUUID->"6ef1e68a-8b6c-47ab-af1e-\
77888bd56d3c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\<\"v4\"\>", ",", "\<\"v3\"\>", ",", "\<\"v1\"\>", 
    ",", "\<\"x1\"\>"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.700565015806987*^9, {3.7005650798002663`*^9, 3.7005651247851667`*^9}, 
   3.7005658196120663`*^9, 3.7005671869404297`*^9, 3.702701696917537*^9, 
   3.7074563030048904`*^9},ExpressionUUID->"3dbde846-2572-417c-9fad-\
9257bbb9f01d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindPath", "[", 
  RowBox[{"$graph", ",", " ", 
   RowBox[{"t", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x4\>\"", ",", " ", 
   "Infinity", ",", " ", "All"}], "]"}]], "Input",
 CellChangeTimes->{{3.7074564388844767`*^9, 
  3.707456447310319*^9}},ExpressionUUID->"a9135a69-efd3-47ce-8abc-\
9cb57617a7a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"x4\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"v2\"\>", 
     ",", "\<\"x4\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7074564480423927`*^9},ExpressionUUID->"3740479b-2b03-44a3-8b19-\
9db04e17bcac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{"#", ",", " ", "2", ",", " ", "1"}], "]"}], "&"}], " ", "/@", " ", 
  RowBox[{"FindPath", "[", 
   RowBox[{"$graph", ",", " ", 
    RowBox[{"z", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x1\>\"", ",", " ", 
    "Infinity", ",", " ", "All"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.70056719147052*^9, 
  3.700567227133233*^9}},ExpressionUUID->"08d0b3fc-808a-4d61-b1d2-\
28edb4d80bdd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"v4\"\>", ",", "\<\"v3\"\>"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\<\"v3\"\>", ",", "\<\"v1\"\>"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\<\"v1\"\>", ",", "\<\"x1\"\>"}], "}"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.700567204812787*^9, 3.7005672275932426`*^9}, 
   3.702701698247564*^9},ExpressionUUID->"f35468f3-2236-4175-b7d0-\
729755cf53b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$tape", "[", "\"\<v4\>\"", "]"}], "[", "\"\<v3\>\"", "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.7005672424835405`*^9, 
  3.7005672982596564`*^9}},ExpressionUUID->"5ec7bd4c-9e81-4f0d-a820-\
ce1bd5285e2f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"zfun", "[", 
    RowBox[{"vfun", "[", 
     RowBox[{"ufun", "[", 
      RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], "\[Prime]",
   MultilineFunction->None], "[", 
  RowBox[{"vfun", "[", 
   RowBox[{"ufun", "[", 
    RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.700567257556842*^9, 3.7005672938595686`*^9, 
  3.7027017021476426`*^9},ExpressionUUID->"0d398567-a0f2-41ee-ac6b-\
aa3fdaef1384"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{"#", ",", " ", "2", ",", " ", "1"}], "]"}], "&"}], " ", "/@", " ", 
  RowBox[{"FindPath", "[", 
   RowBox[{"$graph", ",", " ", 
    RowBox[{"t", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x4\>\"", ",", " ", 
    "Infinity", ",", " ", "All"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7005678419003725`*^9, 
  3.7005678525207977`*^9}},ExpressionUUID->"6d71f596-911f-41ed-9516-\
775e8efa86c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"v5\"\>", ",", "\<\"x4\"\>"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"v5\"\>", ",", "\<\"v2\"\>"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"v2\"\>", ",", "\<\"x4\"\>"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7005678533308296`*^9, 
  3.702701702891658*^9},ExpressionUUID->"9003f8c2-9f71-4561-9b91-\
4ffa4d688993"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra", "[", 
   RowBox[{"a_Association", ",", " ", "keys_List"}], "]"}], ":=", 
  RowBox[{"Times", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", " ", 
     "keys"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7005678825046825`*^9, 3.700567945627946*^9}, 
   3.700568027751588*^9},ExpressionUUID->"364c4c57-3f96-4f1e-830e-\
669fe45a8209"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ra", "[", 
      RowBox[{"$tape", ",", "#"}], "]"}], "  ", "&"}], " ", "/@", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", " ", "2", ",", " ", "1"}], "]"}], "&"}], " ", "/@", 
      " ", 
      RowBox[{"FindPath", "[", 
       RowBox[{"$graph", ",", " ", 
        RowBox[{"t", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x4\>\"", ",", " ", 
        "Infinity", ",", " ", "All"}], "]"}]}], ")"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.700567948007993*^9, 3.700568002699087*^9}, {
  3.700568039181817*^9, 3.700568046611965*^9}, {3.70056808283469*^9, 
  3.700568085034734*^9}, {3.700569506718668*^9, 
  3.700569521110956*^9}},ExpressionUUID->"ed378fe7-a7e2-4d6d-a55b-\
9e75125c794b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"tfun", "[", 
     RowBox[{"yfun", "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
     "]"}], "\[Prime]",
    MultilineFunction->None], "[", 
   RowBox[{"yfun", "[", 
    RowBox[{
     RowBox[{"wfun", "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], "]"}], 
  " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], "+", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.700567971728468*^9, {3.7005680035391035`*^9, 3.700568047751988*^9}, 
   3.7005680853347397`*^9, 3.700569419972933*^9, {3.700569514500824*^9, 
   3.7005695213909616`*^9}, 3.7027017045456915`*^9, 
   3.702710719476033*^9},ExpressionUUID->"78c94d79-b447-431f-a6bb-\
7995b0e22369"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ra", "[", 
      RowBox[{"$tape", ",", "#"}], "]"}], "  ", "&"}], " ", "/@", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", " ", "2", ",", " ", "1"}], "]"}], "&"}], " ", "/@", 
      " ", 
      RowBox[{"FindPath", "[", 
       RowBox[{"$graph", ",", " ", 
        RowBox[{"t", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x2\>\"", ",", " ", 
        "Infinity", ",", " ", "All"}], "]"}]}], ")"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{
  3.7027108535162945`*^9},ExpressionUUID->"9fd2cb0a-a066-4fd0-8e9d-\
f1698fd15b24"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"tfun", "[", 
     RowBox[{"yfun", "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
     "]"}], "\[Prime]",
    MultilineFunction->None], "[", 
   RowBox[{"yfun", "[", 
    RowBox[{
     RowBox[{"wfun", "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], "]"}], 
  " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"wfun", "[", 
     RowBox[{"x2", ",", "x4"}], "]"}], 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x2", ",", "x4"}], "]"}], " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"yfun", "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{
    RowBox[{"wfun", "[", 
     RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{
  3.7027108539803057`*^9},ExpressionUUID->"f9dea3c7-c41f-4abd-9f52-\
2e1447926f48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ra", "[", 
      RowBox[{"$tape", ",", "#"}], "]"}], "  ", "&"}], " ", "/@", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", " ", "2", ",", " ", "1"}], "]"}], "&"}], " ", "/@", 
      " ", 
      RowBox[{"FindPath", "[", 
       RowBox[{"$graph", ",", " ", 
        RowBox[{"z", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x1\>\"", ",", " ", 
        "Infinity", ",", " ", "All"}], "]"}]}], ")"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.702711073656801*^9, 
  3.70271108594505*^9}},ExpressionUUID->"8dcfee6b-3cd1-48bd-b3ba-\
acdc3e7590e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"vfun", "[", 
     RowBox[{"ufun", "[", 
      RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "\[Prime]",
    MultilineFunction->None], "[", 
   RowBox[{"ufun", "[", 
    RowBox[{"x1", ",", "x2"}], "]"}], "]"}], " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"zfun", "[", 
     RowBox[{"vfun", "[", 
      RowBox[{"ufun", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], "\[Prime]",
    MultilineFunction->None], "[", 
   RowBox[{"vfun", "[", 
    RowBox[{"ufun", "[", 
     RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"ufun", "[", 
     RowBox[{"x1", ",", "x2"}], "]"}], 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x1", ",", "x2"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.702711074506818*^9, 
  3.70271108646506*^9}},ExpressionUUID->"339d9842-a4fa-41b9-bf9e-\
2dc26a8c1c49"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ra", "[", 
      RowBox[{"$tape", ",", "#"}], "]"}], "  ", "&"}], " ", "/@", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", " ", "2", ",", " ", "1"}], "]"}], "&"}], " ", "/@", 
      " ", 
      RowBox[{"FindPath", "[", 
       RowBox[{"$graph", ",", " ", 
        RowBox[{"z", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<x2\>\"", ",", " ", 
        "Infinity", ",", " ", "All"}], "]"}]}], ")"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{
  3.702711129915941*^9},ExpressionUUID->"cff74416-1c5c-43c1-8765-\
8699b9326535"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"vfun", "[", 
     RowBox[{"ufun", "[", 
      RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "\[Prime]",
    MultilineFunction->None], "[", 
   RowBox[{"ufun", "[", 
    RowBox[{"x1", ",", "x2"}], "]"}], "]"}], " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"zfun", "[", 
     RowBox[{"vfun", "[", 
      RowBox[{"ufun", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], "\[Prime]",
    MultilineFunction->None], "[", 
   RowBox[{"vfun", "[", 
    RowBox[{"ufun", "[", 
     RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"ufun", "[", 
     RowBox[{"x1", ",", "x2"}], "]"}], 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x1", ",", "x2"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.7027111304859524`*^9},ExpressionUUID->"07c4db52-b35e-4a70-b44b-\
052a2645fce6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$tape"], "Input",
 CellChangeTimes->{{3.7027047405406756`*^9, 3.7027047448077617`*^9}, {
  3.7027114807621202`*^9, 
  3.7027114830401664`*^9}},ExpressionUUID->"58ad2f59-d738-4733-b6f9-\
755fc382ffe2"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"v1\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"x1\"\>", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ufun", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}]}], ",", 
      RowBox[{"\<\"x2\"\>", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ufun", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"v2\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"x2\"\>", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x2", ",", "x4"}], "]"}]}], ",", 
      RowBox[{"\<\"x4\"\>", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x2", ",", "x4"}], "]"}]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"v3\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{"\<\"v1\"\>", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"vfun", "[", 
         RowBox[{"ufun", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"ufun", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], "]"}]}], "\[RightAssociation]"}]}], 
   ",", 
   RowBox[{"\<\"v4\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{"\<\"v3\"\>", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"zfun", "[", 
         RowBox[{"vfun", "[", 
          RowBox[{"ufun", "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"vfun", "[", 
        RowBox[{"ufun", "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}]}], 
     "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"v5\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"v2\"\>", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"yfun", "[", 
          RowBox[{
           RowBox[{"wfun", "[", 
            RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], 
      ",", 
      RowBox[{"\<\"x3\"\>", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"yfun", "[", 
          RowBox[{
           RowBox[{"wfun", "[", 
            RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], 
      ",", 
      RowBox[{"\<\"x4\"\>", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"yfun", "[", 
          RowBox[{
           RowBox[{"wfun", "[", 
            RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}],
      "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"v6\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{"\<\"v5\"\>", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"tfun", "[", 
         RowBox[{"yfun", "[", 
          RowBox[{
           RowBox[{"wfun", "[", 
            RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
         "]"}], "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       "]"}]}], "\[RightAssociation]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.7027047454477744`*^9, 
  3.7027114833601727`*^9},ExpressionUUID->"45e6cf7b-02ce-442b-b07b-\
b6fd693b91e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FindPath", "[", 
        RowBox[{"$graph", ",", " ", "\"\<v6\>\"", ",", "#", ",", " ", 
         RowBox[{"{", "1", "}"}]}], "]"}], "&"}], " ", "/@", " ", 
      RowBox[{"VertexList", "[", "$graph", "]"}]}], ",", " ", 
     RowBox[{"{", "}"}]}], "]"}], ",", " ", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.7027078082961025`*^9, 3.7027078724814034`*^9}, {
   3.7027079283405347`*^9, 3.702707928730542*^9}, {3.7027081039700923`*^9, 
   3.702708148183988*^9}, {3.7027087927048407`*^9, 3.7027088504700108`*^9}, 
   3.7027089506958256`*^9, 
   3.702709475877462*^9},ExpressionUUID->"5d2d709e-e7f1-4f64-be1b-\
f6cee3102e47"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7027088256825094`*^9, 3.7027088511000233`*^9}, 
   3.702708951455841*^9, 
   3.702709476487474*^9},ExpressionUUID->"54c0b6ea-2f36-42fd-b143-\
8649bdf090af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FindPath", "[", 
        RowBox[{"$graph", ",", " ", "\"\<v5\>\"", ",", "#", ",", " ", 
         RowBox[{"{", "1", "}"}]}], "]"}], "&"}], " ", "/@", " ", 
      RowBox[{"VertexList", "[", "$graph", "]"}]}], ",", " ", 
     RowBox[{"{", "}"}]}], "]"}], ",", " ", "1"}], "]"}]], "Input",
 CellChangeTimes->{
  3.702709483526618*^9},ExpressionUUID->"5136fc6b-d348-4359-902f-\
0ab7a42f128e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"v5\"\>", ",", "\<\"x3\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"v5\"\>", ",", "\<\"x4\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"v5\"\>", ",", "\<\"v2\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702709484036628*^9},ExpressionUUID->"fa3030a1-fea7-414e-8319-\
7c1504d2a67d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FindPath", "[", 
        RowBox[{"$graph", ",", " ", "\"\<x1\>\"", ",", "#", ",", " ", 
         RowBox[{"{", "1", "}"}]}], "]"}], "&"}], " ", "/@", " ", 
      RowBox[{"VertexList", "[", "$graph", "]"}]}], ",", " ", 
     RowBox[{"{", "}"}]}], "]"}], ",", " ", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.7027106644856987`*^9, 
  3.7027106647767067`*^9}},ExpressionUUID->"30953308-3f71-4aea-9e84-\
b9ed3ab88f66"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.7027106689768114`*^9},ExpressionUUID->"af006c04-d7de-411d-8096-\
04529ada3bee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$tape", "[", "\"\<v5\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.702719948766323*^9, 
  3.702719953034094*^9}},ExpressionUUID->"0a5097d7-19a3-49a3-80ae-\
924098a0c944"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"v2\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], ",", 
   RowBox[{"\<\"x3\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], ",", 
   RowBox[{"\<\"x4\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.702719953581463*^9},ExpressionUUID->"fa8559ff-3132-4b92-a798-\
e4524f659562"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"outVertex", "=", "\"\<v5\>\""}], ",", "jout", ",", "jac", ",", 
     " ", "inVertex"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jout", "=", 
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"jac", "=", 
     RowBox[{"$tape", "[", "outVertex", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"inVertex", "=", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FindPath", "[", 
             RowBox[{"$graph", ",", " ", "outVertex", ",", "#", ",", " ", 
              RowBox[{"{", "1", "}"}]}], "]"}], "&"}], " ", "/@", " ", 
           RowBox[{"VertexList", "[", "$graph", "]"}]}], ",", " ", 
          RowBox[{"{", "}"}]}], "]"}], ",", " ", "1"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"jac", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"jac", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       "inVertex"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Association", "[", 
     RowBox[{"Thread", "[", 
      RowBox[{"inVertex", "\[Rule]", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "jac", "]"}], ",", " ", "jout"}], "]"}]}], 
      "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7027154921297626`*^9, 3.7027155018460007`*^9}, {
   3.7027156075505776`*^9, 3.7027156226589413`*^9}, {3.702716670134845*^9, 
   3.702716823656583*^9}, 3.7027170832639904`*^9, {3.7027172762256975`*^9, 
   3.7027173132966065`*^9}, {3.702719015489498*^9, 3.702719034384964*^9}, 
   3.702719596584591*^9, {3.702723400236269*^9, 3.7027234799943495`*^9}, {
   3.7027248762368736`*^9, 3.7027248779404993`*^9}, {3.7027249355294237`*^9, 
   3.7027249365734396`*^9}, {3.7027250187375636`*^9, 3.702725041939728*^9}, {
   3.7027255178929214`*^9, 3.702725542193304*^9}, {3.7027256105748024`*^9, 
   3.702725765961074*^9}, {3.7074596963092556`*^9, 3.70745974825706*^9}, 
   3.7074609680673733`*^9},ExpressionUUID->"781c48f4-f5d6-4b44-bed8-\
116a2e07bb22"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"x3\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"x4\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"v2\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
     "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.7027166709448633`*^9, 3.702716684959201*^9}, 
   3.7027168120442905`*^9, 3.702717315069652*^9, {3.7027190164125285`*^9, 
   3.7027190353789873`*^9}, {3.702725674452022*^9, 3.7027257670246906`*^9}, {
   3.707459701402746*^9, 3.7074597497929068`*^9}, 
   3.7074610760371695`*^9},ExpressionUUID->"581287a3-b079-4751-93e1-\
df3d52b9df02"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$tape", "[", "\"\<v2\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7027260160469437`*^9, 
  3.702726020673618*^9}},ExpressionUUID->"331db509-bf98-4aa2-8ee0-\
b22308b58204"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"x2\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x2", ",", "x4"}], "]"}]}], ",", 
   RowBox[{"\<\"x4\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x2", ",", "x4"}], "]"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.70272602148623*^9},ExpressionUUID->"834fc2f5-928c-4858-b833-134fd5110581"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FindPath", "[", 
        RowBox[{"$graph", ",", " ", "\"\<v5\>\"", ",", "#", ",", " ", 
         RowBox[{"{", "1", "}"}]}], "]"}], "&"}], " ", "/@", " ", 
      RowBox[{"VertexList", "[", "$graph", "]"}]}], ",", " ", 
     RowBox[{"{", "}"}]}], "]"}], ",", " ", "1"}], "]"}]], "Input",ExpressionU\
UID->"be3b6ed1-d7ee-4e73-97d1-e7163423b532"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"v5\"\>", ",", "\<\"x3\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"v5\"\>", ",", "\<\"x4\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"v5\"\>", ",", "\<\"v2\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702717078413878*^9},ExpressionUUID->"a333f77e-3ea5-48c4-8cc0-\
0c5b5aa45c6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"$tape", "[", "\"\<v5\>\"", "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"\"\<x3\>\"", ",", " ", "\"\<x4\>\"", ",", " ", "\"\<v2\>\""}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.702717092719235*^9, 
  3.7027171451325154`*^9}},ExpressionUUID->"4618f414-26c6-4fcd-a104-\
3cbf4bd2b81f"],

Cell[BoxData[
 TemplateBox[{
  "Part","pspec1",
   "\"Part specification \\!\\(\\*RowBox[{\\\"\\\\\\\"x4\\\\\\\"\\\"}]\\) is \
not applicable.\"",2,27,1,25596052805800918401,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.702717145603526*^9},ExpressionUUID->"74e3eeb6-05b9-486a-bfe5-\
d02dfc753260"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"\<\"v2\"\>", "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], 
    ",", 
    RowBox[{"\<\"x3\"\>", "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], 
    ",", 
    RowBox[{"\<\"x4\"\>", "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}], 
   "\[RightAssociation]"}], "\[LeftDoubleBracket]", 
  RowBox[{"\<\"x3\"\>", ",", "\<\"x4\"\>", ",", "\<\"v2\"\>"}], 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.702717100661426*^9, 
  3.702717145613527*^9}},ExpressionUUID->"201ee606-887e-428d-a5e7-\
30f7b017ef67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$tape", "[", "\"\<v5\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.702717149466628*^9, 3.702717212883171*^9}, {
   3.7027193047885127`*^9, 3.702719308343598*^9}, 
   3.7027195845773087`*^9},ExpressionUUID->"ae813fe0-5b3f-46b6-9c57-\
00538332a098"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"v2\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], ",", 
   RowBox[{"\<\"x3\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], ",", 
   RowBox[{"\<\"x4\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.7027171588838577`*^9, 3.702717213473186*^9}, 
   3.7027193091176176`*^9, 
   3.702719585448329*^9},ExpressionUUID->"b05da7d9-6558-4c17-ab8f-\
357ab193b032"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$tape", "[", "\"\<v5\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.702716717247986*^9, 
  3.7027167220321026`*^9}},ExpressionUUID->"301c7bba-f287-4f58-8a4e-\
031ba3a99c83"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"v2\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], ",", 
   RowBox[{"\<\"x3\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], ",", 
   RowBox[{"\<\"x4\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.7027167224721136`*^9},ExpressionUUID->"07b4cca3-9a8a-485e-b5fe-\
8b71f87ab96d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VertexList", "[", "$graph", "]"}]], "Input",
 CellChangeTimes->{{3.702722001758805*^9, 3.7027220211745157`*^9}, {
  3.7027220784126225`*^9, 3.70272210615767*^9}, {3.7027221495965524`*^9, 
  3.7027221660560217`*^9}, {3.702722276488586*^9, 
  3.7027222773479986`*^9}},ExpressionUUID->"b5f80d1b-202a-4e6f-b4f3-\
66d5c31dec4c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"x1\"\>", ",", "\<\"x2\"\>", ",", "\<\"x3\"\>", 
   ",", "\<\"x4\"\>", ",", "\<\"v1\"\>", ",", "\<\"v2\"\>", ",", "\<\"v3\"\>",
    ",", "\<\"v4\"\>", ",", "\<\"v5\"\>", ",", "\<\"v6\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.702722084072515*^9, 3.702722106533476*^9}, {
   3.7027221538790283`*^9, 3.702722166681432*^9}, 
   3.7027222777862053`*^9},ExpressionUUID->"00195e08-1456-4aef-8a8b-\
1fb888bf71a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindPath", "[", 
  RowBox[{"$graph", ",", " ", "\"\<v6\>\"", ",", " ", 
   RowBox[{"xVar", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], ",", " ", "Infinity", ",", 
   " ", "All"}], "]"}]], "Input",
 CellChangeTimes->{{3.7074716706705685`*^9, 3.7074716895264544`*^9}, {
  3.707471763057807*^9, 
  3.707471808242325*^9}},ExpressionUUID->"f5bae13f-7497-47c8-bc2f-\
171c3fc36260"],

Cell[BoxData[
 TemplateBox[{
  "FindPath","inv",
   "\"The argument \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"\\\\\\\"x1\\\\\\\"\
\\\", \\\",\\\", \\\"\\\\\\\"x2\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"x3\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"x4\\\\\\\"\\\"}], \
\\\"}\\\"}]\\) in \\!\\(\\*PaneBox[\\\"\\\\\\\"FindPath[Graph[<10>, <10>], \
v6, {x1, x2, x3, x4}, Infinity, All]\\\\\\\"\\\"]\\) is not a valid \
\\!\\(\\*RowBox[{\\\"\\\\\\\"vertex\\\\\\\"\\\"}]\\).\"",2,44,8,
   25627098932803688196,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.707471796755176*^9, 
  3.7074718086193624`*^9}},ExpressionUUID->"497f9b10-f661-4059-9181-\
5c0abc6d1333"],

Cell[BoxData[
 RowBox[{"FindPath", "[", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{
        "x1", "x2", "x3", "x4", "v1", "v2", "v3", "v4", "v5", "v6"}, {{{5, 
         1}, {5, 2}, {6, 2}, {6, 4}, {7, 5}, {8, 7}, {9, 6}, {9, 3}, {9, 4}, {
         10, 9}}, Null}, {VertexLabels -> {Automatic}}]]}, 
      TagBox[GraphicsGroupBox[{
         {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
          ArrowBox[{{0., 1.}, {0., 0.}}, 0.030239520958083826`], 
          ArrowBox[{{0., 1.}, {1., 0.}}, 0.030239520958083826`], 
          ArrowBox[{{2., 1.}, {1., 0.}}, 0.030239520958083826`], 
          ArrowBox[{{2., 1.}, {3., 0.}}, 0.030239520958083826`], 
          ArrowBox[{{0., 2.}, {0., 1.}}, 0.030239520958083826`], 
          ArrowBox[{{0., 3.}, {0., 2.}}, 0.030239520958083826`], 
          ArrowBox[{{2., 2.}, {1., 1.}}, 0.030239520958083826`], 
          ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQDQUOMNrszpUermQGh0nuYc9eWf63r0yde0nuGoMD
n+nRqEPB/+xPzo68aBPJ6FB0wie2zfevvXI9Z2fKG0aHPYxv35qp/7Hv5F/7
c2o/k8PbB0t5rjz4Zf/Xx0X5ohOzA3ta+c7Yqp/2NebnWcXYWBw4JiZ+ufz5
uz37ed+FKTdZHD4lpuw18/1mP0/4wNc9e1gdDt2oF2lr+2J/NSX0qL8Zm0Nq
l4qfWv1ne5NEUeGpC9kc7vcK2b7N/mS/k4Phfs8/Ngf9x54Pb/l8tE+OFtU0
92V3COk6ZfVe8YO9WWTox8m97A7z2TQnh1x7a6/HdMB88X52B6c5/tISga/t
/cJC/6Q8ZneYeJWDT3PLC/spoaL2N3+wO/RsCslu///UHhIsHA7GYPDY/j8Y
sDvM29h93T7/AVz+HH/3lMblt+0ZoXzxnINiOQevweUlK3aZ2utcgvNXpL95
9PX8aTh/it3LyXYvD8P5D15e+7PBYyec/0/rTCcf6wo4HxZxABaEqeA=
           "]], 0.030239520958083826`], 
          ArrowBox[{{2., 2.}, {2., 1.}}, 0.030239520958083826`], 
          ArrowBox[{{2., 3.}, {2., 2.}}, 0.030239520958083826`]}, 
         {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
          0.7]}], {DiskBox[{0., 0.}, 0.030239520958083826], 
           InsetBox["\<\"x1\"\>", 
            Offset[{2, 2}, {0.030239520958083826, 0.030239520958083826}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.030239520958083826],
            InsetBox["\<\"x2\"\>", 
            Offset[{2, 2}, {1.030239520958084, 0.030239520958083826}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{1., 1.}, 0.030239520958083826],
            InsetBox["\<\"x3\"\>", 
            Offset[{2, 2}, {1.030239520958084, 1.030239520958084}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{3., 0.}, 0.030239520958083826],
            InsetBox["\<\"x4\"\>", 
            Offset[{2, 2}, {3.0302395209580837, 0.030239520958083826}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{0., 1.}, 0.030239520958083826],
            InsetBox["\<\"v1\"\>", 
            Offset[{2, 2}, {0.030239520958083826, 1.030239520958084}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{2., 1.}, 0.030239520958083826],
            InsetBox["\<\"v2\"\>", 
            Offset[{2, 2}, {2.0302395209580837, 1.030239520958084}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{0., 2.}, 0.030239520958083826],
            InsetBox["\<\"v3\"\>", 
            Offset[{2, 2}, {0.030239520958083826, 2.0302395209580837}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{0., 3.}, 0.030239520958083826],
            InsetBox["\<\"v4\"\>", 
            Offset[{2, 2}, {0.030239520958083826, 3.0302395209580837}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{2., 2.}, 0.030239520958083826],
            InsetBox["\<\"v5\"\>", 
            Offset[{2, 2}, {2.0302395209580837, 2.0302395209580837}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {DiskBox[{2., 3.}, 0.030239520958083826],
            InsetBox["\<\"v6\"\>", 
            Offset[{2, 2}, {2.0302395209580837, 3.0302395209580837}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}}}],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None], ",", "\<\"v6\"\>", ",", 
   RowBox[{"{", 
    RowBox[{"\<\"x1\"\>", ",", "\<\"x2\"\>", ",", "\<\"x3\"\>", 
     ",", "\<\"x4\"\>"}], "}"}], ",", "\[Infinity]", ",", "All"}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.7074717967621765`*^9, 
  3.7074718086663675`*^9}},ExpressionUUID->"8a5580c5-8acf-429c-b378-\
6cc426136924"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindPath", "[", 
    RowBox[{
    "$graph", ",", " ", "\"\<v6\>\"", ",", "#", ",", " ", "Infinity", ",", 
     " ", "All"}], "]"}], " ", "&"}], " ", "/@", " ", 
  RowBox[{"xVar", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}]], "Input",ExpressionUUID->\
"79692956-5ded-4355-ab7f-420a603a6891"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"v2\"\>", 
      ",", "\<\"x2\"\>"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"x3\"\>"}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"x4\"\>"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"v2\"\>", 
       ",", "\<\"x4\"\>"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7074731394254293`*^9},ExpressionUUID->"1465ceb7-685a-46dd-870c-\
f30c3580ae1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FindPath", "[", 
      RowBox[{
      "$graph", ",", " ", "\"\<v6\>\"", ",", "#", ",", " ", "Infinity", ",", 
       " ", "All"}], "]"}], " ", "&"}], " ", "/@", " ", 
    RowBox[{"xVar", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ",", " ", 
   RowBox[{"{", "}"}]}], "]"}]], "Input",ExpressionUUID->"64c027c1-408e-45bd-\
962b-22449cbe9bdc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"v2\"\>", 
      ",", "\<\"x2\"\>"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"x3\"\>"}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"x4\"\>"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\<\"v6\"\>", ",", "\<\"v5\"\>", ",", "\<\"v2\"\>", 
       ",", "\<\"x4\"\>"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.707472946867176*^9},ExpressionUUID->"acab6674-8265-4d4d-bacf-\
7e2236aa8476"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcSensitivityOnePath", "[", 
  RowBox[{"$tape", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<v6\>\"", ",", "\"\<v5\>\"", ",", "\"\<x4\>\""}], "}"}]}], 
  " ", "]"}]], "Input",
 CellChangeTimes->{{3.7074745969191694`*^9, 3.707474614293906*^9}, 
   3.7074747055950356`*^9},ExpressionUUID->"c878964b-c58b-4499-bf9a-\
3551b58b69ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"tfun", "[", 
     RowBox[{"yfun", "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
     "]"}], "\[Prime]",
    MultilineFunction->None], "[", 
   RowBox[{"yfun", "[", 
    RowBox[{
     RowBox[{"wfun", "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], "]"}], 
  " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"yfun", "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{
    RowBox[{"wfun", "[", 
     RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{3.707474614901967*^9, 
  3.707474706269103*^9},ExpressionUUID->"bbf8d3ee-c069-4fc0-9886-\
019efcd5b3ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcSensitivityOnePath", "[", 
  RowBox[{"$tape", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<v6\>\"", ",", "\"\<v5\>\"", ",", "\"\<v2\>\"", ",", "\"\<x4\>\""}], 
    "}"}]}], " ", "]"}]], "Input",
 CellChangeTimes->{
  3.7074747144749236`*^9},ExpressionUUID->"47468feb-162c-4d4b-83f2-\
ee91c97d05ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"tfun", "[", 
     RowBox[{"yfun", "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
     "]"}], "\[Prime]",
    MultilineFunction->None], "[", 
   RowBox[{"yfun", "[", 
    RowBox[{
     RowBox[{"wfun", "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], "]"}], 
  " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"wfun", "[", 
     RowBox[{"x2", ",", "x4"}], "]"}], 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x2", ",", "x4"}], "]"}], " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"yfun", "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{
    RowBox[{"wfun", "[", 
     RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{
  3.707474715049981*^9},ExpressionUUID->"c0c6c3cb-e61d-445c-b68e-\
991a9ab89fda"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcSensitivityOneVariable", "[", 
  RowBox[{"$tape", ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<v6\>\"", ",", "\"\<v5\>\"", ",", "\"\<x4\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<v6\>\"", ",", "\"\<v5\>\"", ",", "\"\<v2\>\"", ",", "\"\<x4\>\""}],
       "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.707474727402216*^9, 3.7074747280162773`*^9}, {
   3.7074752736018305`*^9, 3.7074752976122313`*^9}, {3.7074753679892683`*^9, 
   3.7074753772611957`*^9}, 
   3.7074754625777264`*^9},ExpressionUUID->"432fc40b-62b0-41c8-922e-\
dbd2fa2ac04b"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"\<\"x4\"\>", "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"tfun", "[", 
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], 
    "+", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"tfun", "[", 
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}]}],
   "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.707475298235294*^9, 3.707475377516221*^9}, {
  3.707475463573826*^9, 
  3.7074754855850267`*^9}},ExpressionUUID->"100ba892-bfb1-4316-a4e5-\
d40218953704"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcSensitivityOneVariable", "[", 
  RowBox[{"$tape", ",", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<v6\>\"", ",", "\"\<v5\>\"", ",", "\"\<x3\>\""}], "}"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7074755343699045`*^9},ExpressionUUID->"b0267aad-3411-4ea0-8041-\
7f3c2625c333"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"\<\"x3\"\>", "\[Rule]", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"tfun", "[", 
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       "]"}], "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{"yfun", "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
     "]"}], " ", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"wfun", "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.7074755353840065`*^9},ExpressionUUID->"2d447cf0-5455-4556-a73f-\
2c3b8f0b2e16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", 
  RowBox[{
   RowBox[{"calcSensitivityOneVariable", "[", 
    RowBox[{"$tape", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<v6\>\"", ",", "\"\<v5\>\"", ",", "\"\<x4\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<v6\>\"", ",", "\"\<v5\>\"", ",", "\"\<v2\>\"", ",", 
         "\"\<x4\>\""}], "}"}]}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"calcSensitivityOneVariable", "[", 
    RowBox[{"$tape", ",", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\"\<v6\>\"", ",", "\"\<v5\>\"", ",", "\"\<x3\>\""}], "}"}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7074755373372016`*^9, 
  3.7074755484623137`*^9}},ExpressionUUID->"9d55bcd5-e002-4b10-a182-\
5db652e4e216"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"x4\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"tfun", "[", 
         RowBox[{"yfun", "[", 
          RowBox[{
           RowBox[{"wfun", "[", 
            RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
         "]"}], "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       "]"}], " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], 
     "+", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"tfun", "[", 
         RowBox[{"yfun", "[", 
          RowBox[{
           RowBox[{"wfun", "[", 
            RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
         "]"}], "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       "]"}], " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], 
       "]"}]}]}]}], ",", 
   RowBox[{"\<\"x3\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"tfun", "[", 
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}]}],
   "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.7074755493013983`*^9},ExpressionUUID->"b9e1db00-7b51-47af-940a-\
127958dd587f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcSensitivity", "[", 
  RowBox[{
  "$graph", ",", " ", "$tape", ",", " ", "xVar", ",", " ", "\"\<v6\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.707475662822749*^9, 
  3.7074756845149183`*^9}},ExpressionUUID->"a9cfacf7-dc7e-41c3-bb33-\
421634bf5ddd"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"x2\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"tfun", "[", 
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x2", ",", "x4"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}], 
   ",", 
   RowBox[{"\<\"x3\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"tfun", "[", 
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"yfun", "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
      "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"wfun", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}]}], 
   ",", 
   RowBox[{"\<\"x4\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"tfun", "[", 
         RowBox[{"yfun", "[", 
          RowBox[{
           RowBox[{"wfun", "[", 
            RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
         "]"}], "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       "]"}], " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}]}], 
     "+", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"tfun", "[", 
         RowBox[{"yfun", "[", 
          RowBox[{
           RowBox[{"wfun", "[", 
            RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
         "]"}], "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"yfun", "[", 
        RowBox[{
         RowBox[{"wfun", "[", 
          RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
       "]"}], " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x2", ",", "x4"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"yfun", "[", 
         RowBox[{
          RowBox[{"wfun", "[", 
           RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], "]"}], 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"wfun", "[", 
         RowBox[{"x2", ",", "x4"}], "]"}], ",", "x3", ",", "x4"}], 
       "]"}]}]}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.707475686126079*^9, 3.7074775797104187`*^9, 
  3.7074776936258087`*^9},ExpressionUUID->"40a919f5-a592-426e-a851-\
d539a6f6d4c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcSensitivity", "[", 
  RowBox[{
  "$graph", ",", " ", "$tape", ",", " ", "xVar", ",", " ", "\"\<v4\>\""}], 
  "]"}]], "Input",ExpressionUUID->"ffdee4e4-d106-4645-ad66-6d3c9ff1e77d"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"x1\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"vfun", "[", 
        RowBox[{"ufun", "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"ufun", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"zfun", "[", 
        RowBox[{"vfun", "[", 
         RowBox[{"ufun", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"vfun", "[", 
       RowBox[{"ufun", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["ufun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x1", ",", "x2"}], "]"}]}]}], ",", 
   RowBox[{"\<\"x2\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"vfun", "[", 
        RowBox[{"ufun", "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"ufun", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"zfun", "[", 
        RowBox[{"vfun", "[", 
         RowBox[{"ufun", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"vfun", "[", 
       RowBox[{"ufun", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["ufun", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x1", ",", "x2"}], "]"}]}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.707537985914302*^9},ExpressionUUID->"a94326dc-757f-488a-8d12-\
43d5b37acc58"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141, 802},
WindowMargins->{{Automatic, -1}, {-2, Automatic}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 179, 4, 30, "Input", "ExpressionUUID" -> \
"af125f81-00a5-414f-b1c0-e0c2f0ea92f3"],
Cell[762, 28, 176, 3, 30, "Output", "ExpressionUUID" -> \
"81ddd90d-64c0-42d1-a488-9b73b08453af"]
}, Open  ]],
Cell[953, 34, 215, 6, 30, "Input", "ExpressionUUID" -> \
"a7750eef-8503-4b2c-8357-e77b1165c924"],
Cell[CellGroupData[{
Cell[1193, 44, 190, 4, 30, "Input", "ExpressionUUID" -> \
"138961d3-66d0-4abb-92ae-c691cbb595cb"],
Cell[1386, 50, 161, 3, 30, "Output", "ExpressionUUID" -> \
"2b48a1c0-cb5c-48bd-9308-88eb164bcbb9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1584, 58, 191, 4, 30, "Input", "ExpressionUUID" -> \
"e5cefd96-403d-4984-9e8b-1f559c20edce"],
Cell[1778, 64, 217, 6, 30, "Output", "ExpressionUUID" -> \
"dcd8e713-6125-48dc-96ae-65fdd72804cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2032, 75, 194, 4, 30, "Input", "ExpressionUUID" -> \
"4fd844a3-4eb0-49b2-9724-e2c01b83c1c4"],
Cell[2229, 81, 274, 7, 30, "Output", "ExpressionUUID" -> \
"197e269d-1a49-4015-b77d-484f52140031"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2540, 93, 351, 10, 30, "Input", "ExpressionUUID" -> \
"5bc7beff-5c13-4c2e-aff1-f004082ffd5e"],
Cell[2894, 105, 603, 21, 33, "Output", "ExpressionUUID" -> \
"d619b46a-0f70-4937-b14b-84a896c60848"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3534, 131, 424, 10, 30, "Input", "ExpressionUUID" -> \
"2151bd4d-5b3d-428e-ae79-ac9518050942"],
Cell[3961, 143, 282, 6, 30, "Output", "ExpressionUUID" -> \
"33f3ae99-6b8b-46f7-a3cd-87e070c7e60c"]
}, Open  ]],
Cell[4258, 152, 2447, 65, 88, "Input", "ExpressionUUID" -> \
"e548857c-42e9-496e-91b1-50a6dc9e6ce1"],
Cell[CellGroupData[{
Cell[6730, 221, 489, 15, 30, "Input", "ExpressionUUID" -> \
"ebd505ae-a12d-409e-8531-fc57c481094a"],
Cell[7222, 238, 944, 26, 33, "Output", "ExpressionUUID" -> \
"1119d954-b713-4ef3-8fe5-250ad62fc01f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8203, 269, 574, 18, 33, "Input", "ExpressionUUID" -> \
"79a323b6-c1ef-4593-aa73-162b86628b9d"],
Cell[8780, 289, 1457, 48, 41, "Output", "ExpressionUUID" -> \
"41110694-106e-4971-9ceb-7ac4b2ff4421"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10274, 342, 158, 3, 70, "Section", "ExpressionUUID" -> \
"9b8a7967-c7f6-4038-94bb-be403ec29404"],
Cell[CellGroupData[{
Cell[10457, 349, 598, 16, 30, "Input", "ExpressionUUID" -> \
"d92823fa-84e5-493d-8b63-fe3d1ef69411"],
Cell[11058, 367, 927, 24, 30, "Output", "ExpressionUUID" -> \
"3ff0814d-2447-4fb7-84b4-a64091993ab7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12022, 396, 309, 8, 30, "Input", "ExpressionUUID" -> \
"df6c2b72-59c4-4546-b761-f4e1c347321e"],
Cell[12334, 406, 821, 22, 30, "Output", "ExpressionUUID" -> \
"315d4ab7-035a-4ba1-a2b8-3a62cf4fc1e0"]
}, Open  ]],
Cell[13170, 431, 953, 26, 30, "Input", "ExpressionUUID" -> \
"17b1cbc6-d466-4cc2-8b92-8faf9ada2565"],
Cell[14126, 459, 706, 21, 69, "Input", "ExpressionUUID" -> \
"378ad545-7f9e-4518-a3e4-e9cfda4eb608"],
Cell[CellGroupData[{
Cell[14857, 484, 1432, 37, 107, "Input", "ExpressionUUID" -> \
"93445ec1-06e0-4cf5-b93e-755cdfe947d0"],
Cell[16292, 523, 2230, 67, 55, "Output", "ExpressionUUID" -> \
"eeac4825-524f-4df9-917c-7117d32d919d"]
}, Open  ]],
Cell[18537, 593, 616, 18, 33, "Input", "ExpressionUUID" -> \
"d5b690fb-3125-4a96-bd2f-51b2b868f2d5"],
Cell[19156, 613, 757, 22, 69, "Input", "ExpressionUUID" -> \
"ebb777e0-b0c9-476e-99fc-440a101a982e"],
Cell[CellGroupData[{
Cell[19938, 639, 1178, 33, 107, "Input", "ExpressionUUID" -> \
"766395b3-184c-4317-ae86-d0022ed648f1"],
Cell[21119, 674, 775, 23, 33, "Output", "ExpressionUUID" -> \
"e7813410-3e5b-4891-8f21-1104959e7296"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21931, 702, 157, 3, 30, "Input", "ExpressionUUID" -> \
"f35882fa-cae9-4651-a9bc-5857ad7ffd20"],
Cell[22091, 707, 2718, 81, 77, "Output", "ExpressionUUID" -> \
"2bd73da4-8495-44c3-be59-c6c4c84d6b56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24846, 793, 600, 13, 30, "Input", "ExpressionUUID" -> \
"c16fafae-9dd4-4471-b20b-bc5c5ebaaaea"],
Cell[25449, 808, 2547, 75, 55, "Output", "ExpressionUUID" -> \
"f7043f87-f4c8-4e72-b6ec-1a0fe62a2fd9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28033, 888, 427, 12, 30, "Input", "ExpressionUUID" -> \
"ffdcc3d3-4ffc-4e12-9d9f-7f4ca95e8e23"],
Cell[28463, 902, 2321, 73, 55, "Output", "ExpressionUUID" -> \
"618e6098-f8c5-494a-bccd-b6231888cdfd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30821, 980, 386, 11, 30, "Input", "ExpressionUUID" -> \
"1f81f429-d4a1-4da4-bdd4-620c4e6a8252"],
Cell[31210, 993, 2231, 71, 55, "Output", "ExpressionUUID" -> \
"abb1e112-d8dd-4ce3-b2a8-0c610cd75885"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33478, 1069, 643, 16, 32, "Input", "ExpressionUUID" -> \
"7883d591-650f-41ce-9649-94cc2950bd24"],
Cell[34124, 1087, 2337, 72, 55, "Output", "ExpressionUUID" -> \
"00fdfe37-37ff-4609-9219-a2d355858667"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36510, 1165, 218, 4, 70, "Section", "ExpressionUUID" -> \
"23156846-d628-4b42-9fe6-d2a78264368d"],
Cell[CellGroupData[{
Cell[36753, 1173, 159, 3, 49, "Subsection", "ExpressionUUID" -> \
"ef27e298-9433-497a-9bd1-9a8a06807507"],
Cell[CellGroupData[{
Cell[36937, 1180, 242, 6, 30, "Input", "ExpressionUUID" -> \
"5a80e4ce-6728-4592-9145-a82dc9dba915"],
Cell[37182, 1188, 520, 9, 30, "Output", "ExpressionUUID" -> \
"2a210824-4da8-4a24-9cb9-9da7e2937acb"]
}, Open  ]],
Cell[37717, 1200, 192, 4, 30, "Input", "ExpressionUUID" -> \
"abcad40c-c7e3-490c-85a6-64d8c50df1be"],
Cell[37912, 1206, 3624, 93, 429, "Input", "ExpressionUUID" -> \
"85cc1f89-80a8-4c17-bba1-dc87296b2dce"],
Cell[CellGroupData[{
Cell[41561, 1303, 629, 15, 69, "Input", "ExpressionUUID" -> \
"7d0c6854-38e4-4b78-a74b-11a560cf0f31"],
Cell[42193, 1320, 341, 6, 30, "Output", "ExpressionUUID" -> \
"4e2d3bba-48f9-45d7-afbc-83694c4cd558"],
Cell[42537, 1328, 769, 19, 30, "Output", "ExpressionUUID" -> \
"4dad8168-56f4-41ea-b158-19556bf3e03d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43343, 1352, 518, 15, 50, "Input", "ExpressionUUID" -> \
"475db973-ed71-4adb-a116-6ba84d711154"],
Cell[43864, 1369, 576, 11, 23, "Message", "ExpressionUUID" -> \
"b73f6b25-bb61-4581-bc12-d8d3f48d29d6"],
Cell[44443, 1382, 576, 11, 23, "Message", "ExpressionUUID" -> \
"9039320d-c6c9-480c-9617-b3f0f602666d"],
Cell[45022, 1395, 2913, 86, 50, "Output", "ExpressionUUID" -> \
"0781c535-b548-4994-8995-cc001a0fe14c"],
Cell[47938, 1483, 15299, 469, 253, "Output", "ExpressionUUID" -> \
"705f750d-de51-4b68-bc86-0b02f630ebd1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63274, 1957, 523, 10, 50, "Input", "ExpressionUUID" -> \
"a3ca2881-89bc-491e-9165-0f3e298f2bcb"],
Cell[63800, 1969, 823, 21, 30, "Output", "ExpressionUUID" -> \
"8aa03840-5073-4f19-b8d6-5052dc66b92d"],
Cell[64626, 1992, 588, 16, 30, "Output", "ExpressionUUID" -> \
"94ce9dae-0102-47af-a137-2e9fb24f9e55"],
Cell[65217, 2010, 1503, 41, 50, "Output", "ExpressionUUID" -> \
"0e1a1317-e6ec-44c2-a9f9-51d356b07811"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66757, 2056, 456, 9, 50, "Input", "ExpressionUUID" -> \
"c69f51f6-c537-4675-bb0b-ce3409284d6f"],
Cell[67216, 2067, 479, 13, 30, "Output", "ExpressionUUID" -> \
"76d1ec8c-6235-4c74-9f29-f1804470971f"],
Cell[67698, 2082, 1561, 43, 50, "Output", "ExpressionUUID" -> \
"d76e9ac7-0983-45e6-87b4-39eb9616880d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69296, 2130, 161, 3, 30, "Input", "ExpressionUUID" -> \
"4d9040dc-4c8b-4023-82af-47d720b6cf8f"],
Cell[69460, 2135, 1561, 43, 50, "Output", "ExpressionUUID" -> \
"95f67091-2c8c-4cef-8d20-4fef5d3c5d94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71058, 2183, 530, 14, 33, "Input", "ExpressionUUID" -> \
"74684c62-9f7d-4e29-bdc2-00ec44fe1beb"],
Cell[71591, 2199, 494, 14, 30, "Output", "ExpressionUUID" -> \
"1e5065b4-537c-4af5-b2c4-a8e4656fefa4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72122, 2218, 862, 23, 33, "Input", "ExpressionUUID" -> \
"fefcbc11-27a0-454a-a129-ff93748fcd4a"],
Cell[72987, 2243, 856, 26, 33, "Output", "ExpressionUUID" -> \
"7eb2c5b3-7829-44d1-97f9-50af9b18a836"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73880, 2274, 607, 16, 33, "Input", "ExpressionUUID" -> \
"5bcb1b91-3ffc-495b-bf5d-bc40d43fdf59"],
Cell[74490, 2292, 541, 17, 30, "Output", "ExpressionUUID" -> \
"d761dadc-d827-416a-a791-d6fcbd606bb9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[75080, 2315, 157, 3, 41, "Subsection", "ExpressionUUID" -> \
"4ea9fdd9-39b5-46ac-a678-bdc9d4efdd27"],
Cell[CellGroupData[{
Cell[75262, 2322, 171, 4, 30, "Input", "ExpressionUUID" -> \
"ba5c8553-f87e-491b-9411-08f5fbb0e4fa"],
Cell[75436, 2328, 422, 8, 30, "Output", "ExpressionUUID" -> \
"7762711c-2b0f-49a4-970e-e7ddc0217ace"]
}, Open  ]],
Cell[75873, 2339, 192, 4, 30, "Input", "ExpressionUUID" -> \
"1bac289f-f63a-4741-9c90-82d01a30593a"],
Cell[76068, 2345, 4941, 126, 562, "Input", "ExpressionUUID" -> \
"58cba7c3-95f1-407b-a27d-4e9c19c877ab"],
Cell[CellGroupData[{
Cell[81034, 2475, 739, 21, 50, "Input", "ExpressionUUID" -> \
"b61af34f-0f4c-4636-ae51-c5cc60a8371c"],
Cell[81776, 2498, 876, 21, 30, "Output", "ExpressionUUID" -> \
"badf6a00-620b-4d90-9d89-d339a4c79e74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82689, 2524, 610, 18, 30, "Input", "ExpressionUUID" -> \
"f686e6d1-e0bc-4177-8a2c-06c98ff10a04"],
Cell[83302, 2544, 404, 13, 30, "Output", "ExpressionUUID" -> \
"53a50ec7-7d6f-45de-86d1-6c3c35f445de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83743, 2562, 1465, 40, 50, "Input", "ExpressionUUID" -> \
"4b1551e7-d3de-47ad-a135-2c3d8334d1ba"],
Cell[85211, 2604, 518, 18, 30, "Output", "ExpressionUUID" -> \
"f0db1275-b43b-48e7-b287-72d4bde23d51"],
Cell[85732, 2624, 770, 22, 30, "Output", "ExpressionUUID" -> \
"0d82dbba-4ea3-4ce1-b50e-bcb3399507d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86539, 2651, 597, 17, 50, "Input", "ExpressionUUID" -> \
"c7d1877a-f0f1-40ce-b105-bd64e901c6fd"],
Cell[87139, 2670, 397, 9, 23, "Message", "ExpressionUUID" -> \
"839e11ec-8950-4a63-b9a6-c656492e6ed0"],
Cell[87539, 2681, 395, 9, 23, "Message", "ExpressionUUID" -> \
"4257c18c-72e9-469d-ac5a-58486783c9d6"],
Cell[87937, 2692, 397, 9, 23, "Message", "ExpressionUUID" -> \
"cc425ef8-48c7-47cc-b254-b1d71e445f99"],
Cell[88337, 2703, 423, 9, 21, "Message", "ExpressionUUID" -> \
"207aa6b2-bbcf-40d9-83f4-1aa2fcf0153d"],
Cell[88763, 2714, 439, 14, 30, "Output", "ExpressionUUID" -> \
"21d4dd7f-6df7-4ad8-b406-a8c003014682"],
Cell[89205, 2730, 2090, 66, 55, "Output", "ExpressionUUID" -> \
"f17269d9-c7e9-4015-809b-370ac8a3a944"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[91344, 2802, 184, 3, 41, "Subsection", "ExpressionUUID" -> \
"d9042486-6c51-447b-bef0-3be65e8bcc59"],
Cell[CellGroupData[{
Cell[91553, 2809, 242, 6, 30, "Input", "ExpressionUUID" -> \
"200fa2d0-7879-46aa-be47-612bae0a4bbe"],
Cell[91798, 2817, 974, 16, 30, "Output", "ExpressionUUID" -> \
"20e81c0e-e563-4b4e-ada7-8b86f56bfcd1"]
}, Open  ]],
Cell[92787, 2836, 192, 4, 30, "Input", "ExpressionUUID" -> \
"c9580eb5-bda8-4e88-9d00-e2f3414786bf"],
Cell[92982, 2842, 4201, 99, 429, "Input", "ExpressionUUID" -> \
"64db34dc-e58d-4426-927b-d9e3e624027d"],
Cell[CellGroupData[{
Cell[97208, 2945, 611, 14, 69, "Input", "ExpressionUUID" -> \
"3b2d045b-b15f-4d7d-82d7-491822f4c007"],
Cell[97822, 2961, 770, 12, 30, "Output", "ExpressionUUID" -> \
"11b6e282-12c2-41fe-a37c-526d58b55dff"],
Cell[98595, 2975, 869, 17, 30, "Output", "ExpressionUUID" -> \
"3a51d946-6657-47b2-9fe5-69bb8b18f910"],
Cell[99467, 2994, 770, 12, 30, "Output", "ExpressionUUID" -> \
"f9dd882f-b456-4cd8-9664-bacf9f3b0e1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100274, 3011, 937, 22, 50, "Input", "ExpressionUUID" -> \
"3e251485-eb95-4d09-9e33-2703c272c856"],
Cell[101214, 3035, 567, 12, 30, "Output", "ExpressionUUID" -> \
"b5f75476-d2c3-441c-8491-64b40312b9a5"],
Cell[101784, 3049, 1085, 26, 30, "Output", "ExpressionUUID" -> \
"cf7a5230-ffaf-4d44-809c-502d342da904"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102906, 3080, 406, 11, 33, "Input", "ExpressionUUID" -> \
"67464ba0-af25-40e6-b893-456c24305147"],
Cell[103315, 3093, 1019, 17, 21, "Message", "ExpressionUUID" -> \
"9924a928-79a6-4bc6-9c0c-d638779f4170"],
Cell[104337, 3112, 611, 17, 30, "Output", "ExpressionUUID" -> \
"7501ba0f-cc9d-470a-b638-f5f9b7b9f74f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104985, 3134, 432, 8, 50, "Input", "ExpressionUUID" -> \
"617ccf1d-87c8-40f7-8557-c29919cf22ec"],
Cell[105420, 3144, 455, 13, 30, "Output", "ExpressionUUID" -> \
"c9d6d705-c946-425d-bf85-c5f13c82c5ca"],
Cell[105878, 3159, 1068, 30, 30, "Output", "ExpressionUUID" -> \
"82e00b93-16e5-4c00-8ccd-33c45143121e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106983, 3194, 523, 10, 50, "Input", "ExpressionUUID" -> \
"ddf8f6be-a134-4a86-8cd0-e857695bef73"],
Cell[107509, 3206, 823, 21, 30, "Output", "ExpressionUUID" -> \
"c430e1cb-4c71-417a-9362-20f4d7c4a870"],
Cell[108335, 3229, 588, 16, 30, "Output", "ExpressionUUID" -> \
"9df46a8c-53af-4f0b-ab05-dc2b9892f5a2"],
Cell[108926, 3247, 1503, 41, 50, "Output", "ExpressionUUID" -> \
"ad93dab3-ea94-47d4-b9f6-545e28ec85aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110466, 3293, 456, 9, 50, "Input", "ExpressionUUID" -> \
"695a7bb2-fd9e-4365-be41-aca85a331873"],
Cell[110925, 3304, 479, 13, 30, "Output", "ExpressionUUID" -> \
"063e8d3d-b157-4644-bc5e-0e3cc1aacf88"],
Cell[111407, 3319, 1561, 43, 50, "Output", "ExpressionUUID" -> \
"a05cb49d-0aea-4a56-88a7-d69b3a284665"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113005, 3367, 161, 3, 30, "Input", "ExpressionUUID" -> \
"99b0acf5-9bc2-4b6e-aceb-3871bfc1fa6c"],
Cell[113169, 3372, 1561, 43, 50, "Output", "ExpressionUUID" -> \
"9e4e4285-0c04-45ef-b47a-49e5a746f8d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114767, 3420, 530, 14, 33, "Input", "ExpressionUUID" -> \
"f2ee51cf-9703-4bbb-8f11-898684f71578"],
Cell[115300, 3436, 494, 14, 30, "Output", "ExpressionUUID" -> \
"ef47443c-1839-4b5c-840c-91d27ef245ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115831, 3455, 862, 23, 33, "Input", "ExpressionUUID" -> \
"53205259-e778-4898-95a3-fd8b6361d93d"],
Cell[116696, 3480, 856, 26, 33, "Output", "ExpressionUUID" -> \
"d5ef185b-e941-41b9-94d6-bd3c8fb48575"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117589, 3511, 607, 16, 33, "Input", "ExpressionUUID" -> \
"73d80534-eaa9-4423-a4ff-f451cd5ba810"],
Cell[118199, 3529, 541, 17, 30, "Output", "ExpressionUUID" -> \
"f2376a37-142a-48fc-b404-38d10d1377b1"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[118789, 3552, 212, 4, 41, "Subsection", "ExpressionUUID" -> \
"f23afeea-82a2-40c2-be58-aac34c733c56"],
Cell[119004, 3558, 795, 24, 49, "Text", "ExpressionUUID" -> \
"fad8b54a-bf7e-4b1c-85de-8deff27acbc6"],
Cell[CellGroupData[{
Cell[119824, 3586, 239, 6, 30, "Input", "ExpressionUUID" -> \
"7d987417-ce78-4add-8c5b-caa5d8657488"],
Cell[120066, 3594, 267, 4, 30, "Output", "ExpressionUUID" -> \
"afefd29f-513f-4f54-b243-77461d0561b3"]
}, Open  ]],
Cell[120348, 3601, 190, 4, 30, "Input", "ExpressionUUID" -> \
"b966ec06-4598-4753-9810-1ab3a9f99915"],
Cell[120541, 3607, 1293, 36, 170, "Input", "ExpressionUUID" -> \
"1c52e0cd-1976-46c6-b53b-b79745b481c4"],
Cell[CellGroupData[{
Cell[121859, 3647, 157, 3, 30, "Input", "ExpressionUUID" -> \
"f3091f0e-0898-4cef-9e3b-acac7000c7ef"],
Cell[122019, 3652, 381, 11, 30, "Output", "ExpressionUUID" -> \
"eea17833-b9ed-46e3-97af-a7f8a28c28f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122437, 3668, 426, 12, 50, "Input", "ExpressionUUID" -> \
"2ad30fe6-ad83-496c-9178-c956926ccf9a"],
Cell[122866, 3682, 435, 13, 30, "Output", "ExpressionUUID" -> \
"9766f787-aa13-434f-a1dc-6cdaad74f396"],
Cell[123304, 3697, 381, 11, 30, "Output", "ExpressionUUID" -> \
"7f29d6ad-c561-499b-9280-1f39d03ed248"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123722, 3713, 487, 13, 50, "Input", "ExpressionUUID" -> \
"a1242d02-8be9-488f-90c0-cbfab3097ebe"],
Cell[124212, 3728, 252, 7, 30, "Output", "ExpressionUUID" -> \
"1ecec915-cec4-4929-8ffd-6b3f52db869e"],
Cell[124467, 3737, 615, 19, 30, "Output", "ExpressionUUID" -> \
"989ba793-4570-432e-95e9-bc92b5e43299"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125143, 3763, 215, 4, 70, "Section", "ExpressionUUID" -> \
"03f23448-2be6-4003-ba5b-41d0a9d47151"],
Cell[125361, 3769, 972, 25, 88, "Input", "ExpressionUUID" -> \
"804f3adc-762d-4a0e-89d5-3dd92935c503"],
Cell[CellGroupData[{
Cell[126358, 3798, 976, 22, 69, "Input", "ExpressionUUID" -> \
"271b540a-082b-4cb7-9948-40ae0bcab8f6"],
Cell[127337, 3822, 914, 20, 30, "Output", "ExpressionUUID" -> \
"c824a5ab-67cf-474d-b7b4-0d2ad4ee3bfc"]
}, Open  ]],
Cell[128266, 3845, 1043, 25, 30, "Input", "ExpressionUUID" -> \
"4aa9af17-8b66-4ed8-b01d-6abe32b6c763"],
Cell[129312, 3872, 2026, 48, 50, "Input", "ExpressionUUID" -> \
"5c71dd62-27d4-46f5-ae75-be9e9bb3a283"],
Cell[CellGroupData[{
Cell[131363, 3924, 155, 3, 30, "Input", "ExpressionUUID" -> \
"0d1c6af0-6988-4c4b-92a5-fdcd35e59342"],
Cell[131521, 3929, 586, 15, 30, "Output", "ExpressionUUID" -> \
"e383c532-f441-4a7d-838a-714c8227fccd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132144, 3949, 3758, 72, 183, "Input", "ExpressionUUID" -> \
"d58484f0-e601-4b4f-9975-a97900f46bea"],
Cell[135905, 4023, 1080, 28, 46, "Output", "ExpressionUUID" -> \
"1ea3be32-7571-4b3f-8c6b-4c06ac754987"]
}, Open  ]],
Cell[137000, 4054, 962, 25, 88, "Input", "ExpressionUUID" -> \
"7be7d865-a628-4084-bad2-155e6c012049"],
Cell[CellGroupData[{
Cell[137987, 4083, 233, 5, 30, "Input", "ExpressionUUID" -> \
"26ced38d-8831-49bf-936f-9a297f04d8b8"],
Cell[138223, 4090, 598, 16, 30, "Output", "ExpressionUUID" -> \
"bf9c9165-8974-4b31-a370-c2fb22c5456f"]
}, Open  ]],
Cell[138836, 4109, 2175, 53, 221, "Input", "ExpressionUUID" -> \
"0db69831-a2bc-4e36-abc4-24a31b8e472e"],
Cell[CellGroupData[{
Cell[141036, 4166, 322, 7, 30, "Input", "ExpressionUUID" -> \
"303a7bd0-e952-4aec-8558-6fe43bb50d17"],
Cell[141361, 4175, 986, 26, 33, "Output", "ExpressionUUID" -> \
"205d9355-5f42-486f-be69-0c04610d673a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142384, 4206, 416, 9, 30, "Input", "ExpressionUUID" -> \
"7e932159-f10b-4592-9327-2cfd3099b14d"],
Cell[142803, 4217, 2068, 59, 77, "Output", "ExpressionUUID" -> \
"0ac0b0e3-f341-49ca-8596-39d85b5b962b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[144920, 4282, 264, 4, 56, "Section", "ExpressionUUID" -> \
"f741a6b7-d743-444c-bac4-a244ed25b76d"],
Cell[145187, 4288, 992, 23, 69, "Input", "ExpressionUUID" -> \
"7d35673d-10df-456b-9619-77d0cc444789"],
Cell[146182, 4313, 192, 4, 30, "Input", "ExpressionUUID" -> \
"9a689a97-c9d6-4509-bd21-ef5b03c13e6c"],
Cell[146377, 4319, 2181, 46, 195, "Input", "ExpressionUUID" -> \
"c67a0972-f393-4831-abf3-7ec124b4b2ca"],
Cell[CellGroupData[{
Cell[148583, 4369, 371, 8, 30, "Input", "ExpressionUUID" -> \
"4ec2fde6-c3f0-4e7f-99c4-3d1633a4563d"],
Cell[148957, 4379, 388, 7, 30, "Output", "ExpressionUUID" -> \
"d0ffc0f0-d977-4c3f-90de-fec9a5efdd9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149382, 4391, 455, 12, 30, "Input", "ExpressionUUID" -> \
"482737c2-59b7-4e57-9239-c9e11bfeca7f"],
Cell[149840, 4405, 567, 12, 30, "Output", "ExpressionUUID" -> \
"d9ee7792-f768-4c25-b428-06c0bfacdd42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150444, 4422, 457, 12, 30, "Input", "ExpressionUUID" -> \
"634c1be5-bd45-4c6d-942a-f3373b826780"],
Cell[150904, 4436, 477, 11, 30, "Output", "ExpressionUUID" -> \
"cfc7ebdd-414b-4e78-b2bf-3ec8e02cf4e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151418, 4452, 261, 6, 30, "Input", "ExpressionUUID" -> \
"552dcb9e-c264-4310-b098-a947afb2357f"],
Cell[151682, 4460, 528, 12, 30, "Output", "ExpressionUUID" -> \
"824d199a-89e8-472a-bb2a-14b814e8dd88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152247, 4477, 208, 5, 30, "Input", "ExpressionUUID" -> \
"4f798574-e129-48d2-8676-3cdae53caa60"],
Cell[152458, 4484, 521, 14, 30, "Output", "ExpressionUUID" -> \
"01863aff-7c34-4f65-88c5-69d1f8f9d5d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153016, 4503, 628, 18, 30, "Input", "ExpressionUUID" -> \
"be88206f-53d0-4371-b81a-efa479fa3174"],
Cell[153647, 4523, 548, 14, 30, "Output", "ExpressionUUID" -> \
"d03e93b8-d0f7-40bd-90f8-f03df7abc188"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154232, 4542, 208, 5, 30, "Input", "ExpressionUUID" -> \
"8900f1a6-6ea9-4b7f-a655-009d4aa67283"],
Cell[154443, 4549, 591, 15, 30, "Output", "ExpressionUUID" -> \
"ad16d442-5289-4430-ba8d-bbc31fe93959"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155071, 4569, 545, 10, 33, "Input", "ExpressionUUID" -> \
"6d0713b5-6647-4a4c-9439-b70b07d95428"],
Cell[155619, 4581, 610, 11, 30, "Output", "ExpressionUUID" -> \
"2e080c76-b230-400f-bb7e-d884126b7bf5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156266, 4597, 479, 11, 33, "Input", "ExpressionUUID" -> \
"764f9e47-2fcd-4b9f-b4e0-37f723916a9d"],
Cell[156748, 4610, 475, 14, 30, "Output", "ExpressionUUID" -> \
"e870450d-b1ec-4dee-bb77-1e57c1d10438"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157260, 4629, 685, 19, 33, "Input", "ExpressionUUID" -> \
"c37ee885-1495-435b-8253-09b81d3db91e"],
Cell[157948, 4650, 3665, 111, 81, "Output", "ExpressionUUID" -> \
"c2dba081-6fcf-4a5d-9704-c9ad09b4d3de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161650, 4766, 1940, 62, 55, "Input", "ExpressionUUID" -> \
"2d5ff372-ee2a-4ab8-8577-13f1cc7cd6fd"],
Cell[163593, 4830, 2430, 81, 73, "Output", "ExpressionUUID" -> \
"05e1f15c-ed63-4430-9a61-22b3692c4f2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166060, 4916, 445, 9, 33, "Input", "ExpressionUUID" -> \
"dc1bd8de-5b16-4fe3-bbd6-6047ee9943a5"],
Cell[166508, 4927, 422, 10, 30, "Output", "ExpressionUUID" -> \
"d267e68a-379b-4618-ac2d-c83cf53c243b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166967, 4942, 341, 8, 33, "Input", "ExpressionUUID" -> \
"41bffc4d-bf4e-4c7b-9527-4fb3aad41714"],
Cell[167311, 4952, 262, 7, 30, "Output", "ExpressionUUID" -> \
"c971416b-3230-4cc1-aeea-d92eedfb887c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167610, 4964, 674, 19, 33, "Input", "ExpressionUUID" -> \
"5e201175-7787-4321-bb6f-0d02e8d4a07a"],
Cell[168287, 4985, 2075, 62, 65, "Output", "ExpressionUUID" -> \
"1949d82e-c4e9-4d7a-b85b-e3db77e70990"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[170411, 5053, 327, 5, 56, "Section", "ExpressionUUID" -> \
"047d33c1-314f-474f-a7e6-50a70bb39d70"],
Cell[170741, 5060, 992, 23, 69, "Input", "ExpressionUUID" -> \
"180d2616-9aad-4471-9675-e6c3cee4f5a1"],
Cell[171736, 5085, 323, 6, 30, "Input", "ExpressionUUID" -> \
"0ae41313-5953-4edd-93ae-cbb071165d28"],
Cell[172062, 5093, 4567, 112, 435, "Input", "ExpressionUUID" -> \
"1ceb9171-0b5d-481f-adf8-80c3e5ce18da"],
Cell[CellGroupData[{
Cell[176654, 5209, 239, 6, 30, "Input", "ExpressionUUID" -> \
"e53092fa-9227-466e-90b9-2d8e281ee20b"],
Cell[176896, 5217, 269, 6, 30, "Output", "ExpressionUUID" -> \
"2e6cbea0-cb1a-4b67-bfe4-416841a6b225"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177202, 5228, 415, 12, 30, "Input", "ExpressionUUID" -> \
"7f1caeca-2164-4dbe-bae5-a0200c92f103"],
Cell[177620, 5242, 264, 7, 30, "Output", "ExpressionUUID" -> \
"06811dc8-2536-461d-b50f-58732ced4fe8"]
}, Open  ]],
Cell[177899, 5252, 7930, 178, 582, "Input", "ExpressionUUID" -> \
"17a29353-2a40-449e-8f7d-edbb23400ea7"],
Cell[185832, 5432, 708, 22, 88, "Input", "ExpressionUUID" -> \
"7de35c56-4df8-4cdc-a718-68c09bf378a9"],
Cell[186543, 5456, 318, 9, 30, "Input", "ExpressionUUID" -> \
"707314ee-a8fc-4925-8cde-07eb5e7a397a"],
Cell[CellGroupData[{
Cell[186886, 5469, 722, 17, 50, "Input", "ExpressionUUID" -> \
"4970be8b-9678-4fe8-bb1f-774aadb2ceac"],
Cell[187611, 5488, 869, 16, 30, "Output", "ExpressionUUID" -> \
"c03c82e3-b715-4bb2-befd-d34ce827eef1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188517, 5509, 625, 16, 50, "Input", "ExpressionUUID" -> \
"7a6a6938-a95b-4c4e-9056-c2aae8a1c4cf"],
Cell[189145, 5527, 721, 14, 30, "Output", "ExpressionUUID" -> \
"c645468e-38cf-47d5-bfde-6d709762735c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189903, 5546, 261, 6, 30, "Input", "ExpressionUUID" -> \
"ea0b6e9a-d348-4c68-8cd5-ae0533e74d4d"],
Cell[190167, 5554, 768, 15, 30, "Output", "ExpressionUUID" -> \
"73965f3b-7468-4904-ba39-1e1b5f08fc99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190972, 5574, 208, 5, 30, "Input", "ExpressionUUID" -> \
"9da6ffbc-9af0-4b1a-a035-728a021e75a2"],
Cell[191183, 5581, 756, 15, 30, "Output", "ExpressionUUID" -> \
"2c668d40-cb89-44ae-bccc-06a9f9c493c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191976, 5601, 664, 17, 50, "Input", "ExpressionUUID" -> \
"1b8604da-c4b1-475c-82ed-2fa77b85c331"],
Cell[192643, 5620, 721, 15, 30, "Output", "ExpressionUUID" -> \
"364b3c38-8edb-483b-a047-bbbc245bc3f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193401, 5640, 208, 5, 30, "Input", "ExpressionUUID" -> \
"83de9f6a-4a6f-4ea9-b136-e6a1c43386e4"],
Cell[193612, 5647, 769, 16, 30, "Output", "ExpressionUUID" -> \
"d8c356a5-ab33-4e25-812c-b2cd4b8f3508"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194418, 5668, 476, 10, 33, "Input", "ExpressionUUID" -> \
"6ef1e68a-8b6c-47ab-af1e-77888bd56d3c"],
Cell[194897, 5680, 412, 9, 30, "Output", "ExpressionUUID" -> \
"3dbde846-2572-417c-9fad-9257bbb9f01d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195346, 5694, 343, 8, 33, "Input", "ExpressionUUID" -> \
"a9135a69-efd3-47ce-8abc-9cb57617a7a3"],
Cell[195692, 5704, 374, 10, 30, "Output", "ExpressionUUID" -> \
"3740479b-2b03-44a3-8b19-9db04e17bcac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196103, 5719, 478, 12, 33, "Input", "ExpressionUUID" -> \
"08d0b3fc-808a-4d61-b1d2-28edb4d80bdd"],
Cell[196584, 5733, 468, 13, 30, "Output", "ExpressionUUID" -> \
"f35468f3-2236-4175-b7d0-729755cf53b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197089, 5751, 256, 7, 30, "Input", "ExpressionUUID" -> \
"5ec7bd4c-9e81-4f0d-a820-ce1bd5285e2f"],
Cell[197348, 5760, 482, 13, 30, "Output", "ExpressionUUID" -> \
"0d398567-a0f2-41ee-ac6b-aa3fdaef1384"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197867, 5778, 483, 12, 33, "Input", "ExpressionUUID" -> \
"6d71f596-911f-41ed-9516-775e8efa86c2"],
Cell[198353, 5792, 665, 20, 30, "Output", "ExpressionUUID" -> \
"9003f8c2-9f71-4561-9b91-4ffa4d688993"]
}, Open  ]],
Cell[199033, 5815, 593, 17, 30, "Input", "ExpressionUUID" -> \
"364c4c57-3f96-4f1e-830e-669fe45a8209"],
Cell[CellGroupData[{
Cell[199651, 5836, 879, 23, 33, "Input", "ExpressionUUID" -> \
"ed378fe7-a7e2-4d6d-a55b-9e75125c794b"],
Cell[200533, 5861, 1999, 63, 52, "Output", "ExpressionUUID" -> \
"78c94d79-b447-431f-a6bb-7995b0e22369"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202569, 5929, 714, 21, 33, "Input", "ExpressionUUID" -> \
"9fd2cb0a-a066-4fd0-8e9d-f1698fd15b24"],
Cell[203286, 5952, 1231, 43, 30, "Output", "ExpressionUUID" -> \
"f9dea3c7-c41f-4abd-9f52-2e1447926f48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204554, 6000, 735, 21, 33, "Input", "ExpressionUUID" -> \
"8dcfee6b-3cd1-48bd-b3ba-acdc3e7590e0"],
Cell[205292, 6023, 995, 32, 30, "Output", "ExpressionUUID" -> \
"339d9842-a4fa-41b9-bf9e-2dc26a8c1c49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206324, 6060, 712, 21, 33, "Input", "ExpressionUUID" -> \
"cff74416-1c5c-43c1-8765-8699b9326535"],
Cell[207039, 6083, 974, 32, 30, "Output", "ExpressionUUID" -> \
"07c4db52-b35e-4a70-b44b-052a2645fce6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208050, 6120, 214, 4, 30, "Input", "ExpressionUUID" -> \
"58ad2f59-d738-4733-b6f9-755fc382ffe2"],
Cell[208267, 6126, 5140, 150, 95, "Output", "ExpressionUUID" -> \
"45e6cf7b-02ce-442b-b07b-b6fd693b91e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213444, 6281, 761, 17, 33, "Input", "ExpressionUUID" -> \
"5d2d709e-e7f1-4f64-be1b-f6cee3102e47"],
Cell[214208, 6300, 294, 7, 30, "Output", "ExpressionUUID" -> \
"54c0b6ea-2f36-42fd-b143-8649bdf090af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214539, 6312, 528, 14, 33, "Input", "ExpressionUUID" -> \
"5136fc6b-d348-4359-902f-0ab7a42f128e"],
Cell[215070, 6328, 386, 11, 30, "Output", "ExpressionUUID" -> \
"fa3030a1-fea7-414e-8319-7c1504d2a67d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215493, 6344, 556, 14, 33, "Input", "ExpressionUUID" -> \
"30953308-3f71-4aea-9e84-b9ed3ab88f66"],
Cell[216052, 6360, 149, 4, 30, "Output", "ExpressionUUID" -> \
"af006c04-d7de-411d-8096-04529ada3bee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216238, 6369, 193, 4, 30, "Input", "ExpressionUUID" -> \
"0a5097d7-19a3-49a3-80ae-924098a0c944"],
Cell[216434, 6375, 1648, 51, 55, "Output", "ExpressionUUID" -> \
"fa8559ff-3132-4b92-a798-e4524f659562"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218119, 6431, 2307, 51, 151, "Input", "ExpressionUUID" -> \
"781c48f4-f5d6-4b44-bed8-116a2e07bb22"],
Cell[220429, 6484, 2035, 59, 55, "Output", "ExpressionUUID" -> \
"581287a3-b079-4751-93e1-df3d52b9df02"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222501, 6548, 195, 4, 30, "Input", "ExpressionUUID" -> \
"331db509-bf98-4aa2-8ee0-b22308b58204"],
Cell[222699, 6554, 829, 26, 33, "Output", "ExpressionUUID" -> \
"834fc2f5-928c-4858-b833-134fd5110581"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223565, 6585, 483, 12, 33, "Input", "ExpressionUUID" -> \
"be3b6ed1-d7ee-4e73-97d1-e7163423b532"],
Cell[224051, 6599, 386, 11, 30, "Output", "ExpressionUUID" -> \
"a333f77e-3ea5-48c4-8cc0-0c5b5aa45c6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224474, 6615, 321, 8, 30, "Input", "ExpressionUUID" -> \
"4618f414-26c6-4fcd-a104-3cbf4bd2b81f"],
Cell[224798, 6625, 326, 8, 21, "Message", "ExpressionUUID" -> \
"74e3eeb6-05b9-486a-bfe5-d02dfc753260"],
Cell[225127, 6635, 1859, 56, 55, "Output", "ExpressionUUID" -> \
"201ee606-887e-428d-a5e7-30f7b017ef67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227023, 6696, 270, 5, 30, "Input", "ExpressionUUID" -> \
"ae813fe0-5b3f-46b6-9c57-00538332a098"],
Cell[227296, 6703, 1725, 52, 55, "Output", "ExpressionUUID" -> \
"b05da7d9-6558-4c17-ab8f-357ab193b032"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229058, 6760, 195, 4, 30, "Input", "ExpressionUUID" -> \
"301c7bba-f287-4f58-8a4e-031ba3a99c83"],
Cell[229256, 6766, 1650, 51, 55, "Output", "ExpressionUUID" -> \
"07b4cca3-9a8a-485e-b5fe-8b71f87ab96d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230943, 6822, 347, 6, 33, "Input", "ExpressionUUID" -> \
"b5f80d1b-202a-4e6f-b4f3-66d5c31dec4c"],
Cell[231293, 6830, 457, 9, 30, "Output", "ExpressionUUID" -> \
"00195e08-1456-4aef-8a8b-1fb888bf71a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231787, 6844, 430, 10, 33, "Input", "ExpressionUUID" -> \
"f5bae13f-7497-47c8-bc2f-171c3fc36260"],
Cell[232220, 6856, 671, 13, 24, "Message", "ExpressionUUID" -> \
"497f9b10-f661-4059-9181-5c0abc6d1333"],
Cell[232894, 6871, 4573, 86, 109, "Output", "ExpressionUUID" -> \
"8a5580c5-8acf-429c-b378-6cc426136924"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237504, 6962, 367, 10, 33, "Input", "ExpressionUUID" -> \
"79692956-5ded-4355-ab7f-420a603a6891"],
Cell[237874, 6974, 733, 22, 30, "Output", "ExpressionUUID" -> \
"1465ceb7-685a-46dd-870c-f30c3580ae1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238644, 7001, 469, 13, 33, "Input", "ExpressionUUID" -> \
"64c027c1-408e-45bd-962b-22449cbe9bdc"],
Cell[239116, 7016, 702, 21, 30, "Output", "ExpressionUUID" -> \
"acab6674-8265-4d4d-bacf-7e2236aa8476"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239855, 7042, 349, 8, 33, "Input", "ExpressionUUID" -> \
"c878964b-c58b-4499-bf9a-3551b58b69ac"],
Cell[240207, 7052, 989, 33, 30, "Output", "ExpressionUUID" -> \
"bbf8d3ee-c069-4fc0-9886-019efcd5b3ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241233, 7090, 326, 9, 33, "Input", "ExpressionUUID" -> \
"47468feb-162c-4d4b-83f2-ee91c97d05ff"],
Cell[241562, 7101, 1229, 43, 30, "Output", "ExpressionUUID" -> \
"c0c6c3cb-e61d-445c-b68e-991a9ab89fda"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242828, 7149, 640, 16, 33, "Input", "ExpressionUUID" -> \
"432fc40b-62b0-41c8-922e-dbd2fa2ac04b"],
Cell[243471, 7167, 2466, 77, 55, "Output", "ExpressionUUID" -> \
"100ba892-bfb1-4316-a4e5-d40218953704"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245974, 7249, 332, 9, 33, "Input", "ExpressionUUID" -> \
"b0267aad-3411-4ea0-8041-7f3c2625c333"],
Cell[246309, 7260, 1122, 35, 33, "Output", "ExpressionUUID" -> \
"2d447cf0-5455-4556-a73f-2c3b8f0b2e16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247468, 7300, 803, 22, 33, "Input", "ExpressionUUID" -> \
"9d55bcd5-e002-4b10-a182-5db652e4e216"],
Cell[248274, 7324, 3455, 108, 73, "Output", "ExpressionUUID" -> \
"b9e1db00-7b51-47af-940a-127958dd587f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251766, 7437, 281, 7, 33, "Input", "ExpressionUUID" -> \
"a9cfacf7-dc7e-41c3-bb33-421634bf5ddd"],
Cell[252050, 7446, 4768, 149, 92, "Output", "ExpressionUUID" -> \
"40a919f5-a592-426e-a851-d539a6f6d4c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256855, 7600, 208, 4, 33, "Input", "ExpressionUUID" -> \
"ffdee4e4-d106-4645-ad66-6d3c9ff1e77d"],
Cell[257066, 7606, 2021, 62, 55, "Output", "ExpressionUUID" -> \
"a94326dc-757f-488a-8d12-43d5b37acc58"]
}, Open  ]]
}, Open  ]]
}
]
*)

